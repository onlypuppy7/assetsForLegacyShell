"use strict";function BulletActor(e){this.bullet=e,this.mesh=Meshes.bullet.createInstance(""),this.mesh.setEnabled(!1)}function loadResources(e){Meshes={},Materials={},Sounds={},loadMaterials(),loadSounds(),loadObjectMeshes(function(){loadMapMeshes(function(){e()})})}function setupLights(){scene.ambientColor=new BABYLON.Color3(.2,.2,.2),scene.fogMode=BABYLON.Scene.FOGMODE_EXP,scene.fogColor=new BABYLON.Color4(.5,.7,.9,1),scene.fogDensity=.025,scene.clearColor=BABYLON.Color3.Black();var e=new BABYLON.DirectionalLight("",new BABYLON.Vector3(0,-1,0),scene);e.intensity=1.2,e.autoUpdateExtends=!1,e.shadowMinZ=.05,e.shadowMaxZ=40,e.shadowFrustumSize=15,(shadowGen=new BABYLON.ShadowGenerator(1024,e)).forceBackFacesOnly=!0;var i=new BABYLON.HemisphericLight("light2",new BABYLON.Vector3(-.25,1,-.5),scene);return i.intensity=.8,(i=new BABYLON.HemisphericLight("light3",new BABYLON.Vector3(0,-1,0),scene)).intensity=.25,e}function beginAnimation(e,i,t,r,n){scene.beginAnimation(e,i,t,r,n);for(var a=e.getChildMeshes(),o=0;o<a.length;o++)scene.beginAnimation(a[o],i,t,r,n)}function startGame(){players=[],keyIsDown={},inputTally="WASDERQ ",respawnTime=0,me=null,lastTimeStamp=Date.now(),lastDelta=0,fps=Array(60).fill(0),fpsSum=0,fpsIdx=0,pingTotal=0,pingSamples=0,fpsTotal=0,fpsSamples=0,gameStartTime=Date.now(),nextPingSample=Date.now()+1e3,engine.clear(BABYLON.Color3.Black()),engine.stopRenderLoop(),(scene=new BABYLON.Scene(engine)).autoClear=!1,scene.autoClearDepthAndStencil=!1,scene.setRenderingAutoClearDepthStencil(0,!1),scene.setRenderingAutoClearDepthStencil(1,!0,!0,!1),settings.autoDetail&&enableAutoDetail(),light=setupLights(),camera=new BABYLON.TargetCamera("camera",BABYLON.Vector3.Zero(),scene),scene.activeCameras.push(camera),camera.maxZ=1e3,camera.fov=1.25,camera.minZ=.08,(uiCamera=new BABYLON.FreeCamera("uiCamera",new BABYLON.Vector3(0,0,-1),scene)).mode=BABYLON.Camera.ORTHOGRAPHIC_CAMERA,uiCamera.layerMask=536870912,scene.activeCameras.push(uiCamera),window.onfocus=function(){lastTimeStamp=Date.now()},window.onblur=function(){document.exitPointerLock()},loadResources(onLoadingComplete)}function onCanvasClick(){if(this.requestPointerLock(),me&&me.isDead()&&respawnTime<0){var e=new Comm.output(1);e.packInt8(Comm.requestRespawn),ws.send(e.buffer),respawnTime=1e5}}function onCanvasMouseDown(e){inputDown("MOUSE "+e.button),1==e.button&&e.preventDefault()}function onCanvasMouseUp(e){inputUp("MOUSE "+e.button)}function onCanvasMouseMove(e){if(document.pointerLockElement&&me&&me.hp>0){var i=5e-4*settings.mouseSensitivity+.001;me.actor.scope&&(i*=.3);var t=e.movementX;lastMouseMovement.x&&Math.sign(t)!=Math.sign(lastMouseMovement.x)&&(t=0),lastMouseMovement.x=t;var r=e.movementY;lastMouseMovement.y&&Math.sign(r)!=Math.sign(lastMouseMovement.y)&&(r=0),lastMouseMovement.y=r,me.viewYaw=Math.radAdd(me.viewYaw,t*i),me.pitch=Math.max(Math.min(me.pitch+r*settings.mouseInvert*i,1.5),-1.5)}}function addExplosionSprite(e,i,t,r,n,a,o,d,s){var y=new BABYLON.Sprite("",e);y.animSpeed=i,y.position.x=t,y.position.y=r,y.position.z=n,y.baseSize=s,y.dx=a,y.dy=o,y.dz=d,y.df=0,y.anim=0,y.color.r=smokeColor.r,y.color.g=smokeColor.g,y.color.b=smokeColor.b,y.color.a=smokeColor.a}function addExplosion(e,i,t,r){for(var n=0;n<Math.floor(r/2);n++){var a=.04*Math.random()+.02,o=1*Math.random()+.5,d=.5*(.9-o),s=(2*Math.random()-1)*d,y=(2*Math.random()-1)*d+.1,l=(2*Math.random()-1)*d;addExplosionSprite(explosionSmokeManager,a,e,i,t,s,y,l,o),addExplosionSprite(explosionFireManager,a,e,i,t,s,y,l,o)}if(me){var x=Math.length3(me.x-e,me.y-i,me.z-t);x<5&&(shake=Math.min(7,shake+Math.clamp(r-25*x,0,5)))}}function lerp(e,i,t){for(var r=e.length-1;r>=0;r--)if(i>=e[r].pos)return void BABYLON.Color4.LerpToRef(e[r].color,e[r+1].color,(i-e[r].pos)*(1/(e[r+1].pos-e[r].pos)),t)}function updateExplosions(e,i){for(var t=0;t<e.sprites.length;t++){var r=e.sprites[t];r.size=r.baseSize*(1-r.anim),e==explosionFireManager&&lerp(fireColors,r.anim,r.color),r.position.x+=r.dx,r.position.y+=r.dy,r.position.z+=r.dz,collidesWithCell(r.position.x,r.position.y,r.position.z)?(r.dx=0,r.dy=0,r.dz=0):r.position.y+=.01*Math.cos(r.anim*Math.PI),r.dx*=.7,r.dy*=.7,r.dz*=.7,r.anim+=i*r.animSpeed+.01,r.animSpeed*=.85,r.anim>=1&&r.dispose()}}function onLoadingComplete(){if(scope=new Scope,hitIndicator=new HitIndicator,reticle=new Reticle,Meshes.muzzleFlash.material=Materials.muzzleFlash,Meshes.bullet.material=Materials.bullet,Meshes.egg.material=Materials.eggShell,Meshes.eggWhite.material=Materials.eggWhite,Meshes.eggYolk.material=Materials.eggYolk,Meshes.grenade.material=Materials.emissive,Meshes.ammo.material=Materials.standardInstanced,Meshes.grenadeItem.material=Materials.standardInstanced,munitionsManager=new MunitionsManager,itemManager=new ItemManager,buildMapMesh(),bulletHoleManager=new BABYLON.SpriteManager("","img/bulletHoles.png?v=1",200,32,scene),bulletHoleManager.fogEnabled=!0,bulletHoleManager.addHole=function(e,i,t,r){var n=new BABYLON.Sprite("",this);n.position.x=i,n.position.y=t,n.position.z=r,n.angle=6.282*Math.random(),n.cellIndex=e,n.size=.03,200==this.sprites.length&&this.sprites[0].dispose()},explosionSmokeManager=new BABYLON.SpriteManager("","img/explosion2.png?v=3",500,128,scene),explosionSmokeManager.fogEnabled=!0,explosionSmokeManager.noAlphaTest=!0,explosionFireManager=new BABYLON.SpriteManager("","img/explosion2.png?v=3",500,128,scene),explosionFireManager.fogEnabled=!0,explosionFireManager.blendMode=BABYLON.Engine.ALPHA_ADD,playOffline)meId=0,addPlayer({id:0,name:"Test",charClass:0,totalKills:0,totalDeaths:0,killStreak:0,bestKillStreak:0,x:mapTest.x+.5,y:mapTest.y-.32,z:mapTest.z+.5,dx:0,dy:0,dz:0,frame:0,pitch:mapTest.pitch,moveYaw:mapTest.yaw,viewYaw:mapTest.yaw,hp:100,weaponIdx:0,controlKeys:0}),startRendering();else{setUpSocket();var e=new Comm.output(1);e.packInt8(Comm.clientReady),ws.send(e.buffer)}}function startRendering(){document.getElementById("mainMenu").style.display="none",document.getElementById("overlay").style.display="none",document.getElementById("homeButton").style.visibility="visible",document.getElementById("friendsButton").style.visibility="visible",document.getElementById("game").style.display="block",document.getElementById("gameCanvasContainer").appendChild(canvas),resize(),canvas.addEventListener("click",onCanvasClick,!1),canvas.addEventListener("mousedown",onCanvasMouseDown,!1),canvas.addEventListener("mouseup",onCanvasMouseUp,!1),canvas.addEventListener("mousemove",onCanvasMouseMove),captureKeys(),closeAlertDialog(),scene.registerBeforeRender(function(){update(),me&&(light.position.x=me.x,light.position.y=me.y+2,light.position.z=me.z)}),engine.runRenderLoop(function(){scene.render()})}function setUpSocket(){ws.onmessage=function(e){for(var i,t=new Comm.input(e.data);i=t.unPackInt8U();)switch(i){case Comm.clientReady:startRendering();break;case Comm.addPlayer:var r={id:t.unPackInt8U(),name:t.unPackString(),charClass:t.unPackInt8U(),x:t.unPackFloat(),y:t.unPackFloat(),z:t.unPackFloat(),dx:t.unPackFloat(),dy:t.unPackFloat(),dz:t.unPackFloat(),viewYaw:t.unPackRadU(),moveYaw:t.unPackRadU(),pitch:t.unPackRad(),totalKills:t.unPackInt16U(),killStreak:t.unPackInt16U(),bestKillStreak:t.unPackInt16U(),hp:t.unPackInt8U(),weaponIdx:t.unPackInt8U(),controlKeys:t.unPackInt8U()};r.name=fixNameWidth(r.name),players[r.id]||(meId==r.id&&addChat("Welcome, "+r.name+"!"),addPlayer(r));break;case Comm.removePlayer:removePlayer(y=t.unPackInt8U());break;case Comm.spawnItem:var n=t.unPackInt16U(),a=t.unPackInt8U(),o=t.unPackFloat(),d=t.unPackFloat(),s=t.unPackFloat();itemManager.spawnItem(n,a,o,d,s);break;case Comm.collectItem:var y=t.unPackInt8U(),a=t.unPackInt8U(),n=t.unPackInt16U();itemManager.collectItem(a,n),y==meId&&(players[y].collectItem(a),updateAmmoUi());break;case Comm.keyDown:var y=t.unPackInt8U(),l=t.unPackInt8U();(W=players[y])&&(W.controlKeys|=l);break;case Comm.keyUp:var y=t.unPackInt8U(),l=t.unPackInt8U();(W=players[y])&&(W.controlKeys^=l);break;case Comm.jump:y=t.unPackInt8U();(W=players[y])&&players[y].jump();break;case Comm.die:var x=t.unPackInt8U(),z=t.unPackInt8U(),h=t.unPackInt8U(),c=players[x],u=players[z];u.isDead()||(u.totalKills++,u.killStreak++,u.bestKillStreak=Math.max(u.bestKillStreak,u.killStreak));var m=new BABYLON.Vector3(c.x,c.y+.32,c.z);c.actor.deathSound.setPosition(m),c.actor.deathSound.play();var p=Math.randomInt(0,Sounds.death.length);if(Sounds.death[p].setPosition(m),Sounds.death[p].play(),x!=meId){if(z==meId){var g=document.getElementById("KILL_BOX");g.style.display="block",document.getElementById("KILLED_NAME").innerText=c.name;var f=document.getElementById("KILL_STREAK");me.killStreak>1?f.innerText=me.killStreak+"-KILL STREAK":f.innerText="";var w=1.5,M=setInterval(function(){g.style.transform="scale("+w+","+w+")",(w-=.025)<=1&&clearInterval(M)},15);clearTimeout(killDisplayTimeout),killDisplayTimeout=setTimeout(function(){g.style.display="none"},4e3)}}else{camera.parent=null,camera.position=new BABYLON.Vector3(me.actor.mesh.position.x,me.actor.mesh.position.y+.2,me.actor.mesh.position.z),camera.lockedTarget=u.actor.bodyMesh,document.exitPointerLock(),respawnTime=h;var v=document.getElementById("DEATH_BOX");v.style.display="block",document.getElementById("KILLED_BY_NAME").innerText=u.name;var w=2,M=setInterval(function(){v.style.transform="scale("+w+","+w+")",(w-=.025)<=1&&clearInterval(M)},15),B=document.getElementById("RESPAWN");B.innerText="";var S=setInterval(function(){B.innerText="You may respawn in "+respawnTime,--respawnTime<0&&(clearInterval(S),B.innerText="CLICK TO RESPAWN!")},1e3)}c.actor.explodeMesh.setEnabled(!0),c.actor.whiteMesh.setEnabled(!0),c.actor.yolkMesh.setEnabled(!0),beginAnimation(c.actor.explodeMesh,0,50,!1,1),scene.beginAnimation(c.actor.whiteMesh,0,50,!1,1),scene.beginAnimation(c.actor.yolkMesh,0,56,!1,1),shellFragBurst(c.actor.mesh,200,1),c.die(),c.previousStates.fill({delta:0,moveYaw:0,fire:!1,jump:!1,x:c.x,y:c.y,z:c.z,dx:0,dy:0,dz:0,controlKeys:0}),c.actor.mesh.position.x=c.x,c.actor.mesh.position.y=c.y,c.actor.mesh.position.z=c.z,rebuildPlayerList(),updateBestStreakUi();break;case Comm.chat:addChat(t.unPackString());break;case Comm.sync:var n=t.unPackInt8U(),b=t.unPackInt8U(),o=t.unPackFloat(),d=t.unPackFloat(),s=t.unPackFloat(),k=t.unPackRadU(),I=t.unPackRad();if(!(W=players[n]))break;if(n==meId){if(Date.now()>=nextPingSample){nextPingSample=Date.now()+1e3;var A=Date.now()-pingStartTime;pingTotal+=A,pingSamples++;var C=document.getElementById("PING");C.style.color=A<100?"#0f0":A<150?"#ff0":A<200?"#f90":"#f00",document.getElementById("PING").innerText=A+"ms"}for(var E=b,P=1e6,L=b;L!=W.stateIdx;){var O=W.previousStates[L],N=Math.sqrt(Math.pow(o-O.x,2)+Math.pow(d-O.y,2)+Math.pow(s-O.z,2));N<P&&(E=L,P=N),L=(L+1)%256}var L=E,F=(W.previousStates[L],o-W.previousStates[L].x),T=d-W.previousStates[L].y,Y=s-W.previousStates[L].z;W.x+=F;for(L=0;W.collidesWithMap()&&(W.x-=F,F*=.5,W.x+=F,!(++L>100)););for(W.z+=Y,L=0;W.collidesWithMap()&&(W.z-=Y,Y*=.5,W.z+=Y,!(++L>100)););T>=.9&&(W.y=d)}else W.x=o,W.y=d,W.z=s,W.viewYaw=k,W.moveYaw=k,W.pitch=I;break;case Comm.fireBullet:var n=t.unPackInt8U(),o=t.unPackFloat(),d=t.unPackFloat(),s=t.unPackFloat(),G=t.unPackFloat(),D=t.unPackFloat(),R=t.unPackFloat();if(!(W=players[n]))break;n!=meId&&(W.actor.head.rotation.x=W.pitch,W.actor.mesh.rotation.y=W.viewYaw,W.actor.fire(),W.weapon.actor.fire()),munitionsManager.fireBullet(W,{x:o,y:d,z:s},{x:G,y:D,z:R},W.weapon.damage,W.weapon.ttl,W.weapon.velocity);break;case Comm.fireShot:var n=t.unPackInt8U(),o=t.unPackFloat(),d=t.unPackFloat(),s=t.unPackFloat(),G=t.unPackFloat(),D=t.unPackFloat(),R=t.unPackFloat(),U=t.unPackInt8U(),W=players[n];n!=meId&&(W.actor.head.rotation.x=W.pitch,W.actor.mesh.rotation.y=W.viewYaw,W.actor.fire(),W.weapon.actor.fire()),Math.seed=U;for(L=0;L<20;L++){var H=Math.normalize3({x:G+Math.seededRandom(-.15,.15),y:D+Math.seededRandom(-.1,.1),z:R+Math.seededRandom(-.15,.15)});munitionsManager.fireBullet(W,{x:o,y:d,z:s},H,W.weapon.damage,W.weapon.ttl,W.weapon.velocity*Math.seededRandom(.9,1.1))}break;case Comm.throwGrenade:var n=t.unPackInt8U(),o=t.unPackFloat(),d=t.unPackFloat(),s=t.unPackFloat(),F=t.unPackFloat(),T=t.unPackFloat(),Y=t.unPackFloat();if(!(W=players[n]))break;W.grenadeCount--,updateAmmoUi(),n!=meId&&(W.actor.head.rotation.x=W.pitch,W.actor.mesh.rotation.y=W.viewYaw),W.actor.throwGrenade(),munitionsManager.throwGrenade(W,{x:o,y:d,z:s},{x:F,y:T,z:Y});break;case Comm.startReload:n=t.unPackInt8U();players[n].weapon.actor.reload();break;case Comm.reload:me.weapon.reload();break;case Comm.stowWeapon:n=t.unPackInt8U();(W=players[n])&&W.weapon.actor.stow();break;case Comm.equipWeapon:var n=t.unPackInt8U(),q=t.unPackInt8U();if(!(W=players[n]))break;players[n].equipWeapon(q);break;case Comm.hitMe:var K=t.unPackInt8U(),F=t.unPackFloat(),Y=t.unPackFloat();me.hp=K,me.actor.hit(),hitIndicator.hit(F,Y);break;case Comm.hitThem:var n=t.unPackInt8U(),K=t.unPackInt8U();(W=players[n]).hp=K,W.actor.hit(),K>0&&shellFragBurst(W.actor.mesh,100,1);break;case Comm.respawn:var n=t.unPackInt8U(),o=t.unPackFloat(),d=t.unPackFloat(),s=t.unPackFloat();(W=players[n]).respawn(o,d,s),n==meId&&(document.getElementById("DEATH_BOX").style.display="none",camera.position=BABYLON.Vector3.Zero(),camera.rotation=BABYLON.Vector3.Zero(),camera.rotationQuaternion=BABYLON.Quaternion.Zero(),camera.parent=me.actor.eye,camera.lockedTarget=null)}}}function shellFragBurst(e,i,t){var r=new BABYLON.ParticleSystem("particles",i,scene);r.targetStopDuration=.2,r.disposeOnStop=!0,r.particleTexture=new BABYLON.Texture("./img/shellfrag.png",scene),r.emitter=e,r.minEmitBox=new BABYLON.Vector3(-.2,.2,-.2),r.maxEmitBox=new BABYLON.Vector3(.2,.4,.2),r.color1=new BABYLON.Color4(1,1,1,4),r.color2=new BABYLON.Color4(1,1,1,4),r.colorDead=new BABYLON.Color4(1,1,1,0),r.minSize=.01,r.maxSize=.04,r.minLifeTime=.1,r.maxLifeTime=.3,r.emitRate=i,r.manualEmitCount=i,r.blendMode=BABYLON.ParticleSystem.BLENDMODE_STANDARD,r.gravity=new BABYLON.Vector3(0,-10,0),r.direction1=new BABYLON.Vector3(-2,-1,-2),r.direction2=new BABYLON.Vector3(2,3,2),r.minAngularSpeed=10*-Math.PI,r.maxAngularSpeed=10*Math.PI,r.minEmitPower=1*t,r.maxEmitPower=2*t,r.updateSpeed=.01,r.start()}function createMapCells(){var e;e=playOffline?JSON.parse(localStorage.getItem("mapBackup")):minMaps[mapIdx],(map={width:e.width,height:e.height+1,depth:e.depth}).data=Array(map.width);for(var i=0;i<map.width;i++){map.data[i]=Array(map.height);for(var t=0;t<map.height;t++){map.data[i][t]=Array(map.depth);for(var r=0;r<map.depth;r++)map.data[i][t][r]={}}}(SPS=new BABYLON.SolidParticleSystem("SPS",scene,{updatable:!1})).computeParticleColor=!1,SPS.computeParticleTexture=!1,SPS.computeParticleRotation=!1,Object.keys(e.data).forEach(function(i){var t=e.data[i];Object.keys(t).forEach(function(e){if(i>0){var r=t[e],n=0;try{SPS.addShape(Meshes.map[i][e],r.length,{positionFunction:function(t,a,o){t.position.x=r[n].x+.5,t.position.y=r[n].y,t.position.z=r[n].z+.5,t.rotation.x=.5*-Math.PI,t.rotation.y=r[n].dir*rotInc,t.alive=!1,map.data[r[n].x][r[n].y][r[n].z]={cat:i,dec:e,dir:r[n].dir},n++}})}catch(e){alert("Cache error. Clear your hosted app data (Chrome) and reload the page!")}}})});var n=[{w:80,h:120,r:0},{w:40,h:50,r:1.5},{w:30,h:20,r:3}];SPS.addShape(Meshes.mountains,3,{positionFunction:function(e,i,t){e.position.x=map.width/2,e.position.y=0,e.position.z=map.depth/2,e.scaling.x=n[t].w,e.scaling.y=n[t].h,e.scaling.z=n[t].w,e.rotation.y=n[t].r,e.alive=!1}}),(mapMesh=SPS.buildMesh()).receiveShadows=!0,mapMesh.material=Materials.map,mapMesh.freezeWorldMatrix()}function buildMapMesh(){createMapCells();var e=new BABYLON.StandardMaterial("water material",scene);e.diffuseColor=new BABYLON.Color3(.05,.1,.2),e.specularColor=new BABYLON.Color3(0,0,0);var i=BABYLON.MeshBuilder.CreatePlane("plane",{size:1e3},scene);i.rotation.x=Math.PI/2,i.position.y=-1,i.material=e;var t=new BABYLON.SkyMaterial("skyMaterial",scene);t.backFaceCulling=!1;var r=BABYLON.Mesh.CreateBox("skyBox",1e3,scene);r.material=t,r.position.x=map.width/2,r.position.z=map.depth/2,t.fogEnabled=!1,t.useSunPosition=!0,t.sunPosition=new BABYLON.Vector3(-.25,1,-.5),t.turbidity=1.5,t.luminance=.5,t.rayleigh=2}function update(){var e=document.getElementById("FPS");fps[fpsIdx]=engine.getFps(),fpsSum+=fps[fpsIdx],fpsSum-=fps[(fpsIdx+1)%60],fpsIdx=(fpsIdx+1)%60;var i=Math.ceil(fpsSum/60);fpsTotal+=i,++fpsSamples%10==0&&(e.innerHTML="FPS: "+i);var t=Date.now()-lastTimeStamp;lastTimeStamp+=t,t/=17,Object.keys(players).forEach(function(e){var i=players[e];i&&(i.update(t),i.actor&&i.actor.update(t))}),me&&(me.stateIdx%10==0&&ws.readyState==ws.OPEN&&me.hp>0&&serverSync(),me.stateIdx=(me.stateIdx+1)%256,me.previousStates[me.stateIdx]={delta:t,moveYaw:me.moveYaw,fire:!1,jump:!1,x:me.x,y:me.y,z:me.z,dx:me.dx,dy:me.dy,dz:me.dz,controlKeys:me.controlKeys},hitIndicator.update(t),reticle.update(t),me.weapon&&0==me.weapon.ammo.rounds&&(me.stateIdx%20==0?document.getElementById("AMMO").style.color="#f00":me.stateIdx%20==10&&(document.getElementById("AMMO").style.color="#fff")),me.grenadeCountdown>0&&grenadeThrowPower>-1e3&&(grenadeThrowPower=Math.min(grenadeThrowPower+.015,1))>0&&(document.getElementById("grenadeThrowContainer").style.visibility="visible",document.getElementById("grenadeThrow").style.height=100*grenadeThrowPower+"%")),munitionsManager.update(t),itemManager.update(t),updateExplosions(explosionSmokeManager,t),updateExplosions(explosionFireManager,t)}function hitPlayer(){}function serverSync(){if(me){pingStartTime=Date.now(),me.moveYaw=me.viewYaw,me.previousStates[me.stateIdx].moveYaw=me.moveYaw;var e=new Comm.output(6);e.packInt8(Comm.sync),e.packInt8(me.stateIdx),e.packRadU(me.moveYaw),e.packRad(me.pitch),ws.send(e.buffer)}}function addPlayer(e){var i=new Player(e);i.id==meId?((me=i).ws=ws,camera.parent=me.actor.eye):(i.equipWeapon(i.weaponIdx),i.isDead()&&i.actor.die()),players[e.id]=i,rebuildPlayerList()}function removePlayer(e){players[e].actor.remove(),delete players[e],rebuildPlayerList()}function reloadWeapon(){if(me.weapon.startReload()){var e=new Comm.output(1);e.packInt8(Comm.startReload),ws.send(e.buffer)}}function rebuildPlayerList(){var e=Object.keys(players).sort(function(e,i){return players[i].killStreak-players[e].killStreak}),i=document.getElementById("playerList").children,t=0;for(e.forEach(function(e){i[t].style.display="block",i[t].children[0].innerText=players[e].name,i[t].children[1].innerText=players[e].killStreak,i[t].className=e==meId?"thisPlayer":"otherPlayer",t++});t<20;)i[t].style.display="none",t++}function updateBestStreakUi(){var e=players[meId];document.getElementById("BEST_STREAK").innerText="BEST KILL STREAK: "+e.bestKillStreak}function updateAmmoUi(){var e=players[meId],i=document.getElementById("WEAPON_NAME");i.innerHTML=e.weapon.name,(i=document.getElementById("AMMO")).style.color="#fff",i.innerHTML=e.weapon.ammo.rounds+"/"+e.weapon.ammo.store;for(var t=1;t<=3;t++)me.grenadeCount>=t?document.getElementById("grenade"+t).src="img/grenadeIcon.png":document.getElementById("grenade"+t).src="img/grenadeIconDark.png"}function addChat(e){var i=document.getElementById("chatOut");i.value+="\n"+e,i.scrollTop=i.scrollHeight}function captureKeys(){document.onkeydown=onKeyDown,document.onkeyup=onKeyUp}function releaseKeys(){document.onkeydown=null,document.onkeyup=null}function inputDown(e){if(!me.isDead()){var i=inputToControlMap[e];switch(i){case"up":case"down":case"left":case"right":var t=controlToBitmask[i];(r=new Comm.output(2)).packInt8(Comm.keyDown),r.packInt8(t),ws.send(r.buffer),me.controlKeys|=t,me.previousStates[me.stateIdx].controlKeys|=t;break;case"jump":var r=new Comm.output(1);r.packInt8(Comm.jump),ws.send(r.buffer),me.jump(),me.previousStates[me.stateIdx].jump=!0,me.previousStates[me.stateIdx].dy=me.dy;break;case"fire":document.pointerLockElement&&me&&(me.grenadeCountdown>0?me.actor.cancelGrenade():(me.previousStates[me.stateIdx].fire=!0,me.weapon&&(me.weapon.triggerPulled=!0),me.queueShot(),0==me.weapon.ammo.rounds&&reloadWeapon()));break;case"grenade":document.pointerLockElement&&me&&(grenadeThrowPower=-.15,me.actor.reachForGrenade());break;case"scope":settings.holdToAim?me.actor.scopeIn():me.actor.scope?me.actor.scopeOut():me.actor.scopeIn();break;case"reload":reloadWeapon();break;case"weapon":me.stowWeapon(0==me.weaponIdx?1:0)}}}function inputUp(e){if(!me.isDead()){var i=inputToControlMap[e];switch(i){case"fire":me.weapon&&(me.weapon.triggerPulled=!1);break;case"scope":settings.holdToAim&&me.actor.scopeOut();break;case"grenade":document.pointerLockElement&&me&&(document.getElementById("grenadeThrowContainer").style.visibility="hidden",me.throwGrenade(grenadeThrowPower));break;case"up":case"down":case"left":case"right":var t=controlToBitmask[i],r=new Comm.output(2);r.packInt8(Comm.keyUp),r.packInt8(t),ws.send(r.buffer),me.controlKeys^=t,me.previousStates[me.stateIdx].controlKeys|=t}}}function onKeyDown(e){if(!keyIsDown[e.keyCode]){keyIsDown[e.keyCode]=!0;var i=e.key.toLocaleUpperCase();""!=inputTally&&""==(inputTally=inputTally.replace(i,""))&&(document.getElementById("help").style.display="none",localStorage.setItem("hideHelp",1))," "==i&&(i="SPACE",e.preventDefault()),inputDown(i)}}function onKeyUp(e){if(keyIsDown[e.keyCode]){keyIsDown[e.keyCode]=!1;var i=e.key.toLocaleUpperCase();" "==i&&(i="SPACE",e.preventDefault()),inputUp(i)}}function Scope(){var e=new BABYLON.SpriteManager("","img/scope.png?v=1",1,256,scene);e.fogEnabled=!1,e.layerMask=536870912,this.sprite=new BABYLON.Sprite("",e),this.crosshairs=new BABYLON.AbstractMesh("",scene),this.crosshairs.setEnabled(!1),this.crosshairs.position.z=1;var i=[new BABYLON.Vector3(-1,0,0),new BABYLON.Vector3(1,0,0)],t=BABYLON.MeshBuilder.CreateLines("",{points:i},scene);t.layerMask=536870912,t.color=BABYLON.Color3.Black(),t.parent=this.crosshairs,i=[new BABYLON.Vector3(0,-1,0),new BABYLON.Vector3(0,1,0)],(t=BABYLON.MeshBuilder.CreateLines("",{points:i},scene)).layerMask=536870912,t.color=BABYLON.Color3.Black(),t.parent=this.crosshairs}function HitIndicator(){this.mesh=new BABYLON.Mesh("hitIndicator",scene),this.mesh.updatable=!0,this.mesh.hasVertexAlpha=!0,this.positions=[0,0,0,0,.5,0,.5,.5,0,.5,0,0,.5,-.5,0,0,-.5,0,-.5,-.5,0,-.5,0,0,-.5,.5,0];var e=[0,1,8,0,2,1,0,2,1,0,3,2,0,3,2,0,4,3,0,4,3,0,5,4,0,5,4,0,6,5,0,6,5,0,7,6,0,7,6,0,8,7,0,8,7,0,1,8];this.colors=new Array(48).fill(0);for(var i=0;i<48;i+=4)this.colors[i]=1,this.colors[i+1]=.9,this.colors[i+2]=0,this.colors[i+3]=-.5;var t=new BABYLON.VertexData;t.positions=this.positions,t.indices=e,t.colors=this.colors,t.applyToMesh(this.mesh,!0),this.mesh.layerMask=536870912,this.mesh.material=Materials.ui,this.resize()}function Reticle(){this.mesh=new BABYLON.AbstractMesh("reticle",scene),this.lines=[],Meshes.reticle.setMaterial(Materials.ui);for(var e=0;e<4;e++){var i=Meshes.reticle.createInstance("reticleLine",this.mesh);i.parent=this.mesh,i.scaling=new BABYLON.Vector3(1,1,1),i.rotation.z=e*Math.PI/2,this.lines.push(i)}this.mesh.setLayerMask(536870912),this.resize()}function inviteFriends(){var e=selectedServer.toString(36)+uniqueId.toString(36)+uniqueKey.toString(36);document.getElementById("friendCode").innerText="shellshock.io/#"+e,document.getElementById("inviteFriends").style.display="block"}function copyFriendCode(){document.getElementById("friendCode").select();try{document.execCommand("copy")}catch(e){console.log("Unable to copy to clipboard")}}function isMeshVisible(e,i){for(var t=i||e.getBoundingInfo().boundingBox.center.z,r=e.position.x-camera.globalPosition.x,n=e.position.y+t-camera.globalPosition.y,a=e.position.z-camera.globalPosition.z,o=Math.length3(r,n,a),d=Math.normalize3({x:r,y:n,z:a},.9),s=camera.globalPosition.x,y=camera.globalPosition.y,l=camera.globalPosition.z,x=0,z=0;z<o-.9;z+=.9){var h=collidesWithCell(s+=d.x,y+=d.y,l+=d.z);if(h&&(h.cel.cat==MAP.ground||h.cel.cat==MAP.block)&&2==++x)return void(e.isVisible&&e.setVisible(!1))}e.isVisible||e.setVisible(!0)}function GrenadeActor(e){this.grenade=e,this.mesh=Meshes.grenade.clone(""),this.mesh.setEnabled(!1),this.flashColor=new BABYLON.Color3(1,0,0),this.explodeSound=Sounds.grenade.explode.clone(),this.pinSound=Sounds.grenade.pin.clone(),this.beepSound=Sounds.grenade.beep.clone(),this.mesh.attachSound(this.pinSound),this.mesh.attachSound(this.beepSound),this.beep=!1}function Eggk47Actor(e){this.gun=e,this.playerActor=e.player.actor,this.scopeFov=.9,this.scopeY=.036,this.gunMesh=Meshes.eggk47.clone("eggk47",this.playerActor.gunContainer),this.gunMesh.setEnabled(!1),this.clipMesh=Meshes.eggk47Mag.clone("eggk47Mag",this.playerActor.gunContainer),this.clipMesh.setEnabled(!1),this.muzzleFlash=Meshes.muzzleFlash.clone("muzzleFlash",this.playerActor.gunContainer),this.muzzleFlash.setEnabled(!1),this.muzzleFlash.parent=this.playerActor.gunContainer,this.muzzleFlash.position.x=.25,this.muzzleFlash.position.z=.6,this.gun.player.id==meId&&(this.gunMesh.setRenderingGroupId(1),this.clipMesh.setRenderingGroupId(1),this.muzzleFlash.setRenderingGroupId(1)),this.fireSound=Sounds.eggk47.fire.clone(),this.gunMesh.attachSound(this.fireSound),this.dryFireSound=Sounds.eggk47.dryFire.clone(),this.gunMesh.attachSound(this.dryFireSound),this.addSoundEvent(24,Sounds.eggk47.removeMag.clone()),this.addSoundEvent(72,Sounds.eggk47.insertMag.clone()),this.addSoundEvent(90,Sounds.eggk47.cycle.clone())}function DozenGaugeActor(e){this.gun=e,this.playerActor=e.player.actor,this.scopeFov=1,this.scopeY=.072,this.gripHandTarget=this.playerActor.gripHand.getChildMeshByName("gripHand.doubleShotgunGrip"),this.gunMesh=Meshes.doubleShotgun.clone("doubleShotgun",this.playerActor.gripHand),this.gunMesh.attachToParent(this.gripHandTarget),this.gunMesh.setEnabled(!1),this.barrel=this.gunMesh.getChildMeshByName("doubleShotgun.doubleShotgun.barrel"),this.muzzleFlash=Meshes.muzzleFlash.clone("muzzleFlash",this.playerActor.gunContainer),this.muzzleFlash.setEnabled(!1),this.muzzleFlash.parent=this.playerActor.gunContainer,this.muzzleFlash.position.x=.25,this.muzzleFlash.position.z=.6,this.gun.player.id==meId&&(this.gunMesh.setRenderingGroupId(1),this.muzzleFlash.setRenderingGroupId(1)),this.fireSound=Sounds.dozenGauge.fire.clone(),this.gunMesh.attachSound(this.fireSound),this.dryFireSound=Sounds.eggk47.dryFire.clone(),this.gunMesh.attachSound(this.dryFireSound),this.addSoundEvent(321,Sounds.dozenGauge.open.clone()),this.addSoundEvent(377,Sounds.dozenGauge.load.clone()),this.addSoundEvent(397,Sounds.dozenGauge.close.clone())}function CSG1Actor(e){this.gun=e,this.playerActor=e.player.actor,this.scopeFov=.5,this.scopeY=.0345,this.gunMesh=Meshes.csg1.clone("csg1",this.playerActor.gunContainer),this.gunMesh.setEnabled(!1),this.clipMesh=Meshes.csg1Mag.clone("csg1Mag",this.playerActor.gunContainer),this.clipMesh.setEnabled(!1),this.muzzleFlash=Meshes.muzzleFlash.clone("muzzleFlash",this.playerActor.gunContainer),this.muzzleFlash.setEnabled(!1),this.muzzleFlash.parent=this.playerActor.gunContainer,this.muzzleFlash.position.x=.25,this.muzzleFlash.position.z=.6,this.gun.player.id==meId&&(this.gunMesh.setRenderingGroupId(1),this.clipMesh.setRenderingGroupId(1),this.muzzleFlash.setRenderingGroupId(1)),this.fireSound=Sounds.csg1.fire.clone(),this.gunMesh.attachSound(this.fireSound),this.dryFireSound=Sounds.eggk47.dryFire.clone(),this.gunMesh.attachSound(this.dryFireSound),this.addSoundEvent(881,Sounds.eggk47.removeMag.clone()),this.addSoundEvent(947,Sounds.eggk47.insertMag.clone()),this.addSoundEvent(1030,Sounds.csg1.pullAction.clone()),this.addSoundEvent(1100,Sounds.csg1.releaseAction.clone())}function Cluck9mmActor(e){this.gun=e,this.playerActor=e.player.actor,this.scopeFov=1.1,this.scopeY=.072,this.gunMesh=Meshes.cluck9mm.clone("cluck9mm",this.playerActor.gunContainer),this.gunMesh.setEnabled(!1),this.clipMesh=this.gunMesh.getChildMeshByName("cluck9mm.cluck9mmMag"),this.muzzleFlash=Meshes.muzzleFlash.clone("muzzleFlash",this.playerActor.gunContainer),this.muzzleFlash.setEnabled(!1),this.muzzleFlash.parent=this.playerActor.gunContainer,this.muzzleFlash.position.x=.25,this.muzzleFlash.position.z=.6,this.gun.player.id==meId&&(this.gunMesh.setRenderingGroupId(1),this.clipMesh.setRenderingGroupId(1),this.muzzleFlash.setRenderingGroupId(1)),this.fireSound=Sounds.cluck9mm.fire.clone(),this.gunMesh.attachSound(this.fireSound),this.dryFireSound=Sounds.eggk47.dryFire.clone(),this.gunMesh.attachSound(this.dryFireSound),this.addSoundEvent(628,Sounds.cluck9mm.removeMag.clone()),this.addSoundEvent(675,Sounds.cluck9mm.insertMag.clone())}function ItemActor(e){this.kind=e}function AmmoActor(){ItemActor.call(this,ItemManager.AMMO),this.mesh=Meshes.ammo.createInstance(""),this.mesh.setEnabled(!1),shadowGen&&shadowGen.getShadowMap().renderList.push(this.mesh)}function GrenadeItemActor(){ItemActor.call(this,ItemManager.GRENADE),this.mesh=Meshes.grenadeItem.createInstance(""),this.mesh.setEnabled(!1),shadowGen&&shadowGen.getShadowMap().renderList.push(this.mesh)}function ItemManager(){this.pools=[new Pool(function(){return new ItemManager.Constructors[ItemManager.AMMO]},100),new Pool(function(){return new ItemManager.Constructors[ItemManager.GRENADE]},20)]}function getKeyByValue(e,i){for(var t in e)if(e.hasOwnProperty(t)&&e[t]===i)return t}function selectServer(e){selectedServer=e}function resize(){canvas&&(inGame?(canvas.style.width="100%",canvas.style.height="100%",canvas.className=""):(canvas.style.width="100%",canvas.height=.66*canvas.width,canvas.className="roundedBorder")),engine&&engine.resize(),hitIndicator&&hitIndicator.resize(),reticle&&reticle.resize()}function onResourcesLoaded(){function e(){document.getElementById("className").innerText=classes[selectedClass].name,document.getElementById("classWeapon").innerText="Weapon: "+d[selectedClass].weapon.name;for(z in l){var e=(d[selectedClass].weapon[z]+l[z].min)/(l[z].max-Math.abs(l[z].min));e=Math.floor(95*e)+5,document.getElementById(l[z].name).style.width=e+"%"}}var i=getStoredString("lastVersionPlayed",version);if(i!=version){var t=i.split("."),r=version.split(".");t[0]==r[0]&&t[1]==r[1]||showChangelog()}localStorage.setItem("lastVersionPlayed",version),document.getElementById("username").disabled=!1;var n=classes.length;meId=0;var a=new BABYLON.StandardMaterial("groundMat",scene);a.diffuseColor=new BABYLON.Color3(.4,.3,.2);var o=BABYLON.Mesh.CreatePlane("ground",100,scene);o.position.y=-.32,o.rotation.x=Math.PI/2,o.receiveShadows=!0,o.material=a,light.position.y=2;for(var d=[],s=0;s<n;s++){var y=new function(e,i,t,r){this.id=1,this.name="",this.x=e,this.y=i,this.z=t,this.hp=100,this.actor=new PlayerActor(this),this.actor.mesh.setPivotPoint(new BABYLON.Vector3(0,0,-1.6),BABYLON.Space.GLOBAL),this.actor.head.rotation.y=2.5,this.weapon=new classes[r].weapon(this),this.weapon.equip()}(0,-.32,1.6,s);y.actor.mesh.rotation.y=s*Math.PI/(n/2),d.push(y)}for(var l={totalDamage:{name:"damage",max:-1e3,min:1e3,flip:!1},accuracy:{name:"accuracy",max:-1e3,min:1e3,flip:!0},rof:{name:"fireRate",max:-1e3,min:1e3,flip:!0},range:{name:"range",max:-1e3,min:1e3,flip:!1}},s=0;s<n;s++){var x=d[s].weapon;for(var z in l)l[z].flip?(l[z].max=Math.max(l[z].max,-x[z]),l[z].min=Math.min(l[z].min,-x[z])):(l[z].max=Math.max(l[z].max,x[z]),l[z].min=0)}var h=-(selectedClass=getStoredNumber("selectedClass",Math.randomInt(0,classes.length)));window.selectClass=function(i){selectedClass=Math.mod(selectedClass+i,n),h-=i,e()},e(),BABYLON.Engine.audioEngine.setGlobalVolume(settings.volume),engine.runRenderLoop(function(){scene.render();var e=h/5;h-=e;for(var i=0;i<n;i++)d[i].actor.mesh.rotation.y+=e*(Math.PI/(n/2))})}function getRequest(e,i,t){var r=new XMLHttpRequest;return!!r&&("function"!=typeof i&&(i=function(){}),"function"!=typeof t&&(t=function(){}),r.onreadystatechange=function(){if(4==r.readyState)return 200===r.status?i(r.responseText):t(r.status)},r.open("GET",e,!0),r.send(null),r)}function openJoinBox(){document.getElementById("customGame").style.display="none",document.getElementById("joinGame").style.display="block"}function closeJoinBox(){document.getElementById("customGame").style.display="block",document.getElementById("joinGame").style.display="none",document.getElementById("joinCode").value="",history.replaceState(null,null,location.pathname)}function login(e){privateGame=e;var i,t=selectedServer,r=Comm.joinPublicGame,n="ws://";"https:"===location.protocol&&(n="wss://");var a=document.getElementById("joinCode").value.trim();if(e)r=Comm.createPrivateGame,i=n+servers[t].address;else if(""!=a){r=Comm.joinPrivateGame,a.startsWith("#")&&(a=a.substr(1)),t=Number.parseInt(a.substr(0,1),36),uniqueId=Number.parseInt(a.substr(1,3),36),uniqueKey=Number.parseInt(a.substr(4,2),36);try{i=n+servers[t].address}catch(e){return openAlertDialog("GAME NOT FOUND","Sorry! This game ID is either<br>invalid, or no longer exists.",{label:"OK"}),uniqueId=0,uniqueKey=0,void(document.getElementById("joinCode").value="")}selectedServer=t}else i=n+servers[t].address;(ws=new WebSocket(i)).binaryType="arraybuffer",0!=(username=document.getElementById("username").value.trim()).length&&(document.getElementById("alert").focus(),openAlertDialog("CONNECTING","Please wait!",null,null,!0),ws.onopen=function(e){localStorage.setItem("lastUsername",username),localStorage.setItem("selectedClass",selectedClass),ga("send","event","play game","class",classes[selectedClass].name),fbq("trackCustom","PlayGame",{charClass:classes[selectedClass].name,server:servers[selectedServer].name});var i=7+2*username.length;facebookId&&(i+=2*facebookId.length+6);var t=new Comm.output(i);t.packInt8(Comm.login),t.packInt8(r),t.packInt16(uniqueId),t.packInt16(uniqueKey),t.packInt8(selectedClass),t.packString(username),facebookId&&(t.packInt32(gameSession),t.packString(facebookId)),ws.send(t.buffer)},ws.onclose=function(e){e.code==CloseCode.gameNotFound?(openAlertDialog("GAME NOT FOUND","Sorry! This game ID is either<br>invalid, or no longer exists.",{label:"OK"}),uniqueId=0,uniqueKey=0,document.getElementById("joinCode").value=""):e.code==CloseCode.gameFull?openAlertDialog("GAME FULL","Sorry, this game is currently full!<br>Wait a moment, or try another one!",{label:"OK"}):e.code==CloseCode.badName?(closeAlertDialog(),openAlertDialog("INVALID NAME","I'm going to guess you know why.",{label:"Yes"}),(e=document.getElementById("username")).value="",e.disabled=!1,e.focus(),document.getElementById("playButton").disabled=!1):e.code==CloseCode.mainMenu||(inGame?openAlertDialog("CONNECTION LOST","Please try a different server,<br> or try again later!",{label:"OK",onclick:reloadPage}):openAlertDialog("CANNOT CONNECT","Please try a different server,<br> or try again later!<br>",{label:"OK",onclick:reloadPage}))},ws.onmessage=function(e){var i=new Comm.input(e.data);switch(i.unPackInt8U()){case Comm.loggedIn:meId=i.unPackInt8U(),uniqueId=i.unPackInt16U(),uniqueKey=i.unPackInt16U(),mapIdx=i.unPackInt8U(),privateGame&&inviteFriends(),inGame=!0,startGame()}})}function setVolume(e){settings.volume=e.value,localStorage.setItem("volume",settings.volume),BABYLON.Engine.audioEngine.setGlobalVolume(settings.volume)}function setMouseSensitivity(e){settings.mouseSensitivity=e.value,localStorage.setItem("mouseSensitivity",settings.mouseSensitivity)}function setCheckOption(e){var i=e.checked;switch(e.id){case"mouseInvert":i=e.checked?-1:1;break;case"autoDetail":e.checked?enableAutoDetail():disableAutoDetail(),setDetailSettingsVisibility(e.checked);break;case"enableShadows":e.checked?enableShadows():disableShadows();break;case"highRes":e.checked?increaseResolution():lowerResolution()}settings[e.id]=i,localStorage.setItem(e.id,i)}function setDetailSettingsVisibility(e){for(var i=document.getElementsByName("detail"),t=0;t<i.length;t++)i[t].style.visibility=e?"hidden":"visible";scene&&(document.getElementById("enableShadows").checked=scene.shadowsEnabled,document.getElementById("highRes").checked=1==engine.getHardwareScalingLevel())}function enableAutoDetail(){var e=new BABYLON.SceneOptimizerOptions(40,4e3),i=new BABYLON.SceneOptimization(0);i.apply=disableShadows,e.optimizations.push(i);var t=new BABYLON.SceneOptimization(1);t.apply=lowerResolution,e.optimizations.push(t),BABYLON.SceneOptimizer.OptimizeAsync(scene,e)}function disableAutoDetail(){BABYLON.SceneOptimizer.Stop()}function disableShadows(){return scene.shadowsEnabled=!1,mapMesh&&(mapMesh.material=Materials.mapNoShadow),!0}function enableShadows(){scene.shadowsEnabled=!0,mapMesh&&(mapMesh.material=Materials.map)}function lowerResolution(){return engine.setHardwareScalingLevel(2),adaptToNewResolution(),!0}function increaseResolution(){engine.setHardwareScalingLevel(1),adaptToNewResolution()}function adaptToNewResolution(){reticle&&reticle.resize(),hitIndicator&&hitIndicator.resize(),scope&&scope.crosshairs.isEnabled()&&scope.show()}function getStoredNumber(e,i){var t=Number(localStorage.getItem(e));return t||i}function getStoredBool(e,i){var t=localStorage.getItem(e);return t?"true"==t:i}function getStoredString(e,i){var t=localStorage.getItem(e);return t||i}function refactorConfigKeys(e){document.getElementsByName("config").forEach(function(i){i!=e&&i.innerText==e.innerText&&(delete inputToControlMap[i.innerText],i.style.fontWeight="normal",i.style.color="#aaa",i.innerText="undefined")})}function setControl(e){refactorConfigKeys(e),delete inputToControlMap[e.oldText],inputToControlMap[e.innerText]=e.id,controlEl=null,inGame&&captureKeys(),window.onkeydown=null,window.onkeyup=null,localStorage.setItem("controlConfig",JSON.stringify(inputToControlMap))}function configKey(e){var i=e.target;e=e||window.event,i==controlEl?(1==e.button&&event.preventDefault(),i.style.fontWeight="bold",i.style.color="#fff",i.innerText="MOUSE "+e.button,setControl(i)):(controlEl&&(controlEl.style.fontWeight="bold",controlEl.style.color="#fff",controlEl.innerText=controlEl.oldText),i.oldText=i.innerText,i.style.fontWeight="normal",i.style.color="#edc",i.innerText="Press key or button",controlEl=i,i.focus(),inGame&&releaseKeys(),window.onkeydown=function(e){if(27!=(e.which||e.keyCode)){var t=e.key;return" "==t&&(t="space",e.preventDefault()),i.style.fontWeight="bold",i.style.color="#fff",i.innerText=t.toLocaleUpperCase(),setControl(i),e.stopPropagation(),!1}i.style.fontWeight="bold",i.style.color="#fff",i.innerText=i.oldText,controlEl=null},window.onkeyup=function(e){return e.stopPropagation(),!1})}function startAlertBar(){var e=document.getElementById("alertFooter");e.style.display="block",alertBarInterval=setInterval(function(){e.innerText+="-",e.innerText.length>10&&(e.innerText="-")},200)}function openAlertDialog(e,i,t,r,n){document.getElementById("overlay").style.display="block",document.getElementById("alertHeader").innerHTML=e,document.getElementById("alertMessage").innerHTML=i;a=document.getElementById("alertButton1");t?(a.style.display="inline-block",a.innerHTML=t.label||"OK",a.style.width=t.width||"80px",a.onclick=t.onclick||closeAlertDialog):a.style.display="none";var a=document.getElementById("alertButton2");r?(a.style.display="inline-block",a.innerHTML=r.label||"Cancel",a.style.width=r.width||"80px",a.onclick=r.onclick||closeAlertDialog):a.style.display="none",n?startAlertBar():(document.getElementById("alertFooter").style.display="none",clearInterval(alertBarInterval)),document.exitPointerLock(),window.onkeydown=null,window.onkeyup=null}function closeAlertDialog(){document.getElementById("overlay").style.display="none",document.getElementById("alertFooter").style.display="none",document.getElementById("username").disabled=!1,clearInterval(alertBarInterval)}function resetGameUI(){document.getElementById("chatOut").value="",document.getElementById("BEST_STREAK").innerText="BEST KILL STREAK: 0",document.getElementById("KILL_BOX").style.display="none",document.getElementById("DEATH_BOX").style.display="none"}function showMainMenuConfirm(){openAlertDialog("MAIN MENU","Leave game and return<br>to the main menu?",{label:"Yes",width:"4em",onclick:showMainMenu},{label:"No",width:"4em",onclick:closeAlertDialog})}function reloadPage(){window.location.reload()}function showMainMenu(){if(openAlertDialog("LOADING","Just a moment!",null,null,!0),document.getElementById("homeButton").style.visibility="hidden",document.getElementById("friendsButton").style.visibility="hidden",document.getElementById("game").style.display="none",document.getElementById("inviteFriends").style.display="none",resetGameUI(),inGame&&(canvas.removeEventListener("click",onCanvasClick),canvas.removeEventListener("mousedown",onCanvasMouseDown),canvas.removeEventListener("mouseup",onCanvasMouseUp),canvas.removeEventListener("mousemove",onCanvasMouseMove),ws.close(CloseCode.mainMenu),ws=null,releaseKeys(),gameStartTime>0)){var e=Date.now()-gameStartTime;ga("send","timing","game","play time",e),fbq("trackCustom","EndGame",{timePlayed:e})}inGame=!1,(scene=new BABYLON.Scene(engine)).fogMode=BABYLON.Scene.FOGMODE_EXP2,scene.fogColor=new BABYLON.Color3(0,0,0),scene.fogDensity=.1,scene.clearColor=new BABYLON.Color3(0,0,0),(light=new BABYLON.SpotLight("light",new BABYLON.Vector3(0,10,.7),new BABYLON.Vector3(0,-1,.33),.75,40,scene)).intensity=1.5,light.autoUpdateExtends=!1;var i=new BABYLON.HemisphericLight("light2",new BABYLON.Vector3(-.25,1,-.5),scene);i.intensity=.8,(i=new BABYLON.HemisphericLight("light3",new BABYLON.Vector3(0,-1,0),scene)).intensity=.5,i.diffuse=new BABYLON.Color3(1,.8,.6),(shadowGen=new BABYLON.ShadowGenerator(1024,light)).useBlurExponentialShadowMap=!0,shadowGen.frustumEdgeFalloff=1,light.shadowMinZ=1,light.shadowMaxZ=40,light.shadowFrustumSize=10,shadowGen.blurScale=2,shadowGen.blurBoxOffset=1,camera=new BABYLON.FreeCamera("camera",new BABYLON.Vector3(0,.2,0),scene),scene.activeCameras.push(camera),camera.maxZ=100,camera.fov=.5,camera.minZ=.1,camera.rotation.x=.12,loadResources(function(){document.getElementById("mainMenu").style.display="flex",document.getElementById("characterCanvasContainer").appendChild(canvas),resize(),closeAlertDialog(),onResourcesLoaded(),document.getElementById("username").disabled=!1})}function toggleFullscreen(){if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)(i=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen)&&i.call(document);else{var e=document.getElementById("container"),i=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;i&&(i.call(e),ga("send","event","fullscreen"))}}function onFullscreenChange(){engine.resize();var e=document.getElementById("container");e.style.display="none",setTimeout(function(){e.style.display="flex"},1)}function openSettingsMenu(){ga("send","event","open settings"),document.getElementById("settings").style.display="block",document.getElementById("help").style.display="none",localStorage.setItem("hideHelp",1)}function closeSettingsMenu(){document.getElementById("settings").style.display="none"}function showChangelog(){ga("send","event","view changelog"),openAlertDialog("Version "+version,document.getElementById("changelog").innerHTML,{label:"OK"})}function fixNameWidth(e){var i=nameTestCanvas.getContext("2d");for(i.font="1em Nunito, sans-serif";;){if(i.measureText(e).width<100)break;e=e.substr(0,e.length-1)}return e}function PlayerActor(e){if(this.player=e,this.mesh=new BABYLON.AbstractMesh("player",scene),this.bodyMesh=Meshes.egg.clone("egg",this.mesh),this.bodyMesh.position.y=.32,this.bodyMesh.parent=this.mesh,this.bodyMesh.player=this.player,this.bodyMesh.material=Materials.eggShell,this.player.id==meId&&this.bodyMesh.setEnabled(!1),this.explodeMesh=Meshes.eggExplode.clone("explode",this.mesh),this.explodeMesh.position.y=.32,this.explodeMesh.parent=this.mesh,this.explodeMesh.setMaterial(Materials.normalBackface),this.explodeMesh.setEnabled(!1),this.whiteMesh=Meshes.eggWhite.clone("white",this.mesh),this.whiteMesh.parent=this.explodeMesh,this.whiteMesh.setEnabled(!1),this.yolkMesh=Meshes.eggYolk.clone("yolk",this.mesh),this.yolkMesh.parent=this.explodeMesh,this.yolkMesh.setEnabled(!1),this.head=new BABYLON.AbstractMesh("head",scene),this.head.parent=this.mesh,this.head.position.y=.3,this.head.position.z=0,this.gunContainer=new BABYLON.AbstractMesh("gunContainer",scene),this.gunContainer.parent=this.head,this.gunContainer.rotation.y=-.14,this.gunContainer.rotation.x=-.035,this.eye=new BABYLON.AbstractMesh("eye",scene),this.eye.position.y=.1,this.eye.position.x=.1,this.eye.parent=this.head,this.gripHand=Meshes.gripHand.clone("gripHand",this.gunContainer),this.gripHand.parent=this.gunContainer,this.foreHand=Meshes.foreHand.clone("foreHand",this.gunContainer),this.foreHand.parent=this.gunContainer,shake=0,shadowGen&&shadowGen.getShadowMap().renderList.push(this.bodyMesh),inGame)if(this.player.id==meId)this.gripHand.setRenderingGroupId(1),this.foreHand.setRenderingGroupId(1);else{this.nameSurface=BABYLON.Mesh.CreatePlane("nameSurface",.5,scene,!1),this.nameSurface.material=new BABYLON.StandardMaterial("nameSurfaceMaterial",scene),this.nameSurface.material.specularColor=new BABYLON.Color3(0,0,0),this.nameSurface.material.emissiveColor=new BABYLON.Color3(1,1,1);var i=new BABYLON.DynamicTexture("nameTexture",256,scene,!1,1);this.nameSurface.material.diffuseTexture=i,this.nameSurface.material.diffuseTexture.hasAlpha=!0,this.nameSurface.material.useAlphaFromDiffuseTexture=!0,this.nameSurface.material.backFaceCulling=!1,i.drawText(this.player.name,9*(14-this.player.name.length),30,"bold 30px Nunito","white","transparent"),this.nameSurface.parent=this.mesh,this.nameSurface.billboardMode=BABYLON.AbstractMesh.BILLBOARDMODE_ALL,this.nameSurface.position.y=.475}this.mesh.position.x=this.player.x,this.mesh.position.y=this.player.y,this.mesh.position.z=this.player.z,this.deathSound=Sounds.shellBurst.clone(),this.player.id==meId?this.hitSound=new BABYLON.Sound("","sound/hit.mp3",scene):(this.hitSound=Sounds.hit.clone(),this.bodyMesh.attachSound(this.hitSound)),playOffline&&(this.gripHand.setEnabled(!1),this.foreHand.setEnabled(!1)),this.bobbleIntensity=0,this.scope=!1,this.zoomed=!1,this.hitSoundDelay=0}function loadMapMeshes(e){function i(){++t==r.length&&e()}Meshes.map=[[],[],[],[],[],[],[],[],[]];var t=0,r=[loadMeshes(["ground"],Meshes.map[1],!0,i),loadMeshes(["wall"],Meshes.map[2],!0,i),loadMeshes(["tree"],Meshes.map[3],!0,i),loadMeshes(["halfBlock"],Meshes.map[4],!0,i),loadMeshes(["ramp"],Meshes.map[5],!0,i),loadMeshes(["ladder"],Meshes.map[6],!0,i),loadMeshes(["tank"],Meshes.map[7],!0,i),loadMeshes(["lowWall"],Meshes.map[8],!0,i)]}function loadObjectMeshes(e){loadMeshes(["egg","eggExplode","munitions","muzzleFlash","items","reticle","mountains","sky"],Meshes,!1,e)}function loadSounds(e){var i={spatialSound:!0,distanceModel:"exponential",rolloffFactor:1};Sounds.eggk47={fire:new BABYLON.Sound("fire","sound/eggk47/fire.mp3",scene,null,i),dryFire:new BABYLON.Sound("dryFire","sound/eggk47/dry fire.mp3",scene,null,i),cycle:new BABYLON.Sound("cycle","sound/eggk47/full cycle.mp3",scene,null,i),insertMag:new BABYLON.Sound("insertMag","sound/eggk47/insert mag.mp3",scene,null,i),removeMag:new BABYLON.Sound("removeMag","sound/eggk47/remove mag.mp3",scene,null,i)},Sounds.dozenGauge={fire:new BABYLON.Sound("","sound/dozenGauge/fire.mp3",scene,null,i),open:new BABYLON.Sound("","sound/dozenGauge/open.mp3",scene,null,i),load:new BABYLON.Sound("","sound/dozenGauge/load.mp3",scene,null,i),close:new BABYLON.Sound("","sound/dozenGauge/close.mp3",scene,null,i)},Sounds.csg1={fire:new BABYLON.Sound("","sound/csg1/fire.mp3",scene,null,i),pullAction:new BABYLON.Sound("","sound/csg1/pull action.mp3",scene,null,i),releaseAction:new BABYLON.Sound("","sound/csg1/release action.mp3",scene,null,i)},Sounds.cluck9mm={fire:new BABYLON.Sound("fire","sound/cluck9mm/fire.mp3",scene,null,i),removeMag:new BABYLON.Sound("","sound/cluck9mm/remove mag.mp3",scene,null,i),insertMag:new BABYLON.Sound("","sound/cluck9mm/insert mag.mp3",scene,null,i)},Sounds.hammerClick=new BABYLON.Sound("","sound/hammerClick.mp3",scene),Sounds.ammo=new BABYLON.Sound("","sound/ammo.mp3",scene),Sounds.shellBurst=new BABYLON.Sound("","sound/shellBurst.mp3",scene,null,i),Sounds.hit=new BABYLON.Sound("","sound/hit.mp3",scene,null,i),Sounds.grenade={explode:new BABYLON.Sound("","sound/grenade.mp3",scene,null,i),beep:new BABYLON.Sound("","sound/grenadeBeep.mp3",scene,null,i),pin:new BABYLON.Sound("","sound/grenadePin.mp3",scene,null,i)},Sounds.death=[];for(var t=1;t<11;t++)Sounds.death.push(new BABYLON.Sound("","sound/death/scream"+t+".mp3",scene,null,i))}function loadMaterials(){if(Materials.bullet=new BABYLON.StandardMaterial("bulletMaterial",scene),Materials.bullet.emissiveColor=new BABYLON.Color3(1,1,1),shadowGen){e=["#define RECEIVESHADOWS"];engineCaps.textureFloat&&e.push("#define SHADOWFULLFLOAT")}else var e=[];e.push("#define DIRT"),Materials.map=new BABYLON.ShaderMaterial("",scene,"standard",{attributes:["position","normal","color","uv"],uniforms:["world","view","viewProjection","vFogInfos","vFogColor"],defines:e}),shadowGen&&(Materials.map.setTexture("shadowSampler",shadowGen.getShadowMapForRendering()),Materials.map.setMatrix("shadowLightMat",shadowGen.getTransformMatrix()),Materials.map.setVector3("shadowParams",shadowGen.getDarkness(),shadowGen.getShadowMap().getSize().width,shadowGen.bias)),Materials.map.onBind=function(e){var i=Materials.map.getEffect();i.setFloat4("vFogInfos",scene.fogMode,scene.fogStart,scene.fogEnd,scene.fogDensity),i.setColor3("vFogColor",scene.fogColor)},Materials.mapNoShadow=new BABYLON.ShaderMaterial("",scene,"standard",{attributes:["position","normal","color","uv"],uniforms:["world","view","viewProjection","vFogInfos","vFogColor"],defines:["#define DIRT"]}),Materials.mapNoShadow.onBind=function(e){var i=Materials.mapNoShadow.getEffect();i.setFloat4("vFogInfos",scene.fogMode,scene.fogStart,scene.fogEnd,scene.fogDensity),i.setColor3("vFogColor",scene.fogColor)},Materials.standard=new BABYLON.ShaderMaterial("",scene,"standard",{attributes:["position","normal","color","uv"],uniforms:["world","view","viewProjection","vFogInfos","vFogColor"]}),Materials.standard.onBind=function(e){var i=Materials.standard.getEffect();i.setFloat4("vFogInfos",scene.fogMode,scene.fogStart,scene.fogEnd,scene.fogDensity),i.setColor3("vFogColor",scene.fogColor)},Materials.standardInstanced=new BABYLON.ShaderMaterial("",scene,"standard",{attributes:["position","normal","color","uv","world0","world1","world2","world3"],uniforms:["world","view","viewProjection","vFogInfos","vFogColor"],defines:["#define INSTANCES"]}),Materials.standardInstanced.onBind=function(e){var i=Materials.standardInstanced.getEffect();i.setFloat4("vFogInfos",scene.fogMode,scene.fogStart,scene.fogEnd,scene.fogDensity),i.setColor3("vFogColor",scene.fogColor)},Materials.eggShell=new BABYLON.ShaderMaterial("",scene,"standard",{attributes:["position","normal","color","uv"],uniforms:["world","view","viewProjection","vFogInfos","vFogColor","hp"],defines:["#define EGGSHELL"]}),Materials.eggShell.onBind=function(e){var i=Materials.eggShell.getEffect();i.setFloat4("vFogInfos",scene.fogMode,scene.fogStart,scene.fogEnd,scene.fogDensity),i.setColor3("vFogColor",scene.fogColor),i.setFloat("hp",e.player.hp/100)},Materials.emissive=new BABYLON.ShaderMaterial("",scene,"standard",{attributes:["position","normal","color","uv"],uniforms:["world","view","viewProjection","vFogInfos","vFogColor","emissiveColor"],defines:["#define FLASH"]}),Materials.emissive.onBind=function(e){var i=Materials.emissive.getEffect();i.setFloat4("vFogInfos",scene.fogMode,scene.fogStart,scene.fogEnd,scene.fogDensity),i.setColor3("vFogColor",scene.fogColor),i.setColor3("emissiveColor",e.material.emissiveColor||BABYLON.Color3.Black())},Materials.wireframe=new BABYLON.StandardMaterial("",scene),Materials.wireframe=!0,Materials.normalBackface=new BABYLON.StandardMaterial("",scene),Materials.normalBackface.diffuseColor=new BABYLON.Color3(.5,.5,.5),Materials.normalBackface.ambientColor=new BABYLON.Color3(.5,.5,.5),Materials.normalBackface.specularColor=new BABYLON.Color3(0,0,0),Materials.normalBackface.backFaceCulling=!1,Materials.normalBackface.twoSidedLighting=!0,Materials.muzzleFlash=new BABYLON.StandardMaterial("",scene),Materials.muzzleFlash.emissiveColor=BABYLON.Color3.White(),Materials.ui=new BABYLON.StandardMaterial("ui",scene),Materials.ui.disableLighting=!0,Materials.ui.emissiveColor=BABYLON.Color3.White(),Materials.ui.fogEnabled=!1,Materials.eggWhite=new BABYLON.StandardMaterial("eggWhite",scene),Materials.eggWhite.disableLighting=!0,Materials.eggWhite.alpha=.8,Materials.eggWhite.emissiveColor=BABYLON.Color3.White(),Materials.eggYolk=new BABYLON.StandardMaterial("eggYolk",scene),Materials.eggYolk.disableLighting=!0,Materials.eggYolk.emissiveColor=BABYLON.Color3.White()}function loadMeshes(e,i,t,r){function n(){BABYLON.SceneLoader.ImportMesh("","models/",e[d]+".babylon",scene,function(e,s,y){for(var l=0;l<e.length;l++){var x=e[l];x.setEnabled(!1),x.setMaterial(Materials.standard),x.isPickable=!1,t?i.push(x):i[x.name]=x}d++,0==--a?r&&r.call(o):n()})}var a=e.length,o=this,d=0;n()}function Bullet(){this.x=0,this.y=0,this.z=0,this.dx=0,this.dy=0,this.dz=0,this.ttl=0,this.active=!1,this.player=null,this.damage=20,void 0!==BulletActor&&(this.actor=new BulletActor(this))}function collidesWithCell(e,i,t){if(e<0||e>=map.width||t<0||t>=map.depth||i<0||i>=map.height)return!1;var r=Math.floor(e),n=Math.floor(i),a=Math.floor(t),o=map.data[r][n][a];if(o.cat){if(o.cat==MAP.ramp)switch(o.dir){case 0:if(i-n>t-a)return!1;break;case 2:if(i-n>1-(t-a))return!1;break;case 1:if(i-n>e-r)return!1;break;case 3:if(i-n>1-(e-r))return!1}else if(o.cat==MAP.column){if((y=e%1-.5)*y+(s=t%1-.5)*s>.04)return!1}else if(o.cat==MAP.halfBlock){var d=i-n,s=t-a;if((y=e-r)>.7||y<.3||s>.7||s<.3||d>.5)return!1}else if(o.cat==MAP.tank){var y=e-r-.5,d=i-n-.5,s=t-a-.5;if(0==o.dir||2==o.dir){if(y*y+d*d>=.25)return!1}else if(s*s+d*d>=.25)return o}else{if(o.cat==MAP.ladder)return!1;if(o.cat==MAP.lowWall){var y=e%1,s=t%1;if((d=i%1)>.25)return!1;switch(o.dir){case 0:if(s<.75)return!1;break;case 1:if(y<.75)return!1;break;case 2:if(s>.25)return!1;break;case 3:if(y>.25)return!1}}}return{x:r,y:n,z:a,cel:o}}return!1}function ab2str(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function str2ab(e){for(var i=new Uint8Array(e.length),t=0,r=e.length;t<r;t++)i[t]=e.charCodeAt(t);return i}function Grenade(){this.x=0,this.y=0,this.z=0,this.dx=0,this.dy=0,this.dz=0,this.ttl=0,this.active=!1,this.player=null,void 0!==GrenadeActor&&(this.actor=new GrenadeActor(this))}function Gun(e){this.player=e,this.rofCountdown=0,this.shotsQueued=0,this.reloadCountdown=0,this.triggerPulled=!1,this.equipCountdown=0}function Eggk47(e){Gun.call(this,e),this.name="EggK-47",this.ammo={rounds:30,capacity:30,reload:30,store:240,storeMax:240,pickup:30},this.rof=6,this.automatic=!0,this.accuracy=15,this.shotSpreadIncrement=45,this.accuracySettleFactor=.91,this.damage=40,this.totalDamage=40,this.ttl=30,this.velocity=.5,this.range=this.ttl*this.velocity,this.equipTime=15,this.stowWeaponTime=15,this.longReloadTime=125,this.shortReloadTime=84,void 0!==Eggk47Actor&&(this.actor=new Eggk47Actor(this))}function DozenGauge(e){Gun.call(this,e),this.name="Dozen Gauge",this.ammo={rounds:2,capacity:2,reload:2,store:24,storeMax:24,pickup:8},this.rof=15,this.automatic=!1,this.accuracy=50,this.shotSpreadIncrement=160,this.accuracySettleFactor=.9,this.damage=9,this.totalDamage=20*this.damage,this.ttl=15,this.velocity=.45,this.range=this.ttl*this.velocity,this.equipTime=15,this.stowWeaponTime=15,this.longReloadTime=95,this.shortReloadTime=95,void 0!==DozenGaugeActor&&(this.actor=new DozenGaugeActor(this))}function CSG1(e){Gun.call(this,e),this.name="CSG-1",this.ammo={rounds:5,capacity:5,reload:5,store:15,storeMax:15,pickup:5},this.rof=60,this.automatic=!1,this.accuracy=0,this.shotSpreadIncrement=160,this.accuracySettleFactor=.969,this.damage=250,this.totalDamage=250,this.ttl=80,this.velocity=.6,this.range=this.ttl*this.velocity,this.hasScope=!0,this.equipTime=15,this.stowWeaponTime=15,this.longReloadTime=237,this.shortReloadTime=140,void 0!==CSG1Actor&&(this.actor=new CSG1Actor(this))}function Cluck9mm(e){Gun.call(this,e),this.name="Cluck 9mm",this.ammo={rounds:15,capacity:15,reload:15,store:60,storeMax:60,pickup:15},this.rof=6,this.automatic=!1,this.accuracy=30,this.shotSpreadIncrement=100,this.accuracySettleFactor=.82,this.damage=35,this.totalDamage=35,this.ttl=100,this.velocity=.45,this.range=this.ttl*this.velocity,this.equipTime=15,this.stowWeaponTime=15,this.longReloadTime=113,this.shortReloadTime=113,void 0!==Cluck9mmActor&&(this.actor=new Cluck9mmActor(this))}function MunitionsManager(){this.bulletPool=new Pool(function(){return new Bullet},200),this.grenadePool=new Pool(function(){return new Grenade},10)}function Player(e){this.id=e.id,this.name=e.name,this.charClass=e.charClass,this.x=e.x,this.y=e.y,this.z=e.z,this.dx=e.dx,this.dy=e.dy,this.dz=e.dz,this.viewYaw=e.viewYaw,this.controlKeys=e.controlKeys,this.moveYaw=e.moveYaw,this.pitch=e.pitch,this.totalKills=e.totalKills,this.totalDeaths=e.totalDeaths,this.killStreak=e.killStreak,this.bestKillStreak=e.bestKillStreak,this.hp=e.hp,this.weaponIdx=e.weaponIdx,this.equipWeaponIdx=0,this.stowWeaponCountdown=0,this.shotSpread=0,this.jumping=!1,this.climbing=!1,this.bobble=0,this.stateIdx=0,this.timeOfDeath=0,this.previousStates=Array(256).fill({delta:0,moveYaw:0,fire:!1,jump:!1,x:e.x,y:e.y,z:e.z,dx:0,dy:0,dz:0,controlKeys:0}),void 0!==PlayerActor&&(this.actor=new PlayerActor(this)),this.weapons=[new Cluck9mm(this),new classes[this.charClass].weapon(this)],this.weapon=this.weapons[0],this.grenadeCount=1,this.grenadeCapacity=3,this.grenadeThrown=!1,this.grenadeCountdown=0}function Pool(e,i){this.size=0,this.originalSize=i,this.constructorFn=e,this.objects=[],this.idx=0,this.numActive=0,this.expand(i)}BulletActor.prototype.fire=function(){this.mesh.setEnabled(!0),this.mesh.position.x=this.bullet.x,this.mesh.position.y=this.bullet.y,this.mesh.position.z=this.bullet.z,this.mesh.lookAt(new BABYLON.Vector3(this.bullet.x+this.bullet.dx,this.bullet.y+this.bullet.dy,this.bullet.z+this.bullet.dz)),this.mesh.rotation.x+=.015,this.mesh.rotation.y-=.015,this.mesh.scaling.z=.5},BulletActor.prototype.update=function(){this.mesh.position.x=this.bullet.x,this.mesh.position.y=this.bullet.y,this.mesh.position.z=this.bullet.z,this.mesh.scaling.z=Math.min(this.mesh.scaling.z+.05,3)},BulletActor.prototype.remove=function(){this.mesh.setEnabled(!1)};var v1=new BABYLON.Vector3,v2=new BABYLON.Vector3,Meshes={},Materials={},Sounds={},mapMesh;BABYLON.Mesh.prototype.attachToParent=function(e){this.parent=e,this.position=BABYLON.Vector3.Zero(),this.rotation=BABYLON.Vector3.Zero(),this.rotationQuaternion=BABYLON.Quaternion.Identity()},BABYLON.AbstractMesh.prototype.getChildMeshByName=function(e){for(var i=this.getChildMeshes(),t=0;t<i.length;t++)if(i[t].name==e)return i[t];return null},BABYLON.AbstractMesh.prototype.setLayerMask=function(e){this.layerMask=e;for(var i=this.getChildMeshes(),t=0;t<i.length;t++)i[t].setLayerMask(e)},BABYLON.AbstractMesh.prototype.setRenderingGroupId=function(e){this.renderingGroupId=e;for(var i=this.getChildMeshes(),t=0;t<i.length;t++)i[t].setRenderingGroupId(e)},BABYLON.AbstractMesh.prototype.setVisible=function(e){this.isVisible=e,e?this.unfreezeWorldMatrix():this.freezeWorldMatrix();for(var i=this.getChildMeshes(),t=0;t<i.length;t++)i[t].setVisible(e)},BABYLON.AbstractMesh.prototype.setMaterial=function(e){this.material=e;for(var i=this.getChildMeshes(),t=0;t<i.length;t++)i[t].setMaterial(e)},BABYLON.AbstractMesh.prototype.attachSound=function(e){this.attachedSounds||(this.attachedSounds=[]),e.attachToMesh(this),this.attachedSounds.push(e)},BABYLON.AbstractMesh.prototype.disposeOfSounds=function(){if(this.attachedSounds)for(var e in this.attachedSounds)this.attachedSounds[e].detachFromMesh(),this.attachedSounds[e].dispose();for(var i=this.getChildMeshes(),t=0;t<i.length;t++)i[t].disposeOfSounds()};var bulletHoleManager,explosionSmokeManager,explosionFireManager,respawnTime,players,keyIsDown,map,inputTally,light,camera,uiCamera,me,grenadeThrowPower=-1e3,lastTimeStamp,lastDelta,fps,fpsSum,fpsIdx,scope,reticle,hitIndicator,munitionsManager,itemManager,lastMouseMovement={},smokeColor=new BABYLON.Color4(.2,.2,.2,1),fireColor=new BABYLON.Color4(1,.8,.2,1),fireColors=[{pos:0,color:new BABYLON.Color4(1,.9,.8,1)},{pos:.2,color:new BABYLON.Color4(1,.5,.1,1)},{pos:.4,color:new BABYLON.Color4(.6,.2,0,1)},{pos:.7,color:new BABYLON.Color4(0,0,0,0)},{pos:1,color:new BABYLON.Color4(0,0,0,0)}],killDisplayTimeout,SPS,rotInc=Math.PI/2,pingStartTime,controlToBitmask={up:1,down:2,left:4,right:8};Scope.prototype.show=function(){var e=engine.getRenderHeight();this.sprite.size=e+20,this.crosshairs.scaling.x=e/2,this.crosshairs.scaling.y=e/2,this.crosshairs.setEnabled(!0),camera.viewport.width=e/engine.getRenderWidth(),camera.viewport.x=.5-.5*camera.viewport.width},Scope.prototype.hide=function(){this.sprite.size=0,this.crosshairs.setEnabled(!1),camera.viewport.width=1,camera.viewport.x=0},HitIndicator.prototype.resize=function(){this.mesh.scaling.x=engine.getRenderWidth(),this.mesh.scaling.y=engine.getRenderHeight()},HitIndicator.prototype.update=function(e){for(var i=7;i<48;i+=4)this.colors[i]-=(this.colors[i]+.5)/10*e;var t=Math.pow(.9,e);me&&!me.isDead()&&(camera.position.x*=t,camera.position.z*=t),this.mesh.updateVerticesData(BABYLON.VertexBuffer.ColorKind,this.colors,!0),document.getElementById("healthBar").style.width=me.hp+"%"},HitIndicator.prototype.hit=function(e,i){var t=Math.radRange(-Math.atan2(e,-i)-me.viewYaw+.393);t=Math.floor(t/Math.PI2*8);var r=new BABYLON.Vector2(-this.positions[3*t+3],-this.positions[3*t+4]).normalize();camera.position.x=.03*r.x,camera.position.z=.03*r.y,this.colors[4*t+7]=2},Reticle.prototype.update=function(e){if(me.weapon)for(var i=0;i<4;i++){var t=i*Math.PI/2,r=me.shotSpread+me.weapon.accuracy;this.lines[i].position.x=-Math.sin(t)*r,this.lines[i].position.y=Math.cos(t)*r}},Reticle.prototype.resize=function(){var e=engine.getRenderHeight()/640;this.mesh.scaling.x=e,this.mesh.scaling.y=e};var rays,rayIdx=0;GrenadeActor.prototype.throw=function(){this.mesh.setEnabled(!0),this.mesh.position.x=this.grenade.x,this.mesh.position.y=this.grenade.y,this.mesh.position.z=this.grenade.z,this.pinSound.play(),this.bounce()},GrenadeActor.prototype.update=function(){this.mesh.position.x=this.grenade.x,this.mesh.position.y=this.grenade.y,this.mesh.position.z=this.grenade.z,this.mesh.rotation.x+=this.rx,this.mesh.rotation.y+=this.ry,this.mesh.rotation.z+=this.rz,Math.sqrt(this.grenade.ttl)%2>1?(0==this.beep&&(this.beepSound.play(),this.beep=!0),this.mesh.material.emissiveColor=this.flashColor):(this.mesh.material.emissiveColor=BABYLON.Color3.Black(),this.beep=!1)},GrenadeActor.prototype.remove=function(){this.mesh.setEnabled(!1)},GrenadeActor.prototype.bounce=function(){var e=Math.length3(this.grenade.dx,this.grenade.dy,this.grenade.dz);this.rx=(4*Math.random()-2)*e,this.ry=(4*Math.random()-2)*e,this.rz=(4*Math.random()-2)*e},Eggk47Actor.prototype.addSoundEvent=function(e,i){var t=new BABYLON.AnimationEvent(e,function(){i.play()});this.playerActor.gripHand.animations[0].addEvent(t),this.gunMesh.attachSound(i)},Eggk47Actor.prototype.animate=function(e,i,t){scene.beginAnimation(this.playerActor.gripHand,e,i,!1,1,t),scene.beginAnimation(this.playerActor.foreHand,e,i,!1,1),scene.beginAnimation(this.gunMesh,e,i,!1,1),scene.beginAnimation(this.clipMesh,e,i,!1,1)},Eggk47Actor.prototype.dryFire=function(){this.dryFireSound.play()},Eggk47Actor.prototype.fire=function(){this.fireSound.play(),this.muzzleFlash.rotation.z=3.141*Math.random(),this.muzzleFlash.setEnabled(!0);var e=this;setTimeout(function(){e.muzzleFlash.setEnabled(!1)},40),this.animate(0,6)},Eggk47Actor.prototype.reload=function(){var e=this;this.animate(7,74,function(){e.gun.ammo.rounds>0?e.animate(133,154,function(){e.gun.reloadCountdown=0}):e.animate(74,132,function(){e.gun.reloadCountdown=0})})},Eggk47Actor.prototype.stow=function(){var e=this;this.animate(154,168,function(){e.gunMesh.setEnabled(!1),e.clipMesh.setEnabled(!1),e.gun.player.stowWeaponCountdown=0})},Eggk47Actor.prototype.equip=function(){var e=this;this.gunMesh.setEnabled(!0),this.clipMesh.setEnabled(!0),this.animate(168,182,function(){e.gun.equipCountdown=0})},Eggk47Actor.prototype.update=function(){},DozenGaugeActor.prototype.addSoundEvent=function(e,i){var t=new BABYLON.AnimationEvent(e,function(){i.play()});this.playerActor.gripHand.animations[0].addEvent(t),this.gunMesh.attachSound(i)},DozenGaugeActor.prototype.animate=function(e,i,t){scene.beginAnimation(this.playerActor.gripHand,e,i,!1,1,t),scene.beginAnimation(this.playerActor.foreHand,e,i,!1,1),scene.beginAnimation(this.gunMesh,e,i,!1,1),scene.beginAnimation(this.barrel,e,i,!1,1)},DozenGaugeActor.prototype.dryFire=function(){this.dryFireSound.play()},DozenGaugeActor.prototype.fire=function(){this.fireSound.play(),this.muzzleFlash.rotation.z=3.141*Math.random(),this.muzzleFlash.setEnabled(!0);var e=this;setTimeout(function(){e.muzzleFlash.setEnabled(!1)},40),this.animate(300,320)},DozenGaugeActor.prototype.reload=function(){var e=this;this.animate(320,415,function(){e.gun.reloadCountdown=0})},DozenGaugeActor.prototype.stow=function(){var e=this;this.animate(416,433,function(){e.gunMesh.setEnabled(!1),e.gun.player.stowWeaponCountdown=0})},DozenGaugeActor.prototype.equip=function(){var e=this;this.gunMesh.setEnabled(!0),this.animate(433,449,function(){e.gun.equipCountdown=0})},DozenGaugeActor.prototype.update=function(){},CSG1Actor.prototype.addSoundEvent=function(e,i){var t=new BABYLON.AnimationEvent(e,function(){i.play()});this.playerActor.gripHand.animations[0].addEvent(t),this.gunMesh.attachSound(i)},CSG1Actor.prototype.animate=function(e,i,t){scene.beginAnimation(this.playerActor.gripHand,e,i,!1,1,t),scene.beginAnimation(this.playerActor.foreHand,e,i,!1,1),scene.beginAnimation(this.gunMesh,e,i,!1,1),scene.beginAnimation(this.clipMesh,e,i,!1,1)},CSG1Actor.prototype.dryFire=function(){this.dryFireSound.play()},CSG1Actor.prototype.fire=function(){this.fireSound.play(),this.muzzleFlash.rotation.z=3.141*Math.random(),this.muzzleFlash.setEnabled(!0);var e=this;setTimeout(function(){e.muzzleFlash.setEnabled(!1)},40),this.animate(800,860)},CSG1Actor.prototype.reload=function(){var e=this;e.gun.ammo.rounds>0?this.animate(860,1e3,function(){e.gun.reloadCountdown=0}):this.animate(1001,1080,function(){e.animate(880,952,function(){e.animate(1081,1165,function(){e.gun.reloadCountdown=0})})})},CSG1Actor.prototype.stow=function(){var e=this;this.animate(1166,1181,function(){e.gunMesh.setEnabled(!1),e.clipMesh.setEnabled(!1),e.gun.player.stowWeaponCountdown=0})},CSG1Actor.prototype.equip=function(){var e=this;this.gunMesh.setEnabled(!0),this.clipMesh.setEnabled(!0),this.animate(1181,1196,function(){e.gun.equipCountdown=0})},CSG1Actor.prototype.update=function(){},Cluck9mmActor.prototype.addSoundEvent=function(e,i){var t=new BABYLON.AnimationEvent(e,function(){i.play()});this.playerActor.gripHand.animations[0].addEvent(t),this.gunMesh.attachSound(i)},Cluck9mmActor.prototype.animate=function(e,i,t){scene.beginAnimation(this.playerActor.gripHand,e,i,!1,1,t),scene.beginAnimation(this.playerActor.foreHand,e,i,!1,1),scene.beginAnimation(this.gunMesh,e,i,!1,1),scene.beginAnimation(this.clipMesh,e,i,!1,1)},Cluck9mmActor.prototype.dryFire=function(){this.dryFireSound.play()},Cluck9mmActor.prototype.fire=function(){this.fireSound.play(),this.muzzleFlash.rotation.z=3.141*Math.random(),this.muzzleFlash.setEnabled(!0);var e=this;setTimeout(function(){e.muzzleFlash.setEnabled(!1)},40),this.animate(600,606)},Cluck9mmActor.prototype.reload=function(){var e=this;this.animate(607,720,function(){e.gun.reloadCountdown=0})},Cluck9mmActor.prototype.stow=function(){var e=this;this.animate(721,735,function(){e.gunMesh.setEnabled(!1),e.gun.player.stowWeaponCountdown=0})},Cluck9mmActor.prototype.equip=function(){var e=this;this.gunMesh.setEnabled(!0),this.animate(735,750,function(){e.gun.equipCountdown=0})},Cluck9mmActor.prototype.update=function(){},ItemActor.prototype.update=function(e){this.mesh.rotation.y+=.03*e},ItemActor.prototype.remove=function(){this.mesh.setEnabled(!1)},AmmoActor.prototype=Object.create(ItemActor.prototype),AmmoActor.prototype.constructor=ItemActor,GrenadeItemActor.prototype=Object.create(ItemActor.prototype),GrenadeItemActor.prototype.constructor=ItemActor,ItemManager.AMMO=0,ItemManager.GRENADE=1,ItemManager.Constructors=[AmmoActor,GrenadeItemActor],ItemManager.prototype.update=function(e){for(var i=0;i<this.pools.length;i++)this.pools[i].forEachActive(function(i){i.update(e),isMeshVisible(i.mesh)})},ItemManager.prototype.spawnItem=function(e,i,t,r,n){var a=this.pools[i].retrieve(e);a.mesh.setEnabled(!0),a.mesh.position.x=t,a.mesh.position.y=r,a.mesh.position.z=n},ItemManager.prototype.collectItem=function(e,i){this.pools[e].recycle(this.pools[e].objects[i]),this.pools[e].objects[i].remove()};var fbAppId="503435033333554",engine,scene,canvas,shadowGen,camera,light,engineCaps,ws,selectedClass,selectedServer,meId,username,gameSession,facebookId,gameStartTime,pingTotal,pingSamples,fpsTotal,fpsSamples,nextPingSample,inGame=!1,uniqueId,uniqueKey,mapIdx,privateGame,playOffline=!1,mapTest={},settings={},nameTestCanvas=document.createElement("canvas"),inputToControlMap={W:"up",S:"down",A:"left",D:"right",SPACE:"jump","MOUSE 0":"fire",SHIFT:"scope",R:"reload",E:"weapon",Q:"grenade"},ga;!function(e,i,t,r,n,a,o){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,a=i.createElement(t),o=i.getElementsByTagName(t)[0],a.async=1,a.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(a,o)}(window,document,"script",0,"ga"),ga("create","UA-105800112-1","auto"),ga("send","pageview"),window.onmessage=function(e){var i=e.data;"function"==typeof window[i.func]&&window[i.func].call(null,i.message)},window.addEventListener("contextmenu",function(e){e.preventDefault()},!1),window.onresize=function(){resize()},window.onload=function(){function e(e){console.log(e),facebookId=null,gameSession=null,z=e;var i=document.getElementById("ritekit-alerts");i&&(i.style.visibility="hidden"),"connected"===e.status?(document.getElementById("fbLoginRequest").style.display="none",document.getElementById("statsRetrieval").style.display="block",facebookId=e.authResponse.userID,getRequest("!host_specific/requestUserData.php?id="+e.authResponse.userID+"&token="+e.authResponse.accessToken,function(e){try{var i=JSON.parse(e);if(i.error)document.getElementById("stats").innerText="DB error: "+i.error;else{var t=Math.floor(i.kills/Math.max(i.kills+i.deaths,1)*100);document.getElementById("stats").innerHTML=i.kills.toLocaleString()+"<br>"+i.deaths.toLocaleString()+"<br>"+t+"%<br>"+i.streak.toLocaleString(),document.getElementById("statsRetrieval").style.display="none",document.getElementById("statsPane").style.display="block",gameSession=i.session}}catch(i){document.getElementById("stats").innerHTML=e}})):(z={status:null},document.getElementById("fbLoginRequest").style.display="block")}if(resize(),BABYLON.Engine.isSupported()){for(var i=[{image:"TopTank_banner_01.png",link:"https://itunes.apple.com/app/top-tank/id925229581?mt=8"},{image:"TopTank_banner_01.png",link:"https://itunes.apple.com/app/top-tank/id925229581?mt=8"},{image:"TopTank_banner_01.png",link:"https://itunes.apple.com/app/top-tank/id925229581?mt=8"},{image:"TopTank_banner_01.png",link:"https://itunes.apple.com/app/top-tank/id925229581?mt=8"},{image:"ST_banner_00.png",link:"http://store.steampowered.com/app/562230/Space_Tyrant/"},{image:"ST_banner_01.jpg",link:"http://store.steampowered.com/app/562230/Space_Tyrant/"},{image:"ST_banner_02.jpg",link:"http://store.steampowered.com/app/562230/Space_Tyrant/"},{image:"ST_banner_03.jpg",link:"http://store.steampowered.com/app/562230/Space_Tyrant/"},{image:"ST_banner_04.jpg",link:"http://store.steampowered.com/app/562230/Space_Tyrant/"}],t=(Math.randomInt(0,i.length),document.getElementById("serverSelect")),r=0;r<servers.length;r++){var n=servers[r];(s=document.createElement("option")).textContent=n.name,t.appendChild(s),n.pingEl=new Image,n.pingEl.idx=r,n.pingEl.onerror=function(e){selectedServer=e.target.idx,t.selectedIndex=selectedServer;for(var i=0;i<servers.length;i++)servers[i].pingEl.onerror=null}}for(r=0;r<servers.length;r++)servers[r].pingEl.src=location.protocol+"//"+servers[r].address;settings.volume=getStoredNumber("volume",1),settings.mouseSensitivity=Math.max(Math.min(11,getStoredNumber("mouseSensitivity",5)),0),settings.mouseInvert=getStoredNumber("mouseInvert",1),settings.holdToAim=getStoredBool("holdToAim",!0),settings.autoDetail=getStoredBool("autoDetail",!0),settings.enableShadows=getStoredBool("enableShadows",!0),settings.highRes=getStoredBool("highRes",!0),setDetailSettingsVisibility(settings.autoDetail),document.getElementById("volume").value=settings.volume,document.getElementById("mouseSensitivity").value=settings.mouseSensitivity,document.getElementById("mouseInvert").checked=-1==settings.mouseInvert,document.getElementById("holdToAim").checked=settings.holdToAim,document.getElementById("autoDetail").checked=settings.autoDetail,document.getElementById("enableShadows").checked=settings.enableShadows,document.getElementById("highRes").checked=settings.highRes;var a=JSON.parse(localStorage.getItem("controlConfig"));for(var o in a)a.hasOwnProperty(o)&&(inputToControlMap[o]=a[o]);for(var d in inputToControlMap)inputToControlMap.hasOwnProperty(d)&&d!=d.toLocaleUpperCase()&&(inputToControlMap[d.toLocaleUpperCase()]=inputToControlMap[d],delete inputToControlMap[d]);for(var o in inputToControlMap){var s=document.getElementById(inputToControlMap[o]);s&&(s.innerText=o.toLocaleUpperCase(),s.style.fontWeight="bold",s.style.color="#fff")}for(var y=document.getElementById("playerList"),l=document.getElementById("playerSlot"),r=0;r<20;r++){var x=l.cloneNode(!0);y.appendChild(x)}getStoredNumber("hideHelp",null)&&(document.getElementById("help").style.display="none");var z={status:null};if(window.checkLoginState=function(){FB.getLoginStatus(function(i){e(i)})},window.fbAsyncInit=function(){FB.init({appId:fbAppId,cookie:!0,xfbml:!0,version:"v2.8"}),FB.AppEvents.logPageView(),FB.getLoginStatus(function(i){e(i)}),FB.Event.subscribe("auth.login",function(i){e(i)})},function(e,i,t){var r,n=e.getElementsByTagName(i)[0];e.getElementById(t)||((r=e.createElement(i)).id=t,r.src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.11&appId=503435033333554",n.parentNode.insertBefore(r,n))}(document,"script","facebook-jssdk"),canvas=document.createElement("canvas"),document.getElementById("offCanvasContainer").appendChild(canvas),resize(),engine=new BABYLON.Engine(canvas,!0,null,!1),engineCaps=engine.getCaps(),"?openSettings"==window.location.search&&openSettingsMenu(),window.location.search.startsWith("?testMap")){playOffline=!0;var h=window.location.search.split("&");mapTest.x=Number(h[1]),mapTest.y=Number(h[2]),mapTest.z=Number(h[3]),mapTest.pitch=Number(h[4]),mapTest.yaw=Number(h[5])}window.location.hash&&(openJoinBox(),document.getElementById("joinCode").value=window.location.hash.substr(1));var c=document.getElementById("username");c.value=getStoredString("lastUsername",""),c.addEventListener("keyup",function(e){c.value=fixNameWidth(e.target.value),"Enter"!=e.code&&13!=e.keyCode||(c.disabled=!0,login())}),playOffline?(ws={send:function(){}},inGame=!0,startGame()):showMainMenu()}else openAlertDialog("OH, NO!",'Shell Shockers requires WebGL, but your<br>browser is not configured to support it.<br><br><a style="text-decoration: underline" target="_window" href="http://shellshock.io/faq.html#webgl">Click here to learn more</a>')},window.onbeforeunload=function(e){if(gameStartTime>0){var i=Date.now()-gameStartTime;ga("send","timing","game","play time",i),fbq("trackCustom","EndGame",{timePlayed:i})}pingSamples>4&&(ga("send","timing","game","ping",Math.floor(pingTotal/pingSamples),servers[selectedServer].name),ga("send","event","game","stats","fps",Math.ceil(fpsTotal/fpsSamples)),ga("send","event","game","settings","volume",settings.volume),ga("send","event","game","settings","mouse sensitivity",settings.mouseSensitivity),ga("send","event","game","settings","mouse invert",settings.mouseInvert))};var controlEl,alertBarInterval;document.onfullscreenchange=onFullscreenChange,document.onmsfullscreenchange=onFullscreenChange,document.onmozfullscreenchange=onFullscreenChange,document.onwebkitfullscreenchange=onFullscreenChange;var shake;PlayerActor.prototype.update=function(e){var i=Math.cos(this.player.bobble)*this.bobbleIntensity,t=Math.abs(Math.sin(this.player.bobble)*this.bobbleIntensity),r=Math.sin(2*this.player.bobble)*this.bobbleIntensity;this.player.id==meId&&(this.scope&&this.player.isAtReady()?(camera.fov=camera.fov+(this.player.weapon.actor.scopeFov-camera.fov)/3,this.gunContainer.rotation.y*=.667,this.gunContainer.rotation.x*=.667,this.gunContainer.position.x+=(-.15-this.gunContainer.position.x)/3,this.gunContainer.position.y+=(this.player.weapon.actor.scopeY-this.gunContainer.position.y)/4,this.gunContainer.position.z+=(-.05-this.gunContainer.position.z)/3,this.player.weapon.hasScope&&!this.zoomed&&camera.fov<this.player.weapon.actor.scopeFov+.05&&(scope.show(),this.gunContainer.setEnabled(!1),this.zoomed=!0)):(camera.fov=camera.fov+(1.25-camera.fov)/3,this.gunContainer.rotation.y+=(2*i-.14-this.gunContainer.rotation.y)/3,this.gunContainer.rotation.x+=(.75*r-.035-this.gunContainer.rotation.x)/3,this.gunContainer.position.x*=.667,this.gunContainer.position.y*=.667,this.gunContainer.position.z*=.667,this.zoomed&&camera.fov>this.player.weapon.actor.scopeFov+.05&&(scope.hide(),this.gunContainer.setEnabled(!0),this.zoomed=!1)));var n=this.player.x-this.mesh.position.x,a=this.player.y-this.mesh.position.y,o=this.player.z-this.mesh.position.z;Math.length3(n,a,o)<.9?(this.mesh.position.x+=n/6,this.mesh.position.y+=a/2,this.mesh.position.z+=o/6):(this.mesh.position.x=this.player.x,this.mesh.position.y=this.player.y,this.mesh.position.z=this.player.z);var d=.9;this.player.id!=meId&&(d=.5);var s=Math.radDifference(this.player.viewYaw,this.mesh.rotation.y),y=Math.radDifference(this.player.pitch,this.head.rotation.x);this.player.addRotationShotSpread(s,y),this.mesh.rotation.y+=s*d,this.head.rotation.x+=y*d,this.bodyMesh.rotation.x=this.head.rotation.x/4;var l;if(l=this.player.jumping?0:Math.length3(this.player.dx,this.player.dy,this.player.dz),this.bobbleIntensity+=(l-this.bobbleIntensity)/10,this.bodyMesh.rotation.z=5*i,this.bodyMesh.position.y=1.5*t+.32,shake>0)if((shake*=.9)<.001)shake=0;else{var x=Math.random()*shake-.5*shake,z=Math.random()*shake-.5*shake,h=Math.random()*shake-.5*shake;this.eye.rotation.x+=(x-this.eye.rotation.x)/10,this.eye.rotation.y+=(z-this.eye.rotation.y)/10,this.eye.rotation.z+=(h-this.eye.rotation.z)/10}else this.eye.rotation.x*=.9,this.eye.rotation.y*=.9,this.eye.rotation.z*=.9;this.player.id!=meId&&isMeshVisible(this.mesh,.31),this.hitSoundDelay=Math.max(this.hitSoundDelay-e,0)},PlayerActor.prototype.scopeIn=function(){this.scope=!0},PlayerActor.prototype.scopeOut=function(){this.scope=!1},PlayerActor.prototype.hit=function(){this.hitSoundDelay<=0&&(this.hitSound.play(),this.hitSoundDelay=10)},PlayerActor.prototype.die=function(){this.bodyMesh.setEnabled(!1),this.head.setEnabled(!1),this.eye.setEnabled(!1),this.player.id==meId&&(scope.hide(),this.gunContainer.setEnabled(!0),this.zoomed=!1,this.scope=!1,camera.fov=1.25,this.player.grenadeCountdown=0,document.getElementById("grenadeThrowContainer").style.visibility="hidden"),this.nameSurface&&this.nameSurface.setEnabled(!1)},PlayerActor.prototype.respawn=function(){this.bodyMesh.setEnabled(!0),this.head.setEnabled(!0),this.eye.setEnabled(!0),this.nameSurface&&this.nameSurface.setEnabled(!0),this.explodeMesh.setEnabled(!1),this.whiteMesh.setEnabled(!1),this.yolkMesh.setEnabled(!1)},PlayerActor.prototype.remove=function(){this.mesh.disposeOfSounds(),this.mesh.dispose()},PlayerActor.prototype.fire=function(){this.zoomed&&this.player.weapon.hasScope&&(shake=.25,this.eye.rotation.x=-.1)},PlayerActor.prototype.reachForGrenade=function(){this.player.isAtReady()&&this.player.grenadeCount>0&&0==this.player.grenadeCountdown&&(this.player.grenadeCountdown=1,this.oldHandPos=this.foreHand.position,this.oldHandRot=this.foreHand.rotationQuaternion,this.oldHandParent=this.foreHand.parent,this.foreHand.parent=this.gunContainer,scene.beginAnimation(this.foreHand,1300,1315,!1,1))},PlayerActor.prototype.cancelGrenade=function(){this.player.grenadeCountdown=0,this.foreHand.position=this.oldHandPos,this.foreHand.rotationQuaternion=this.oldHandRot,this.foreHand.parent=this.oldHandParent,this.player.id==meId&&(document.getElementById("grenadeThrowContainer").style.visibility="hidden")},PlayerActor.prototype.throwGrenade=function(){var e=this;this.player.id!=meId&&(this.oldHandPos=this.foreHand.position,this.oldHandRot=this.foreHand.rotationQuaternion,this.oldHandParent=this.foreHand.parent,this.foreHand.parent=this.gunContainer),scene.beginAnimation(this.foreHand,1315,1350,!1,1,function(){e.cancelGrenade()})},BABYLON.Effect.ShadersStore.standardVertexShader="\n#include<instancesDeclaration>\n\nprecision lowp float;\n\n// Attributes\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec4 color;\nattribute vec2 uv;\n\n// Uniforms\n//uniform mat4 world;\nuniform mat4 view;\nuniform mat4 viewProjection;\nuniform mat4 shadowLightMat;\n\n// Varying\nvarying vec4 vPositionFromLight;\nvarying vec3 vNormal;\nvarying vec4 vColor;\nvarying vec4 vEmissiveColor;\nvarying float fFogDistance;\n\nfloat random(vec3 p)\n{\nvec3 K1 = vec3(23.14069263277926, 2.665144142690225, 8.2318798443);\nreturn fract(cos(dot(p, K1)) * 12345.6789);\n}\n\n// MAIN\nvoid main(void) {\n#include<instancesVertex>\nvec4 worldPosition = finalWorld * vec4(position, 1.);\n\n#ifdef RECEIVESHADOWS\nvPositionFromLight = shadowLightMat * worldPosition;\n#endif\n\nvNormal = normalize(vec3(finalWorld * vec4(normal, 0.0)));\nvColor = color;\n\n#ifdef DIRT\nvColor.rgb *= random(worldPosition.xyz) * 0.2 + 0.7;\n#endif\n\nfFogDistance = (view * worldPosition).z;\ngl_Position = viewProjection * worldPosition;\n}\n",BABYLON.Effect.ShadersStore.standardPixelShader="\n#define FOGMODE_NONE 0.\n#define FOGMODE_EXP 1.\n#define FOGMODE_EXP2 2.\n#define FOGMODE_LINEAR 3.\n#define E 2.71828\n\nprecision lowp float;\n\n// Uniforms\nuniform sampler2D shadowSampler;\nuniform vec3 shadowParams;\nuniform vec4 vFogInfos;\nuniform vec3 vFogColor;\nuniform vec3 emissiveColor;\nuniform mat4 worldView;\nuniform float hp;\n\n// Varying\nvarying vec4 vPositionFromLight;\nvarying vec4 vColor;\nvarying vec3 vNormal;\nvarying float fFogDistance;\n\nconst float sOff = .001;\n\n// FUNCTIONS\nfloat unpack(vec4 color)\n{\nconst vec4 bit_shift = vec4(1.0 / (255.0 * 255.0 * 255.0), 1.0 / (255.0 * 255.0), 1.0 / 255.0, 1.0);\nreturn dot(color, bit_shift);\n}\n\nfloat random(vec2 p)\n{\nvec2 K1 = vec2(23.14069263277926, 2.665144142690225);\nreturn fract(cos(dot(p, K1)) * 12345.6789);\n}\n\nfloat calcFogFactor()\n{\nfloat fogCoeff = 1.0;\nfloat fogStart = vFogInfos.y;\nfloat fogEnd = vFogInfos.z;\nfloat fogDensity = vFogInfos.w;\n\nfogCoeff = 1.0 / pow(E, fFogDistance * fFogDistance * fogDensity * fogDensity * 4.); // Exp2\n\nreturn clamp(fogCoeff, 0.0, 1.0);\n}\n\nfloat computeShadow(vec4 vPositionFromLight, sampler2D shadowSampler, float darkness)\n{\nvec3 depth = vPositionFromLight.xyz / vPositionFromLight.w;\ndepth = 0.5 * depth + vec3(0.5);\nvec2 uv = depth.xy;\n\nif (uv.x < 0. || uv.x > 1.0 || uv.y < 0. || uv.y > 1.0)\n{\nreturn 1.0;\n}\n\n#ifndef SHADOWFULLFLOAT\nfloat shadow = unpack(texture2D(shadowSampler, uv));\n#else\nfloat shadow = texture2D(shadowSampler, uv).x;\n#endif\n\nif (depth.z < shadow) return 1.;\nfloat s = clamp((depth.z - shadow) * 12. + 0.5, 0.5, 1.0);\nreturn min(1.0, max(s, length(vPositionFromLight.xy)));\n}\n\nvec3 desaturate(vec3 color, float amount)\n{\nvec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), color));\nreturn vec3(mix(color, gray, amount));\n}\n\n// MAIN\nvoid main(void)\n{\nvec4 color = vColor;\n\n#ifdef EGGSHELL // Show cracks!\ncolor.rgb = min((color.rgb - 0.5) * 4. + hp + 2., 1.);\n#endif\n\n#ifdef RECEIVESHADOWS\nfloat s = computeShadow(vPositionFromLight, shadowSampler, shadowParams.x);\n{\ncolor *= vec4(s, s, s, 1.);\n}\n#endif\n\ncolor.rgb *= max(max(0., -vNormal.y * 0.4), dot(vNormal, normalize(vec3(-.2, 1., -.1)) * 1.) + 0.4);\n\n#ifdef FLASH\ncolor.rgb += emissiveColor;\n#endif\n\nfloat fog = calcFogFactor();\ncolor.rgb = fog * color.rgb + (1.0 - fog) * vFogColor;\n\ngl_FragColor = color;\n}\n",Bullet.prototype.remove=function(){munitionsManager.bulletPool.recycle(this),this.actor&&this.actor.remove()},Bullet.prototype.update=function(e){this.ttl<=0||this.collidesWithMap()?this.remove():(this.x+=this.dx*e,this.y+=this.dy*e,this.z+=this.dz*e,this.ttl-=e,this.actor&&this.actor.update())},Bullet.prototype.fire=function(e,i,t,r,n,a){this.player=e,this.x=i.x,this.y=i.y,this.z=i.z,this.dx=t.x*a,this.dy=t.y*a,this.dz=t.z*a,this.ttl=n,this.damage=r,this.active=!0,this.actor&&this.actor.fire()},Bullet.prototype.collidesWithMap=function(){var e=collidesWithCell(this.x,this.y,this.z);if(e){if(this.actor){var i=map.data[e.x][e.y][e.z];if(i&&i.cat>0&&Meshes.map[i.cat][i.dec]){var t=new BABYLON.Ray(new BABYLON.Vector3(this.x-this.dx-e.x-.5,this.y-this.dy-e.y,this.z-this.dz-e.z-.5),new BABYLON.Vector3(this.dx,this.dy,this.dz),new BABYLON.Vector3(this.dx,this.dy,this.dz).length);Meshes.map[i.cat][i.dec].rotation.y=i.dir*rotInc;var r=t.intersectsMesh(Meshes.map[i.cat][i.dec],!1);if(r.hit){var n=new BABYLON.Vector3(-this.dx,-this.dy,-this.dz).normalize().scale(.005);bulletHoleManager.addHole(0,r.pickedPoint.x+e.x+.5+n.x,r.pickedPoint.y+e.y+n.y,r.pickedPoint.z+e.z+.5+n.z)}}}return!0}return!1};var CloseCode={gameNotFound:4e3,gameFull:4001,badName:4002,mainMenu:4003},Comm={loggedIn:0,addPlayer:1,removePlayer:2,chat:3,keyDown:4,keyUp:5,sync:6,fire:7,jump:8,die:9,hitThem:10,hitMe:11,collectItem:12,spawnItem:13,respawn:14,startReload:15,reload:16,stowWeapon:17,equipWeapon:18,fireBullet:19,fireShot:20,login:21,ping:22,pong:23,clientReady:24,requestRespawn:25,throwGrenade:26,joinPublicGame:27,joinPrivateGame:28,createPrivateGame:29,output:function(e){this.buffer=new Uint8Array(e),this.idx=0,this.packInt8=function(e){this.buffer[this.idx]=255&e,this.idx++},this.packInt16=function(e){this.buffer[this.idx]=255&e,this.buffer[this.idx+1]=e>>8&255,this.idx+=2},this.packInt32=function(e){this.buffer[this.idx]=255&e,this.buffer[this.idx+1]=e>>8&255,this.buffer[this.idx+2]=e>>16&255,this.buffer[this.idx+3]=e>>24&255,this.idx+=4},this.packRadU=function(e){this.packInt16(1e4*e)},this.packRad=function(e){this.packInt16(1e4*(e+Math.PI))},this.packFloat=function(e){this.packInt16(100*e)},this.packString=function(e){this.packInt8(e.length);for(var i=0;i<e.length;i++)this.packInt16(e.charCodeAt(i))}},input:function(e){this.buffer=new Uint8Array(e),this.idx=0,this.isMoreDataAvailable=function(){return this.idx<this.buffer.length},this.unPackInt8U=function(){var e=this.idx;return this.idx++,this.buffer[e]},this.unPackInt8=function(){return(this.unPackInt8U()+128)%256-128},this.unPackInt16U=function(){var e=this.idx;return this.idx+=2,this.buffer[e]+(this.buffer[e+1]<<8)},this.unPackInt32U=function(){var e=this.idx;return this.idx+=4,this.buffer[e]+256*this.buffer[e+1]+65536*this.buffer[e+2]+16777216*this.buffer[e+3]},this.unPackInt16=function(){return(this.unPackInt16U()+32768)%65536-32768},this.unPackRadU=function(){return this.unPackInt16U()/1e4},this.unPackRad=function(){return this.unPackRadU()-Math.PI},this.unPackFloat=function(){return this.unPackInt16()/100},this.unPackString=function(e){e=e||1e3;for(var i=Math.min(this.unPackInt8U(),e),t=new String,r=0;r<i;r++){var n=this.unPackInt16U();n>0&&(t+=String.fromCharCode(n))}return t}}},MAP={blank:0,ground:1,block:2,column:3,halfBlock:4,ramp:5,ladder:6,tank:7,lowWall:8,todo3:9},GameMap={makeMinMap:function(e){e.min={},e.min.width=e.width,e.min.depth=e.depth,e.min.height=e.height,e.min.data={};for(var i=0;i<e.width;i++)for(var t=0;t<e.height;t++)for(var r=0;r<e.depth;r++){var n=e.data[i][t][r];n.cat&&(e.min.data[n.cat]||(e.min.data[n.cat]={}),e.min.data[n.cat][n.dec]||(e.min.data[n.cat][n.dec]=[]),e.min.data[n.cat][n.dec].push({x:i,y:t,z:r,dir:n.dir}))}},generateMap:function(e,i,t,r){Math.seed=r;var n={};n.width=e,n.depth=i,n.height=t,n.seed=r,n.data=Array(n.width);for(s=0;s<n.width;s++){n.data[s]=Array(n.height);for(h=0;h<n.height;h++)n.data[s][h]=Array(n.depth).fill({})}for(c=0;c<n.width*n.depth*n.height*.2;)for(var a=Math.seededRandomInt(4,8),o=Math.seededRandomInt(4,8),d=Math.seededRandomInt(2,c%n.height),s=Math.seededRandomInt(1,n.width-1-a),y=Math.seededRandomInt(1,n.depth-1-o),l=(Math.seededRandomInt(1,4),s);l<s+a;l++)for(p=y;p<y+o;p++)for(var x=0;x<d;x++){var z=l==s||p==y||l==s+a-1||p==y+o-1;n.data[l][x][p].cat||c++,n.data[l][x][p]=z?{cat:1,dec:4,dir:Math.seededRandomInt(0,4)}:x%2==0?{cat:1,dec:0,dir:Math.seededRandomInt(0,4)}:{cat:1,dec:4,dir:Math.seededRandomInt(0,4)}}for(s=0;s<n.width;s++)for(h=0;h<n.height;h++)for(y=0;y<n.depth;y++)0==n.data[s][h][y].dec&&(n.data[s][h][y]={});for(u=0;u<n.width*n.depth*n.height/2;u++){var s=Math.seededRandomInt(0,n.width),h=2*Math.seededRandomInt(0,Math.floor(n.height/2)),y=Math.seededRandomInt(0,n.depth);1==n.data[s][h][y].cat&&n.data[s][h][y].dec>0&&4==GameMap.numNeighbors6(n,s,h,y)&&(n.data[s][h][y]={})}for(var c=0;c<n.width*n.depth*n.height/60;){var s=Math.seededRandomInt(1,n.width-1),h=Math.seededRandomInt(0,n.height-1),y=Math.seededRandomInt(1,n.depth-1);n.data[s][h][y].cat||0!=h&&1!=n.data[s][h-1][y].cat||(1!=n.data[s][h][y+1].cat||n.data[s][h+1][y+1].cat||n.data[s][h][y-1].cat||0!=h&&1!=n.data[s][h-1][y-1].cat?1!=n.data[s+1][h][y].cat||n.data[s+1][h+1][y].cat||n.data[s-1][h][y].cat||0!=h&&1!=n.data[s-1][h-1][y].cat?1!=n.data[s][h][y-1].cat||n.data[s][h+1][y-1].cat||n.data[s][h][y+1].cat||0!=h&&1!=n.data[s][h-1][y+1].cat?1!=n.data[s-1][h][y].cat||n.data[s-1][h+1][y].cat||n.data[s+1][h][y].cat||0!=h&&1!=n.data[s+1][h-1][y].cat||(n.data[s][h][y]={cat:2,dec:0,dir:3},n.data[s][h+1][y]={},n.data[s+1][h+1][y]={},c++):(n.data[s][h][y]={cat:2,dec:0,dir:2},n.data[s][h+1][y]={},n.data[s][h+1][y+1]={},c++):(n.data[s][h][y]={cat:2,dec:0,dir:1},n.data[s][h+1][y]={},n.data[s-1][h+1][y]={},c++):(n.data[s][h][y]={cat:2,dec:0,dir:0},n.data[s][h+1][y]={},n.data[s][h+1][y-1]={},c++))}for(u=0;u<n.width*n.depth*n.height/10;u++){var s=Math.seededRandomInt(1,n.width-1),h=Math.seededRandomInt(0,n.height-1),y=Math.seededRandomInt(1,n.depth-1);!n.data[s][h][y].cat&&(0==h||1==n.data[s][h-1][y].cat)&&GameMap.numNeighbors26(n,s,h,y)<11&&(n.data[s][h][y]={cat:4,dec:0,dir:0})}for(var u=0;u<n.width*n.depth*n.height/10;u++){var s=Math.seededRandomInt(1,n.width-1),h=Math.seededRandomInt(0,n.height-1),y=Math.seededRandomInt(1,n.depth-1);if(!n.data[s][h][y].cat&&(0==h||1==n.data[s][h-1][y].cat&&4==n.data[s][h-1][y].dec)&&GameMap.numNeighbors26(n,s,h,y)<11){n.data[s][h][y]={cat:1,dec:Math.seededRandomInt(1,4),dir:Math.seededRandomInt(0,4)};for(var m=0;m<20;m++){var l=s+Math.seededRandomInt(-1,2),p=y+Math.seededRandomInt(-1,2);if(4==n.data[p][h][p].cat)break;if(!n.data[p][h][p].cat&&(0==h||1==n.data[l][h-1][p].cat&&4==n.data[l][h-1][p].dec)){n.data[l][h][p]={cat:4,dec:0,dir:0};break}}}}for(s=0;s<n.width;s++)for(y=0;y<n.depth;y++)for(h=0;h<n.height-1;h++)!n.data[s][h][y].cat&&this.numNeighbors6(n,s,h,y)>=4&&!n.data[s][h+1][y].cat&&(n.data[s][h][y]={cat:1,dec:this.firstNeighborDec(n,s,h,y),dir:Math.seededRandomInt(0,4)});for(s=0;s<n.width;s++)for(h=0;h<n.height;h++)for(y=0;y<n.depth;y++)n.data[s][h][y].cat&&6==GameMap.numNeighbors6(n,s,h,y)&&(n.data[s][h][y].cat=1,n.data[s][h][y].dec=0);return GameMap.makeMinMap(n),n},firstNeighborDec:function(e,i,t,r){for(var n=Math.max(1,i-1);n<=Math.min(e.width-2,i+1);n++)for(var a=Math.max(0,t-1);a<=Math.min(e.height-1,t+1);a++)for(var o=Math.max(1,r-1);o<=Math.min(e.depth-2,r+1);o++)if((i!=n||t!=a||r!=o)&&1==e.data[n][a][o].cat)return e.data[n][a][o].dec;return 0},numNeighbors6:function(e,i,t,r){for(var n=0,a=Math.max(1,i-1);a<=Math.min(e.width-2,i+1);a++)for(var o=Math.max(0,t-1);o<=Math.min(e.height-1,t+1);o++)for(var d=Math.max(1,r-1);d<=Math.min(e.depth-2,r+1);d++)Math.abs(a-i)+Math.abs(o-t)+Math.abs(d-r)==1&&1==e.data[a][o][d].cat&&n++;return 0==t&&n++,n},numNeighbors26:function(e,i,t,r){for(var n=0,a=Math.max(1,i-1);a<=Math.min(e.width-2,i+1);a++)for(var o=Math.max(0,t-1);o<=Math.min(e.height-1,t+1);o++)for(var d=Math.max(1,r-1);d<=Math.min(e.depth-2,r+1);d++)i==a&&t==o&&r==d||1==e.data[a][o][d].cat&&n++;return 0==t&&(n+=9),n}};Grenade.prototype.update=function(e){if(this.ttl<=0)if(munitionsManager.grenadePool.recycle(this),this.actor){addExplosion(this.x,this.y,this.z,this.damage);var i=new BABYLON.Vector3(this.x,this.y,this.z);this.actor.explodeSound.setPosition(i),this.actor.explodeSound.play(),this.actor.remove()}else{var t=this;Object.keys(players).forEach(function(e){var i=players[e];if(i){var r=t.x-i.x,n=t.y-(i.y+.3),a=t.z-i.z,o=Math.length3(r,n,a),d=Math.max(0,t.damage-25*o);if(i&&!i.isDead()&&d>0){for(var s=Math.normalize3({x:r,y:n,z:a},.25),y=i.x,l=i.y+.3,x=i.z,z=!0,h=0;h<o;h+=.25){if(collidesWithCell(y,l,x)){z=!1;break}y+=s.x,l-=s.y,x+=s.z}z&&hitPlayer(i,t.player,d,-r,-a)}}})}else{var r=this.dx,n=this.dy,a=this.dz;this.dy-=.003*e;var o=.5*(this.dx+r)*e,d=.5*(this.dy+n)*e,s=.5*(this.dz+a)*e;this.dx*=Math.pow(.99,e),this.dz*=Math.pow(.99,e),this.x+=o,this.collidesWithMap()&&(this.x-=o,this.dx*=-Math.pow(.5,e),this.dy*=Math.pow(.8,e),this.dz*=Math.pow(.8,e)),this.y+=d,this.collidesWithMap()&&(this.y-=d,this.dx*=Math.pow(.8,e),this.dy*=-Math.pow(.5,e),this.dz*=Math.pow(.8,e)),this.z+=s,this.collidesWithMap()&&(this.z-=s,this.dx*=Math.pow(.8,e),this.dy*=Math.pow(.8,e),this.dz*=-Math.pow(.5,e)),this.ttl-=e,this.actor&&this.actor.update()}},Grenade.prototype.throw=function(e,i,t){this.player=e,this.x=i.x,this.y=i.y,this.z=i.z,this.dx=t.x,this.dy=t.y,this.dz=t.z,this.ttl=150,this.damage=120,this.active=!0,this.actor&&this.actor.throw()},Grenade.prototype.collidesWithMap=function(){return!!collidesWithCell(this.x,this.y-.07,this.z)&&(this.actor&&this.actor.bounce(),!0)},Gun.prototype.update=function(e){this.actor&&(this.actor.update(e),this.triggerPulled&&this.queueShot()),this.shotsQueued>0&&0==this.equipCountdown&&(this.actor?(this.fire(),this.shotsQueued=0):0==this.rofCountdown&&(this.fire(),this.rofCountdown=.8*this.rof,this.shotsQueued--)),this.rofCountdown>0&&(this.rofCountdown=Math.max(0,this.rofCountdown-e)),this.actor||(this.equipCountdown>0&&(this.equipCountdown=Math.max(0,this.equipCountdown-e)),this.reloadCountdown>0&&(this.reloadCountdown-=e,this.reloadCountdown<=0&&(this.reloadCountdown=0,this.reload()))),this.reloadCountdown>0&&(this.player.shotSpread=this.shotSpreadIncrement)},Gun.prototype.collectAmmo=function(){return this.ammo.store<this.ammo.storeMax&&(this.ammo.store=Math.min(this.ammo.storeMax,this.ammo.store+this.ammo.pickup),!0)},Gun.prototype.queueShot=function(){if(this.ammo.rounds>0){if(this.player.isAtReady())if(this.actor){if(0==this.rofCountdown){this.shotsQueued++,this.rofCountdown=this.rof;var e=new Comm.output(6);e.packInt8(Comm.fire),e.packRad(this.player.pitch),e.packRadU(this.player.viewYaw),ws.send(e.buffer),0==this.automatic&&(this.triggerPulled=!1)}}else this.shotsQueued++}else this.actor&&this.actor.dryFire(),this.triggerPulled=!1},Gun.prototype.fire=function(){if(this.ammo.rounds--,this.actor)this.actor.fire(),this.player.actor.fire(),this.player.id==meId&&updateAmmoUi();else{var e=BABYLON.Matrix.RotationYawPitchRoll(this.player.viewYaw,this.player.pitch,0),i=BABYLON.Matrix.Translation(0,0,1).multiply(e),t=.002*(this.player.shotSpread+this.player.weapon.accuracy),r=BABYLON.Matrix.RotationYawPitchRoll((Math.random()-.5)*t,(Math.random()-.5)*t,(Math.random()-.5)*t),n=(i=i.multiply(r)).getTranslation(),a=BABYLON.Matrix.Translation(.1,.1,.4),o=(a=(a=a.multiply(e)).add(BABYLON.Matrix.Translation(this.player.x,this.player.y+.3,this.player.z))).getTranslation();this.fireMunitions(o,n)}this.player.shotSpread+=this.shotSpreadIncrement,0==this.ammo.rounds&&(this.actor&&Sounds.hammerClick.play(),this.triggerPulled=!1)},Gun.prototype.startReload=function(){return 0!=this.ammo.store&&0!=this.player.isAtReady()&&!this.triggerPulled&&(this.ammo.rounds!=this.ammo.capacity&&(0==this.ammo.rounds?this.reloadCountdown=this.longReloadTime:this.reloadCountdown=this.shortReloadTime,this.actor&&this.actor.reload(),!0))},Gun.prototype.reload=function(){var e=Math.min(Math.min(this.ammo.capacity,this.ammo.reload)-this.ammo.rounds,this.ammo.store);if(this.ammo.rounds+=e,this.ammo.store-=e,this.actor)this.reloadCountdown=0,this.player.id==meId&&updateAmmoUi();else{var i=new Comm.output(1);i.packInt8(Comm.reload),send(i.buffer,this.player.id)}},Gun.prototype.equip=function(){this.equipCountdown=this.equipTime,this.shotsQueued=0,this.triggerPulled=!1,this.player.shotSpread+=this.shotSpreadIncrement,this.actor&&this.actor.equip()},Gun.prototype.stow=function(){return 0!=this.player.isAtReady()&&!this.triggerPulled&&(this.player.stowWeaponCountdown=this.stowWeaponTime,this.actor&&this.actor.stow(),!0)},Gun.prototype.isAtReady=function(){return 0==this.shotsQueued&&0==this.reloadCountdown&&0==this.equipCountdown&&0==this.player.stowWeaponCountdown},Eggk47.prototype=Object.create(Gun.prototype),Eggk47.prototype.constructor=Gun,Eggk47.prototype.fireMunitions=function(e,i){munitionsManager.fireBullet(this.player,e,i,this.damage,this.ttl,this.velocity);var t=new Comm.output(14);t.packInt8(Comm.fireBullet),t.packInt8(this.player.id),t.packFloat(e.x),t.packFloat(e.y),t.packFloat(e.z),t.packFloat(i.x),t.packFloat(i.y),t.packFloat(i.z),sendToAll(t.buffer)},DozenGauge.prototype=Object.create(Gun.prototype),DozenGauge.prototype.constructor=Gun,DozenGauge.prototype.fireMunitions=function(e,i){var t=Date.now()%256;Math.seed=t;for(var r=0;r<20;r++){var n=Math.normalize3({x:i.x+Math.seededRandom(-.15,.15),y:i.y+Math.seededRandom(-.1,.1),z:i.z+Math.seededRandom(-.15,.15)});munitionsManager.fireBullet(this.player,e,n,this.damage,this.ttl,this.velocity)}var a=new Comm.output(15);a.packInt8(Comm.fireShot),a.packInt8(this.player.id),a.packFloat(e.x),a.packFloat(e.y),a.packFloat(e.z),a.packFloat(i.x),a.packFloat(i.y),a.packFloat(i.z),a.packInt8(t),sendToAll(a.buffer)},CSG1.prototype=Object.create(Gun.prototype),CSG1.prototype.constructor=Gun,CSG1.prototype.fireMunitions=function(e,i){munitionsManager.fireBullet(this.player,e,i,this.damage,this.ttl,this.velocity);var t=new Comm.output(14);t.packInt8(Comm.fireBullet),t.packInt8(this.player.id),t.packFloat(e.x),t.packFloat(e.y),t.packFloat(e.z),t.packFloat(i.x),t.packFloat(i.y),t.packFloat(i.z),sendToAll(t.buffer)},Cluck9mm.prototype=Object.create(Gun.prototype),Cluck9mm.prototype.constructor=Gun,Cluck9mm.prototype.fireMunitions=function(e,i){munitionsManager.fireBullet(this.player,e,i,this.damage,this.ttl,this.velocity);var t=new Comm.output(14);t.packInt8(Comm.fireBullet),t.packInt8(this.player.id),t.packFloat(e.x),t.packFloat(e.y),t.packFloat(e.z),t.packFloat(i.x),t.packFloat(i.y),t.packFloat(i.z),sendToAll(t.buffer)},Math.PI2=2*Math.PI,Math.PI90=Math.PI/2,Math.mod=function(e,i){var t=e%i;return t>=0?t:t+i},Math.length2=function(e,i){return Math.sqrt(Math.pow(e,2)+Math.pow(i,2))},Math.length3=function(e,i,t){return Math.sqrt(Math.pow(e,2)+Math.pow(i,2)+Math.pow(t,2))},Math.normalize3=function(e,i){i=i||1;var t=Math.length3(e.x,e.y,e.z);return e.x*=i/t,e.y*=i/t,e.z*=i/t,e},Math.clamp=function(e,i,t){return Math.max(Math.min(e,t),i)},Math.radAdd=function(e,i){return Math.mod(e+i,Math.PI2)},Math.radSub=function(e,i){return Math.mod(e-i,Math.PI2)},Math.radRange=function(e){return Math.mod(e,Math.PI2)},Math.radDifference=function(e,i){var t=(e-i+Math.PI)%Math.PI2-Math.PI;return t=t<-Math.PI?t+Math.PI2:t},Math.cardVals=[0,Math.PI90,Math.PI,3*Math.PI90],Math.cardToRad=function(e){return Math.cardVals[e]},Math.randomInt=function(e,i){return Math.floor(Math.random()*(i-e)+e)},Math.seed=100,Math.seededRandom=function(e,i){return e=e||0,i=i||1,Math.seed=(9301*Math.seed+49297)%233280,e+Math.seed/233280*(i-e)},Math.seededRandomInt=function(e,i){return Math.floor(Math.seededRandom(e,i))};var minMaps=[{data:{1:{0:[{x:0,y:0,z:0,dir:2},{x:0,y:0,z:1,dir:3},{x:0,y:0,z:2,dir:0},{x:0,y:0,z:3,dir:1},{x:0,y:0,z:4,dir:2},{x:0,y:0,z:5,dir:0},{x:0,y:0,z:6,dir:2},{x:0,y:0,z:7,dir:0},{x:0,y:0,z:8,dir:1},{x:0,y:0,z:9,dir:1},{x:0,y:0,z:10,dir:1},{x:0,y:0,z:11,dir:0},{x:0,y:0,z:12,dir:1},{x:0,y:0,z:13,dir:3},{x:0,y:0,z:14,dir:0},{x:0,y:0,z:15,dir:3},{x:0,y:0,z:16,dir:3},{x:0,y:0,z:17,dir:1},{x:0,y:0,z:18,dir:1},{x:0,y:0,z:19,dir:0},{x:1,y:0,z:0,dir:3},{x:1,y:0,z:1,dir:0},{x:1,y:0,z:2,dir:3},{x:1,y:0,z:3,dir:1},{x:1,y:0,z:4,dir:3},{x:1,y:0,z:5,dir:2},{x:1,y:0,z:6,dir:3},{x:1,y:0,z:7,dir:3},{x:1,y:0,z:8,dir:3},{x:1,y:0,z:9,dir:1},{x:1,y:0,z:10,dir:1},{x:1,y:0,z:11,dir:2},{x:1,y:0,z:12,dir:2},{x:1,y:0,z:13,dir:3},{x:1,y:0,z:14,dir:3},{x:1,y:0,z:15,dir:2},{x:1,y:0,z:16,dir:3},{x:1,y:0,z:17,dir:1},{x:1,y:0,z:18,dir:1},{x:1,y:0,z:19,dir:3},{x:2,y:0,z:0,dir:0},{x:2,y:0,z:1,dir:2},{x:2,y:0,z:6,dir:1},{x:2,y:0,z:15,dir:2},{x:2,y:0,z:16,dir:2},{x:2,y:0,z:17,dir:2},{x:2,y:0,z:18,dir:1},{x:2,y:0,z:19,dir:3},{x:3,y:0,z:0,dir:1},{x:3,y:0,z:1,dir:3},{x:3,y:0,z:6,dir:0},{x:3,y:0,z:18,dir:1},{x:3,y:0,z:19,dir:0},{x:4,y:0,z:0,dir:0},{x:4,y:0,z:1,dir:2},{x:4,y:0,z:5,dir:0},{x:4,y:0,z:6,dir:2},{x:4,y:0,z:12,dir:1},{x:4,y:0,z:16,dir:1},{x:4,y:0,z:18,dir:1},{x:4,y:0,z:19,dir:2},{x:5,y:0,z:0,dir:1},{x:5,y:0,z:1,dir:3},{x:5,y:0,z:18,dir:1},{x:5,y:0,z:19,dir:2},{x:6,y:0,z:0,dir:0},{x:6,y:0,z:18,dir:2},{x:6,y:0,z:19,dir:3},{x:7,y:0,z:0,dir:0},{x:7,y:0,z:18,dir:0},{x:7,y:0,z:19,dir:0},{x:8,y:0,z:0,dir:2},{x:8,y:0,z:18,dir:2},{x:8,y:0,z:19,dir:3},{x:9,y:0,z:0,dir:0},{x:9,y:0,z:1,dir:2},{x:9,y:0,z:9,dir:3},{x:9,y:0,z:18,dir:3},{x:9,y:0,z:19,dir:0},{x:10,y:0,z:0,dir:0},{x:10,y:0,z:1,dir:2},{x:10,y:0,z:8,dir:3},{x:10,y:0,z:18,dir:3},{x:10,y:0,z:19,dir:1},{x:11,y:0,z:0,dir:1},{x:11,y:0,z:1,dir:2},{x:11,y:0,z:10,dir:0},{x:11,y:0,z:18,dir:2},{x:11,y:0,z:19,dir:3},{x:12,y:0,z:0,dir:2},{x:12,y:0,z:1,dir:0},{x:12,y:0,z:15,dir:3},{x:12,y:0,z:16,dir:2},{x:12,y:0,z:17,dir:0},{x:12,y:0,z:18,dir:3},{x:12,y:0,z:19,dir:2},{x:13,y:0,z:0,dir:2},{x:13,y:0,z:1,dir:3},{x:13,y:0,z:15,dir:1},{x:13,y:0,z:16,dir:0},{x:13,y:0,z:17,dir:0},{x:13,y:0,z:18,dir:0},{x:13,y:0,z:19,dir:0},{x:14,y:0,z:0,dir:3},{x:14,y:0,z:1,dir:3},{x:14,y:0,z:18,dir:1},{x:14,y:0,z:19,dir:0},{x:15,y:0,z:0,dir:1},{x:15,y:0,z:1,dir:0},{x:15,y:0,z:2,dir:2},{x:15,y:0,z:3,dir:3},{x:15,y:0,z:18,dir:3},{x:15,y:0,z:19,dir:3},{x:16,y:0,z:0,dir:3},{x:16,y:0,z:1,dir:2},{x:16,y:0,z:2,dir:1},{x:16,y:0,z:3,dir:3},{x:16,y:0,z:13,dir:1},{x:16,y:0,z:18,dir:0},{x:16,y:0,z:19,dir:1},{x:17,y:0,z:0,dir:3},{x:17,y:0,z:1,dir:2},{x:17,y:0,z:2,dir:0},{x:17,y:0,z:3,dir:1},{x:17,y:0,z:18,dir:0},{x:17,y:0,z:19,dir:1},{x:18,y:0,z:0,dir:0},{x:18,y:0,z:1,dir:0},{x:18,y:0,z:2,dir:1},{x:18,y:0,z:3,dir:1},{x:18,y:0,z:4,dir:0},{x:18,y:0,z:5,dir:1},{x:18,y:0,z:6,dir:3},{x:18,y:0,z:7,dir:1},{x:18,y:0,z:13,dir:0},{x:18,y:0,z:14,dir:0},{x:18,y:0,z:15,dir:2},{x:18,y:0,z:16,dir:1},{x:18,y:0,z:17,dir:0},{x:18,y:0,z:18,dir:0},{x:18,y:0,z:19,dir:2},{x:19,y:0,z:0,dir:0},{x:19,y:0,z:1,dir:1},{x:19,y:0,z:2,dir:2},{x:19,y:0,z:3,dir:2},{x:19,y:0,z:4,dir:2},{x:19,y:0,z:5,dir:1},{x:19,y:0,z:6,dir:2},{x:19,y:0,z:7,dir:3},{x:19,y:0,z:8,dir:2},{x:19,y:0,z:9,dir:0},{x:19,y:0,z:10,dir:2},{x:19,y:0,z:11,dir:1},{x:19,y:0,z:12,dir:3},{x:19,y:0,z:13,dir:2},{x:19,y:0,z:14,dir:2},{x:19,y:0,z:15,dir:3},{x:19,y:0,z:16,dir:0},{x:19,y:0,z:17,dir:1},{x:19,y:0,z:18,dir:0},{x:19,y:0,z:19,dir:2}],1:[{x:2,y:0,z:8,dir:0},{x:2,y:0,z:11,dir:2},{x:2,y:0,z:12,dir:1},{x:2,y:0,z:13,dir:1},{x:3,y:0,z:8,dir:3},{x:3,y:0,z:11,dir:0},{x:3,y:0,z:12,dir:2},{x:3,y:0,z:13,dir:3},{x:4,y:0,z:8,dir:1},{x:4,y:0,z:9,dir:2},{x:4,y:0,z:10,dir:3},{x:4,y:0,z:11,dir:3},{x:4,y:0,z:13,dir:3},{x:4,y:0,z:14,dir:0},{x:4,y:0,z:15,dir:0},{x:5,y:0,z:8,dir:0},{x:5,y:0,z:9,dir:1},{x:5,y:0,z:10,dir:3},{x:5,y:0,z:11,dir:2},{x:5,y:0,z:13,dir:0},{x:6,y:0,z:1,dir:0},{x:6,y:0,z:2,dir:1},{x:6,y:0,z:3,dir:0},{x:6,y:0,z:4,dir:2},{x:6,y:0,z:5,dir:0},{x:6,y:0,z:6,dir:0},{x:6,y:0,z:7,dir:1},{x:6,y:0,z:8,dir:3},{x:6,y:0,z:9,dir:2},{x:6,y:0,z:10,dir:2},{x:6,y:0,z:11,dir:1},{x:6,y:0,z:13,dir:1},{x:6,y:0,z:15,dir:0},{x:6,y:0,z:16,dir:0},{x:7,y:0,z:1,dir:3},{x:7,y:0,z:2,dir:1},{x:7,y:0,z:3,dir:3},{x:7,y:0,z:4,dir:3},{x:7,y:0,z:5,dir:1},{x:7,y:0,z:6,dir:1},{x:7,y:0,z:7,dir:2},{x:7,y:0,z:8,dir:3},{x:7,y:0,z:9,dir:2},{x:7,y:0,z:10,dir:3},{x:7,y:0,z:11,dir:0},{x:7,y:0,z:12,dir:0},{x:7,y:0,z:13,dir:1},{x:7,y:0,z:14,dir:3},{x:7,y:0,z:15,dir:3},{x:7,y:0,z:16,dir:2},{x:8,y:0,z:1,dir:3},{x:8,y:0,z:2,dir:0},{x:8,y:0,z:3,dir:1},{x:8,y:0,z:4,dir:0},{x:8,y:0,z:8,dir:0},{x:8,y:0,z:9,dir:3},{x:8,y:0,z:10,dir:2},{x:8,y:0,z:11,dir:2},{x:8,y:0,z:13,dir:2},{x:8,y:0,z:15,dir:0},{x:8,y:0,z:16,dir:0},{x:9,y:0,z:3,dir:0},{x:9,y:0,z:4,dir:0},{x:9,y:0,z:11,dir:0},{x:9,y:0,z:13,dir:1},{x:9,y:0,z:14,dir:3},{x:9,y:0,z:15,dir:0},{x:9,y:0,z:16,dir:0},{x:10,y:0,z:3,dir:3},{x:10,y:0,z:4,dir:0},{x:10,y:0,z:9,dir:1},{x:10,y:0,z:10,dir:0},{x:10,y:0,z:11,dir:1},{x:10,y:0,z:12,dir:1},{x:10,y:0,z:13,dir:1},{x:10,y:0,z:14,dir:2},{x:10,y:0,z:15,dir:2},{x:10,y:0,z:16,dir:2},{x:11,y:0,z:2,dir:1},{x:11,y:0,z:3,dir:3},{x:11,y:0,z:4,dir:3},{x:11,y:0,z:5,dir:0},{x:12,y:0,z:2,dir:3},{x:12,y:0,z:3,dir:1},{x:12,y:0,z:4,dir:1},{x:12,y:0,z:5,dir:2},{x:12,y:0,z:6,dir:1},{x:13,y:0,z:2,dir:2},{x:13,y:0,z:3,dir:1},{x:13,y:0,z:4,dir:3},{x:13,y:0,z:5,dir:3},{x:13,y:0,z:6,dir:2},{x:13,y:0,z:7,dir:2},{x:14,y:0,z:5,dir:2},{x:14,y:0,z:6,dir:3},{x:14,y:0,z:7,dir:3},{x:14,y:0,z:9,dir:0},{x:14,y:0,z:10,dir:1},{x:14,y:0,z:11,dir:2},{x:14,y:0,z:12,dir:0},{x:14,y:0,z:13,dir:0},{x:14,y:0,z:14,dir:3},{x:14,y:0,z:15,dir:1},{x:14,y:0,z:16,dir:2},{x:15,y:0,z:4,dir:0},{x:15,y:0,z:5,dir:1},{x:15,y:0,z:6,dir:1},{x:15,y:0,z:7,dir:2},{x:15,y:0,z:8,dir:3},{x:15,y:0,z:9,dir:3},{x:15,y:0,z:10,dir:3},{x:15,y:0,z:11,dir:0},{x:15,y:0,z:15,dir:2},{x:15,y:0,z:16,dir:0},{x:16,y:0,z:4,dir:1},{x:16,y:0,z:5,dir:2},{x:16,y:0,z:6,dir:0},{x:16,y:0,z:7,dir:3},{x:16,y:0,z:9,dir:0},{x:16,y:0,z:10,dir:0},{x:16,y:0,z:11,dir:3},{x:16,y:0,z:14,dir:3},{x:16,y:0,z:15,dir:3},{x:16,y:0,z:16,dir:3},{x:16,y:0,z:17,dir:2},{x:17,y:0,z:6,dir:2},{x:17,y:0,z:7,dir:1},{x:17,y:0,z:9,dir:0},{x:17,y:0,z:10,dir:1},{x:17,y:0,z:11,dir:0},{x:17,y:0,z:15,dir:3},{x:17,y:0,z:16,dir:2},{x:18,y:0,z:9,dir:1},{x:18,y:0,z:10,dir:1},{x:18,y:0,z:11,dir:1}]},2:{1:[{x:4,y:3,z:11,dir:3},{x:4,y:3,z:13,dir:1},{x:5,y:3,z:11,dir:2},{x:5,y:3,z:13,dir:2},{x:6,y:3,z:11,dir:1},{x:6,y:3,z:13,dir:3},{x:7,y:3,z:2,dir:1},{x:7,y:3,z:3,dir:2},{x:8,y:3,z:2,dir:0},{x:8,y:3,z:3,dir:3},{x:15,y:3,z:6,dir:0},{x:15,y:3,z:7,dir:3},{x:15,y:3,z:8,dir:0},{x:18,y:1,z:1,dir:3}],5:[{x:0,y:1,z:2,dir:3},{x:0,y:1,z:3,dir:1},{x:0,y:1,z:4,dir:1},{x:0,y:1,z:5,dir:3},{x:1,y:1,z:2,dir:3},{x:1,y:1,z:3,dir:3},{x:1,y:1,z:4,dir:3},{x:1,y:1,z:5,dir:3},{x:2,y:1,z:2,dir:1},{x:2,y:1,z:5,dir:2},{x:2,y:1,z:7,dir:0},{x:2,y:1,z:9,dir:3},{x:2,y:1,z:10,dir:0},{x:2,y:1,z:11,dir:3},{x:2,y:1,z:13,dir:3},{x:2,y:1,z:14,dir:3},{x:2,y:2,z:3,dir:3},{x:2,y:2,z:4,dir:3},{x:2,y:2,z:7,dir:0},{x:2,y:2,z:8,dir:0},{x:2,y:2,z:9,dir:3},{x:2,y:2,z:10,dir:3},{x:2,y:2,z:11,dir:2},{x:2,y:2,z:13,dir:0},{x:2,y:2,z:14,dir:1},{x:3,y:1,z:2,dir:1},{x:3,y:1,z:3,dir:3},{x:3,y:1,z:4,dir:3},{x:3,y:1,z:5,dir:3},{x:3,y:1,z:7,dir:2},{x:3,y:1,z:9,dir:1},{x:3,y:1,z:10,dir:3},{x:3,y:1,z:14,dir:2},{x:3,y:1,z:15,dir:0},{x:3,y:1,z:16,dir:2},{x:3,y:1,z:17,dir:2},{x:3,y:2,z:7,dir:0},{x:3,y:2,z:8,dir:2},{x:3,y:2,z:9,dir:2},{x:3,y:2,z:10,dir:2},{x:3,y:2,z:11,dir:0},{x:3,y:2,z:13,dir:3},{x:3,y:2,z:14,dir:3},{x:4,y:1,z:2,dir:1},{x:4,y:1,z:4,dir:0},{x:4,y:1,z:7,dir:1},{x:4,y:1,z:17,dir:0},{x:4,y:2,z:3,dir:1},{x:4,y:2,z:7,dir:0},{x:4,y:2,z:8,dir:3},{x:4,y:2,z:9,dir:2},{x:4,y:2,z:10,dir:0},{x:4,y:2,z:11,dir:3},{x:4,y:2,z:13,dir:3},{x:4,y:2,z:14,dir:3},{x:5,y:1,z:0,dir:0},{x:5,y:1,z:1,dir:1},{x:5,y:1,z:2,dir:2},{x:5,y:1,z:3,dir:2},{x:5,y:1,z:4,dir:0},{x:5,y:1,z:5,dir:1},{x:5,y:1,z:6,dir:1},{x:5,y:1,z:7,dir:1},{x:5,y:1,z:12,dir:0},{x:5,y:1,z:14,dir:1},{x:5,y:1,z:15,dir:0},{x:5,y:1,z:16,dir:0},{x:5,y:1,z:17,dir:0},{x:5,y:2,z:0,dir:1},{x:5,y:2,z:1,dir:1},{x:5,y:2,z:2,dir:1},{x:5,y:2,z:3,dir:0},{x:5,y:2,z:4,dir:3},{x:5,y:2,z:5,dir:0},{x:5,y:2,z:6,dir:0},{x:5,y:2,z:7,dir:0},{x:5,y:2,z:8,dir:0},{x:5,y:2,z:9,dir:0},{x:5,y:2,z:10,dir:1},{x:5,y:2,z:11,dir:1},{x:5,y:2,z:13,dir:3},{x:5,y:2,z:14,dir:2},{x:5,y:3,z:6,dir:2},{x:5,y:3,z:7,dir:2},{x:5,y:3,z:8,dir:2},{x:5,y:4,z:6,dir:2},{x:5,y:4,z:7,dir:2},{x:5,y:4,z:8,dir:2},{x:6,y:1,z:0,dir:3},{x:6,y:1,z:12,dir:1},{x:6,y:1,z:14,dir:1},{x:6,y:1,z:17,dir:2},{x:6,y:2,z:0,dir:1},{x:6,y:2,z:1,dir:3},{x:6,y:2,z:2,dir:2},{x:6,y:2,z:3,dir:1},{x:6,y:2,z:4,dir:2},{x:6,y:2,z:5,dir:1},{x:6,y:2,z:6,dir:2},{x:6,y:2,z:8,dir:2},{x:6,y:2,z:9,dir:3},{x:6,y:2,z:10,dir:0},{x:6,y:2,z:11,dir:2},{x:6,y:2,z:12,dir:3},{x:6,y:2,z:13,dir:2},{x:6,y:2,z:14,dir:1},{x:6,y:3,z:6,dir:2},{x:6,y:3,z:8,dir:2},{x:6,y:4,z:6,dir:2},{x:6,y:4,z:8,dir:2},{x:7,y:1,z:0,dir:1},{x:7,y:1,z:7,dir:3},{x:7,y:1,z:17,dir:0},{x:7,y:2,z:0,dir:0},{x:7,y:2,z:1,dir:1},{x:7,y:2,z:2,dir:0},{x:7,y:2,z:3,dir:3},{x:7,y:2,z:4,dir:0},{x:7,y:2,z:5,dir:0},{x:7,y:2,z:6,dir:1},{x:7,y:2,z:7,dir:0},{x:7,y:2,z:8,dir:2},{x:7,y:2,z:9,dir:1},{x:7,y:2,z:10,dir:0},{x:7,y:2,z:11,dir:1},{x:7,y:2,z:12,dir:1},{x:7,y:2,z:13,dir:3},{x:7,y:2,z:14,dir:0},{x:7,y:3,z:6,dir:2},{x:7,y:3,z:7,dir:2},{x:7,y:3,z:8,dir:2},{x:7,y:4,z:6,dir:2},{x:7,y:4,z:7,dir:2},{x:7,y:4,z:8,dir:2},{x:8,y:1,z:0,dir:1},{x:8,y:1,z:5,dir:0},{x:8,y:1,z:6,dir:2},{x:8,y:1,z:7,dir:3},{x:8,y:1,z:12,dir:1},{x:8,y:1,z:14,dir:1},{x:8,y:1,z:17,dir:1},{x:8,y:2,z:0,dir:2},{x:8,y:2,z:1,dir:1},{x:8,y:2,z:2,dir:1},{x:8,y:2,z:3,dir:2},{x:8,y:2,z:4,dir:3},{x:8,y:2,z:5,dir:1},{x:8,y:2,z:6,dir:0},{x:8,y:2,z:7,dir:3},{x:8,y:2,z:8,dir:1},{x:8,y:2,z:9,dir:0},{x:8,y:2,z:10,dir:3},{x:8,y:2,z:11,dir:0},{x:8,y:2,z:12,dir:3},{x:8,y:2,z:13,dir:2},{x:8,y:2,z:14,dir:1},{x:9,y:1,z:0,dir:1},{x:9,y:1,z:1,dir:0},{x:9,y:1,z:2,dir:0},{x:9,y:1,z:5,dir:0},{x:9,y:1,z:8,dir:2},{x:9,y:1,z:9,dir:0},{x:9,y:1,z:10,dir:3},{x:9,y:1,z:12,dir:0},{x:9,y:1,z:17,dir:1},{x:9,y:2,z:0,dir:2},{x:9,y:2,z:1,dir:1},{x:9,y:2,z:2,dir:3},{x:9,y:2,z:3,dir:2},{x:9,y:2,z:4,dir:1},{x:9,y:2,z:5,dir:3},{x:9,y:2,z:6,dir:1},{x:9,y:2,z:7,dir:3},{x:9,y:2,z:8,dir:3},{x:9,y:2,z:9,dir:0},{x:9,y:2,z:10,dir:0},{x:9,y:2,z:11,dir:2},{x:9,y:2,z:12,dir:3},{x:10,y:1,z:0,dir:0},{x:10,y:1,z:1,dir:0},{x:10,y:1,z:2,dir:0},{x:10,y:1,z:5,dir:0},{x:10,y:1,z:7,dir:2},{x:10,y:1,z:17,dir:3},{x:10,y:2,z:0,dir:2},{x:10,y:2,z:1,dir:3},{x:10,y:2,z:2,dir:3},{x:10,y:2,z:3,dir:2},{x:10,y:2,z:4,dir:3},{x:10,y:2,z:5,dir:2},{x:10,y:2,z:6,dir:1},{x:10,y:2,z:11,dir:3},{x:10,y:2,z:12,dir:2},{x:11,y:1,z:0,dir:0},{x:11,y:1,z:1,dir:2},{x:11,y:1,z:6,dir:3},{x:11,y:1,z:8,dir:2},{x:11,y:1,z:9,dir:2},{x:11,y:1,z:11,dir:2},{x:11,y:1,z:12,dir:0},{x:11,y:1,z:13,dir:0},{x:11,y:1,z:14,dir:1},{x:11,y:1,z:15,dir:2},{x:11,y:1,z:16,dir:1},{x:11,y:1,z:17,dir:2},{x:11,y:2,z:0,dir:0},{x:11,y:2,z:7,dir:0},{x:11,y:2,z:8,dir:2},{x:11,y:2,z:9,dir:1},{x:11,y:2,z:11,dir:3},{x:11,y:2,z:12,dir:1},{x:12,y:1,z:1,dir:1},{x:12,y:1,z:6,dir:0},{x:12,y:1,z:7,dir:1},{x:12,y:1,z:10,dir:0},{x:12,y:1,z:13,dir:1},{x:12,y:1,z:14,dir:1},{x:12,y:2,z:7,dir:2},{x:12,y:2,z:8,dir:2},{x:12,y:2,z:9,dir:0},{x:12,y:2,z:11,dir:1},{x:12,y:2,z:12,dir:0},{x:13,y:1,z:1,dir:2},{x:13,y:1,z:4,dir:0},{x:13,y:1,z:8,dir:1},{x:13,y:1,z:9,dir:0},{x:13,y:1,z:10,dir:3},{x:13,y:1,z:11,dir:1},{x:13,y:1,z:12,dir:0},{x:13,y:1,z:13,dir:1},{x:13,y:1,z:14,dir:1},{x:13,y:2,z:4,dir:0},{x:13,y:2,z:5,dir:2},{x:13,y:2,z:6,dir:3},{x:13,y:2,z:7,dir:2},{x:13,y:2,z:8,dir:2},{x:13,y:2,z:9,dir:0},{x:13,y:2,z:10,dir:2},{x:13,y:2,z:11,dir:1},{x:13,y:2,z:12,dir:2},{x:14,y:1,z:1,dir:3},{x:14,y:1,z:2,dir:0},{x:14,y:1,z:3,dir:1},{x:14,y:1,z:4,dir:2},{x:14,y:1,z:8,dir:0},{x:14,y:1,z:12,dir:0},{x:14,y:1,z:14,dir:1},{x:14,y:1,z:17,dir:2},{x:14,y:2,z:4,dir:1},{x:14,y:2,z:5,dir:3},{x:14,y:2,z:6,dir:0},{x:14,y:2,z:7,dir:2},{x:14,y:2,z:8,dir:0},{x:14,y:2,z:9,dir:1},{x:14,y:2,z:10,dir:3},{x:14,y:2,z:11,dir:1},{x:14,y:2,z:12,dir:0},{x:14,y:2,z:13,dir:2},{x:14,y:2,z:14,dir:1},{x:14,y:2,z:15,dir:0},{x:14,y:2,z:16,dir:2},{x:15,y:1,z:12,dir:1},{x:15,y:1,z:13,dir:1},{x:15,y:1,z:14,dir:1},{x:15,y:1,z:17,dir:1},{x:15,y:2,z:4,dir:3},{x:15,y:2,z:5,dir:2},{x:15,y:2,z:6,dir:2},{x:15,y:2,z:7,dir:3},{x:15,y:2,z:8,dir:2},{x:15,y:2,z:9,dir:3},{x:15,y:2,z:10,dir:1},{x:15,y:2,z:11,dir:0},{x:15,y:2,z:12,dir:0},{x:15,y:2,z:13,dir:1},{x:15,y:2,z:14,dir:2},{x:15,y:2,z:15,dir:1},{x:15,y:2,z:16,dir:0},{x:15,y:2,z:17,dir:1},{x:16,y:1,z:4,dir:2},{x:16,y:1,z:8,dir:2},{x:16,y:1,z:12,dir:0},{x:16,y:2,z:4,dir:3},{x:16,y:2,z:5,dir:1},{x:16,y:2,z:6,dir:0},{x:16,y:2,z:7,dir:1},{x:16,y:2,z:8,dir:0},{x:16,y:2,z:9,dir:2},{x:16,y:2,z:10,dir:2},{x:16,y:2,z:11,dir:2},{x:16,y:2,z:15,dir:0},{x:16,y:2,z:16,dir:3},{x:16,y:2,z:17,dir:3},{x:17,y:1,z:4,dir:3},{x:17,y:1,z:5,dir:0},{x:17,y:1,z:7,dir:3},{x:17,y:1,z:8,dir:1},{x:17,y:1,z:12,dir:0},{x:17,y:1,z:13,dir:1},{x:17,y:1,z:14,dir:3},{x:17,y:1,z:16,dir:0},{x:17,y:1,z:17,dir:1},{x:17,y:2,z:4,dir:3},{x:17,y:2,z:5,dir:2},{x:17,y:2,z:6,dir:1},{x:17,y:2,z:7,dir:0},{x:17,y:2,z:8,dir:1},{x:17,y:2,z:9,dir:0},{x:17,y:2,z:10,dir:3},{x:17,y:2,z:11,dir:2},{x:17,y:2,z:12,dir:1},{x:17,y:2,z:13,dir:2},{x:17,y:2,z:14,dir:0},{x:17,y:2,z:15,dir:0},{x:17,y:2,z:16,dir:0},{x:17,y:2,z:17,dir:2},{x:18,y:1,z:8,dir:0},{x:18,y:1,z:12,dir:0}]},4:{0:[{x:1,y:1,z:16,dir:1},{x:1,y:1,z:18,dir:0},{x:1,y:2,z:3,dir:2},{x:5,y:3,z:10,dir:1},{x:5,y:3,z:14,dir:1},{x:5,y:5,z:6,dir:2},{x:5,y:5,z:8,dir:2},{x:7,y:4,z:3,dir:2},{x:7,y:5,z:6,dir:2},{x:7,y:5,z:8,dir:2},{x:8,y:1,z:18,dir:1},{x:9,y:3,z:8,dir:2},{x:10,y:1,z:18,dir:1},{x:10,y:3,z:2,dir:1},{x:10,y:3,z:4,dir:1},{x:11,y:3,z:9,dir:2},{x:11,y:3,z:12,dir:1},{x:13,y:3,z:4,dir:2},{x:15,y:3,z:5,dir:2},{x:15,y:3,z:9,dir:2},{x:15,y:3,z:10,dir:2},{x:15,y:3,z:11,dir:2},{x:15,y:3,z:12,dir:2},{x:17,y:1,z:1,dir:3},{x:18,y:1,z:18,dir:3},{x:18,y:2,z:8,dir:2},{x:18,y:2,z:12,dir:2}]},5:{0:[{x:0,y:1,z:1,dir:0},{x:4,y:1,z:1,dir:0},{x:4,y:1,z:5,dir:2},{x:4,y:1,z:12,dir:1},{x:4,y:1,z:16,dir:0},{x:4,y:1,z:18,dir:2},{x:4,y:2,z:4,dir:2},{x:5,y:2,z:12,dir:1},{x:8,y:3,z:1,dir:0},{x:10,y:1,z:8,dir:2},{x:10,y:1,z:15,dir:1},{x:10,y:2,z:7,dir:2},{x:11,y:1,z:5,dir:0},{x:11,y:1,z:10,dir:1},{x:11,y:2,z:1,dir:3},{x:12,y:2,z:6,dir:1},{x:12,y:2,z:10,dir:1},{x:13,y:2,z:13,dir:2},{x:14,y:1,z:18,dir:2},{x:14,y:2,z:3,dir:0},{x:14,y:2,z:17,dir:2},{x:16,y:1,z:13,dir:2},{x:16,y:2,z:12,dir:2}]},6:{0:[{x:6,y:1,z:7,dir:1},{x:6,y:2,z:7,dir:1},{x:6,y:3,z:7,dir:1},{x:6,y:4,z:7,dir:1}]}},width:20,height:6,depth:20,name:"",surfaceArea:440},{data:{1:{1:[{x:2,y:0,z:3,dir:2},{x:2,y:0,z:4,dir:2},{x:2,y:0,z:8,dir:2},{x:2,y:0,z:9,dir:2},{x:3,y:0,z:8,dir:2},{x:3,y:0,z:9,dir:2},{x:5,y:0,z:14,dir:2},{x:6,y:0,z:14,dir:2},{x:7,y:0,z:14,dir:2},{x:8,y:0,z:14,dir:2},{x:9,y:0,z:14,dir:2},{x:10,y:0,z:14,dir:2},{x:11,y:0,z:14,dir:2},{x:12,y:0,z:14,dir:2},{x:16,y:0,z:14,dir:2},{x:17,y:0,z:14,dir:2},{x:18,y:0,z:14,dir:2},{x:19,y:0,z:1,dir:2},{x:19,y:0,z:2,dir:2},{x:19,y:0,z:3,dir:2},{x:19,y:0,z:4,dir:2},{x:19,y:0,z:14,dir:2},{x:20,y:0,z:1,dir:2},{x:20,y:0,z:2,dir:2},{x:20,y:0,z:3,dir:2},{x:20,y:0,z:4,dir:2},{x:20,y:0,z:14,dir:2},{x:21,y:0,z:1,dir:2},{x:21,y:0,z:2,dir:2},{x:21,y:0,z:3,dir:2},{x:21,y:0,z:4,dir:2},{x:21,y:0,z:14,dir:2},{x:22,y:0,z:1,dir:2},{x:22,y:0,z:2,dir:2},{x:22,y:0,z:3,dir:2},{x:22,y:0,z:4,dir:2},{x:22,y:0,z:14,dir:2},{x:23,y:0,z:1,dir:2},{x:23,y:0,z:2,dir:2},{x:23,y:0,z:3,dir:2},{x:23,y:0,z:4,dir:2},{x:23,y:0,z:14,dir:2}],2:[{x:0,y:0,z:0,dir:1},{x:0,y:0,z:1,dir:0},{x:0,y:0,z:2,dir:1},{x:0,y:0,z:3,dir:3},{x:0,y:0,z:4,dir:1},{x:0,y:0,z:5,dir:3},{x:0,y:0,z:6,dir:1},{x:0,y:0,z:7,dir:2},{x:0,y:0,z:8,dir:0},{x:0,y:0,z:9,dir:0},{x:0,y:0,z:10,dir:0},{x:0,y:0,z:11,dir:2},{x:0,y:0,z:12,dir:2},{x:0,y:0,z:13,dir:3},{x:0,y:0,z:14,dir:3},{x:0,y:0,z:15,dir:2},{x:1,y:0,z:0,dir:3},{x:1,y:0,z:1,dir:1},{x:1,y:0,z:2,dir:3},{x:1,y:0,z:3,dir:2},{x:1,y:0,z:4,dir:2},{x:1,y:0,z:5,dir:1},{x:1,y:0,z:6,dir:2},{x:1,y:0,z:7,dir:2},{x:1,y:0,z:8,dir:1},{x:1,y:0,z:9,dir:1},{x:1,y:0,z:10,dir:0},{x:1,y:0,z:11,dir:1},{x:1,y:0,z:12,dir:3},{x:1,y:0,z:13,dir:1},{x:1,y:0,z:14,dir:2},{x:1,y:0,z:15,dir:3},{x:2,y:0,z:0,dir:3},{x:2,y:0,z:1,dir:1},{x:2,y:0,z:2,dir:3},{x:2,y:0,z:5,dir:0},{x:2,y:0,z:6,dir:1},{x:2,y:0,z:7,dir:3},{x:2,y:0,z:10,dir:0},{x:2,y:0,z:11,dir:3},{x:2,y:0,z:12,dir:3},{x:2,y:0,z:13,dir:1},{x:2,y:0,z:14,dir:1},{x:2,y:0,z:15,dir:0},{x:3,y:0,z:0,dir:0},{x:3,y:0,z:1,dir:3},{x:3,y:0,z:2,dir:3},{x:3,y:0,z:3,dir:0},{x:3,y:0,z:4,dir:3},{x:3,y:0,z:5,dir:3},{x:3,y:0,z:6,dir:2},{x:3,y:0,z:7,dir:1},{x:3,y:0,z:10,dir:0},{x:3,y:0,z:11,dir:3},{x:3,y:0,z:12,dir:1},{x:3,y:0,z:13,dir:2},{x:3,y:0,z:14,dir:3},{x:3,y:0,z:15,dir:1},{x:4,y:0,z:0,dir:3},{x:4,y:0,z:1,dir:2},{x:4,y:0,z:2,dir:3},{x:4,y:0,z:3,dir:3},{x:4,y:0,z:4,dir:2},{x:4,y:0,z:5,dir:3},{x:4,y:0,z:6,dir:2},{x:4,y:0,z:7,dir:1},{x:4,y:0,z:8,dir:3},{x:4,y:0,z:9,dir:2},{x:4,y:0,z:10,dir:0},{x:4,y:0,z:11,dir:2},{x:4,y:0,z:12,dir:1},{x:4,y:0,z:13,dir:1},{x:4,y:0,z:14,dir:1},{x:4,y:0,z:15,dir:0},{x:5,y:0,z:0,dir:2},{x:5,y:0,z:1,dir:1},{x:5,y:0,z:2,dir:1},{x:5,y:0,z:3,dir:0},{x:5,y:0,z:4,dir:1},{x:5,y:0,z:5,dir:2},{x:5,y:0,z:6,dir:1},{x:5,y:0,z:7,dir:1},{x:5,y:0,z:8,dir:1},{x:5,y:0,z:9,dir:3},{x:5,y:0,z:10,dir:0},{x:5,y:0,z:11,dir:2},{x:5,y:0,z:12,dir:3},{x:5,y:0,z:13,dir:3},{x:5,y:0,z:15,dir:3},{x:6,y:0,z:0,dir:0},{x:6,y:0,z:1,dir:2},{x:6,y:0,z:2,dir:1},{x:6,y:0,z:3,dir:1},{x:6,y:0,z:4,dir:2},{x:6,y:0,z:5,dir:2},{x:6,y:0,z:6,dir:3},{x:6,y:0,z:7,dir:1},{x:6,y:0,z:8,dir:0},{x:6,y:0,z:9,dir:3},{x:6,y:0,z:10,dir:3},{x:6,y:0,z:11,dir:0},{x:6,y:0,z:12,dir:0},{x:6,y:0,z:13,dir:3},{x:6,y:0,z:15,dir:0},{x:7,y:0,z:0,dir:1},{x:7,y:0,z:1,dir:0},{x:7,y:0,z:2,dir:3},{x:7,y:0,z:3,dir:3},{x:7,y:0,z:4,dir:3},{x:7,y:0,z:5,dir:0},{x:7,y:0,z:6,dir:0},{x:7,y:0,z:7,dir:3},{x:7,y:0,z:8,dir:0},{x:7,y:0,z:9,dir:0},{x:7,y:0,z:10,dir:2},{x:7,y:0,z:11,dir:1},{x:7,y:0,z:12,dir:2},{x:7,y:0,z:13,dir:2},{x:7,y:0,z:15,dir:2},{x:8,y:0,z:0,dir:0},{x:8,y:0,z:1,dir:0},{x:8,y:0,z:2,dir:0},{x:8,y:0,z:3,dir:1},{x:8,y:0,z:4,dir:2},{x:8,y:0,z:5,dir:0},{x:8,y:0,z:6,dir:1},{x:8,y:0,z:7,dir:3},{x:8,y:0,z:8,dir:0},{x:8,y:0,z:9,dir:0},{x:8,y:0,z:10,dir:1},{x:8,y:0,z:11,dir:2},{x:8,y:0,z:12,dir:0},{x:8,y:0,z:13,dir:2},{x:8,y:0,z:15,dir:2},{x:9,y:0,z:0,dir:0},{x:9,y:0,z:1,dir:2},{x:9,y:0,z:2,dir:1},{x:9,y:0,z:3,dir:0},{x:9,y:0,z:4,dir:3},{x:9,y:0,z:5,dir:2},{x:9,y:0,z:6,dir:0},{x:9,y:0,z:7,dir:1},{x:9,y:0,z:8,dir:3},{x:9,y:0,z:9,dir:1},{x:9,y:0,z:10,dir:1},{x:9,y:0,z:11,dir:1},{x:9,y:0,z:12,dir:2},{x:9,y:0,z:13,dir:0},{x:9,y:0,z:15,dir:3},{x:10,y:0,z:0,dir:1},{x:10,y:0,z:1,dir:3},{x:10,y:0,z:2,dir:3},{x:10,y:0,z:3,dir:1},{x:10,y:0,z:4,dir:3},{x:10,y:0,z:5,dir:0},{x:10,y:0,z:6,dir:2},{x:10,y:0,z:7,dir:3},{x:10,y:0,z:8,dir:2},{x:10,y:0,z:9,dir:1},{x:10,y:0,z:10,dir:0},{x:10,y:0,z:11,dir:3},{x:10,y:0,z:12,dir:1},{x:10,y:0,z:13,dir:1},{x:10,y:0,z:15,dir:2},{x:11,y:0,z:0,dir:3},{x:11,y:0,z:1,dir:0},{x:11,y:0,z:2,dir:2},{x:11,y:0,z:3,dir:3},{x:11,y:0,z:4,dir:2},{x:11,y:0,z:5,dir:0},{x:11,y:0,z:6,dir:0},{x:11,y:0,z:7,dir:3},{x:11,y:0,z:8,dir:0},{x:11,y:0,z:9,dir:3},{x:11,y:0,z:10,dir:3},{x:11,y:0,z:11,dir:1},{x:11,y:0,z:12,dir:1},{x:11,y:0,z:13,dir:1},{x:11,y:0,z:15,dir:1},{x:12,y:0,z:0,dir:2},{x:12,y:0,z:1,dir:3},{x:12,y:0,z:2,dir:0},{x:12,y:0,z:3,dir:0},{x:12,y:0,z:4,dir:3},{x:12,y:0,z:5,dir:3},{x:12,y:0,z:6,dir:1},{x:12,y:0,z:7,dir:2},{x:12,y:0,z:8,dir:1},{x:12,y:0,z:9,dir:2},{x:12,y:0,z:10,dir:3},{x:12,y:0,z:11,dir:3},{x:12,y:0,z:12,dir:0},{x:12,y:0,z:13,dir:1},{x:12,y:0,z:15,dir:3},{x:13,y:0,z:0,dir:0},{x:13,y:0,z:1,dir:1},{x:13,y:0,z:2,dir:2},{x:13,y:0,z:3,dir:0},{x:13,y:0,z:4,dir:0},{x:13,y:0,z:5,dir:0},{x:13,y:0,z:6,dir:0},{x:13,y:0,z:7,dir:3},{x:13,y:0,z:8,dir:3},{x:13,y:0,z:9,dir:1},{x:13,y:0,z:10,dir:1},{x:13,y:0,z:11,dir:0},{x:13,y:0,z:12,dir:0},{x:13,y:0,z:13,dir:2},{x:13,y:0,z:14,dir:1},{x:13,y:0,z:15,dir:0},{x:14,y:0,z:0,dir:2},{x:14,y:0,z:1,dir:0},{x:14,y:0,z:2,dir:3},{x:14,y:0,z:3,dir:0},{x:14,y:0,z:4,dir:2},{x:14,y:0,z:5,dir:1},{x:14,y:0,z:6,dir:1},{x:14,y:0,z:7,dir:0},{x:14,y:0,z:8,dir:0},{x:14,y:0,z:9,dir:2},{x:14,y:0,z:10,dir:1},{x:14,y:0,z:11,dir:3},{x:14,y:0,z:12,dir:2},{x:14,y:0,z:13,dir:3},{x:14,y:0,z:14,dir:2},{x:14,y:0,z:15,dir:1},{x:15,y:0,z:0,dir:2},{x:15,y:0,z:1,dir:0},{x:15,y:0,z:2,dir:2},{x:15,y:0,z:3,dir:1},{x:15,y:0,z:4,dir:1},{x:15,y:0,z:5,dir:3},{x:15,y:0,z:6,dir:1},{x:15,y:0,z:7,dir:1},{x:15,y:0,z:8,dir:1},{x:15,y:0,z:9,dir:0},{x:15,y:0,z:10,dir:0},{x:15,y:0,z:11,dir:1},{x:15,y:0,z:12,dir:3},{x:15,y:0,z:13,dir:0},{x:15,y:0,z:14,dir:1},{x:15,y:0,z:15,dir:1},{x:16,y:0,z:0,dir:3},{x:16,y:0,z:1,dir:0},{x:16,y:0,z:2,dir:2},{x:16,y:0,z:3,dir:2},{x:16,y:0,z:4,dir:2},{x:16,y:0,z:5,dir:1},{x:16,y:0,z:6,dir:0},{x:16,y:0,z:7,dir:2},{x:16,y:0,z:8,dir:3},{x:16,y:0,z:9,dir:1},{x:16,y:0,z:10,dir:0},{x:16,y:0,z:11,dir:3},{x:16,y:0,z:12,dir:3},{x:16,y:0,z:13,dir:3},{x:16,y:0,z:15,dir:1},{x:17,y:0,z:0,dir:1},{x:17,y:0,z:1,dir:2},{x:17,y:0,z:2,dir:0},{x:17,y:0,z:3,dir:2},{x:17,y:0,z:4,dir:2},{x:17,y:0,z:5,dir:1},{x:17,y:0,z:6,dir:2},{x:17,y:0,z:7,dir:1},{x:17,y:0,z:8,dir:2},{x:17,y:0,z:9,dir:0},{x:17,y:0,z:10,dir:2},{x:17,y:0,z:11,dir:0},{x:17,y:0,z:12,dir:3},{x:17,y:0,z:13,dir:1},{x:17,y:0,z:15,dir:2},{x:18,y:0,z:0,dir:1},{x:18,y:0,z:1,dir:2},{x:18,y:0,z:2,dir:0},{x:18,y:0,z:3,dir:3},{x:18,y:0,z:4,dir:0},{x:18,y:0,z:5,dir:1},{x:18,y:0,z:6,dir:1},{x:18,y:0,z:7,dir:3},{x:18,y:0,z:8,dir:1},{x:18,y:0,z:9,dir:1},{x:18,y:0,z:10,dir:3},{x:18,y:0,z:11,dir:2},{x:18,y:0,z:12,dir:0},{x:18,y:0,z:13,dir:0},{x:18,y:0,z:15,dir:0},{x:19,y:0,z:0,dir:2},{x:19,y:0,z:5,dir:0},{x:19,y:0,z:6,dir:0},{x:19,y:0,z:7,dir:2},{x:19,y:0,z:8,dir:1},{x:19,y:0,z:9,dir:0},{x:19,y:0,z:10,dir:3},{x:19,y:0,z:11,dir:1},{x:19,y:0,z:12,dir:1},{x:19,y:0,z:13,dir:0},{x:19,y:0,z:15,dir:3},{x:20,y:0,z:0,dir:2},{x:20,y:0,z:5,dir:3},{x:20,y:0,z:6,dir:1},{x:20,y:0,z:7,dir:1},{x:20,y:0,z:8,dir:0},{x:20,y:0,z:9,dir:0},{x:20,y:0,z:10,dir:0},{x:20,y:0,z:11,dir:2},{x:20,y:0,z:12,dir:2},{x:20,y:0,z:13,dir:0},{x:20,y:0,z:15,dir:1},{x:21,y:0,z:0,dir:2},{x:21,y:0,z:5,dir:2},{x:21,y:0,z:6,dir:2},{x:21,y:0,z:7,dir:3},{x:21,y:0,z:8,dir:0},{x:21,y:0,z:9,dir:1},{x:21,y:0,z:10,dir:0},{x:21,y:0,z:11,dir:1},{x:21,y:0,z:12,dir:2},{x:21,y:0,z:13,dir:3},{x:21,y:0,z:15,dir:3},{x:22,y:0,z:0,dir:2},{x:22,y:0,z:5,dir:1},{x:22,y:0,z:6,dir:0},{x:22,y:0,z:7,dir:3},{x:22,y:0,z:8,dir:2},{x:22,y:0,z:9,dir:2},{x:22,y:0,z:10,dir:1},{x:22,y:0,z:11,dir:1},{x:22,y:0,z:12,dir:3},{x:22,y:0,z:13,dir:2},{x:22,y:0,z:15,dir:0},{x:23,y:0,z:0,dir:2},{x:23,y:0,z:5,dir:2},{x:23,y:0,z:6,dir:3},{x:23,y:0,z:7,dir:2},{x:23,y:0,z:8,dir:2},{x:23,y:0,z:9,dir:0},{x:23,y:0,z:10,dir:1},{x:23,y:0,z:11,dir:1},{x:23,y:0,z:12,dir:3},{x:23,y:0,z:13,dir:1},{x:23,y:0,z:15,dir:2},{x:24,y:0,z:0,dir:2},{x:24,y:0,z:1,dir:0},{x:24,y:0,z:2,dir:3},{x:24,y:0,z:3,dir:3},{x:24,y:0,z:4,dir:3},{x:24,y:0,z:5,dir:3},{x:24,y:0,z:6,dir:1},{x:24,y:0,z:7,dir:3},{x:24,y:0,z:8,dir:0},{x:24,y:0,z:9,dir:2},{x:24,y:0,z:10,dir:3},{x:24,y:0,z:11,dir:0},{x:24,y:0,z:12,dir:0},{x:24,y:0,z:13,dir:0},{x:24,y:0,z:14,dir:0},{x:24,y:0,z:15,dir:0}]},2:{3:[{x:0,y:1,z:0,dir:2},{x:0,y:1,z:1,dir:1},{x:0,y:1,z:2,dir:0},{x:0,y:1,z:3,dir:2},{x:0,y:1,z:4,dir:0},{x:0,y:1,z:5,dir:1},{x:0,y:1,z:6,dir:3},{x:0,y:1,z:7,dir:3},{x:0,y:1,z:8,dir:1},{x:0,y:1,z:9,dir:1},{x:0,y:1,z:10,dir:0},{x:0,y:1,z:11,dir:1},{x:0,y:1,z:12,dir:0},{x:1,y:1,z:0,dir:3},{x:1,y:1,z:6,dir:2},{x:1,y:1,z:12,dir:0},{x:2,y:1,z:0,dir:3},{x:2,y:1,z:6,dir:1},{x:2,y:1,z:12,dir:1},{x:3,y:1,z:0,dir:1},{x:3,y:1,z:6,dir:1},{x:3,y:1,z:12,dir:3},{x:4,y:1,z:0,dir:1},{x:4,y:1,z:1,dir:3},{x:4,y:1,z:3,dir:3},{x:4,y:1,z:4,dir:1},{x:4,y:1,z:6,dir:0},{x:4,y:1,z:12,dir:2},{x:5,y:1,z:0,dir:2},{x:5,y:1,z:3,dir:0},{x:5,y:1,z:4,dir:1},{x:5,y:1,z:5,dir:1},{x:5,y:1,z:6,dir:3},{x:5,y:1,z:8,dir:3},{x:5,y:1,z:10,dir:0},{x:5,y:1,z:11,dir:3},{x:5,y:1,z:12,dir:1},{x:5,y:2,z:3,dir:3},{x:5,y:2,z:4,dir:1},{x:5,y:2,z:6,dir:2},{x:5,y:2,z:7,dir:2},{x:5,y:2,z:8,dir:0},{x:5,y:2,z:9,dir:0},{x:5,y:2,z:10,dir:3},{x:5,y:2,z:11,dir:0},{x:6,y:1,z:0,dir:1},{x:6,y:1,z:3,dir:0},{x:6,y:1,z:11,dir:2},{x:6,y:1,z:12,dir:1},{x:6,y:2,z:3,dir:0},{x:6,y:2,z:4,dir:3},{x:6,y:2,z:5,dir:3},{x:6,y:2,z:6,dir:1},{x:6,y:2,z:7,dir:1},{x:6,y:2,z:8,dir:1},{x:6,y:2,z:9,dir:0},{x:6,y:2,z:10,dir:0},{x:6,y:2,z:11,dir:3},{x:7,y:1,z:0,dir:2},{x:7,y:1,z:11,dir:3},{x:7,y:1,z:12,dir:3},{x:7,y:2,z:3,dir:1},{x:7,y:2,z:4,dir:2},{x:7,y:2,z:5,dir:0},{x:7,y:2,z:6,dir:1},{x:7,y:2,z:7,dir:2},{x:7,y:2,z:8,dir:3},{x:7,y:2,z:9,dir:1},{x:7,y:2,z:10,dir:3},{x:7,y:2,z:11,dir:1},{x:7,y:2,z:12,dir:3},{x:7,y:3,z:4,dir:2},{x:7,y:3,z:5,dir:1},{x:7,y:3,z:7,dir:3},{x:7,y:3,z:8,dir:2},{x:7,y:3,z:9,dir:0},{x:8,y:1,z:0,dir:0},{x:8,y:1,z:3,dir:3},{x:8,y:1,z:4,dir:1},{x:8,y:2,z:3,dir:2},{x:8,y:2,z:4,dir:1},{x:8,y:2,z:5,dir:1},{x:8,y:2,z:6,dir:1},{x:8,y:2,z:7,dir:1},{x:8,y:2,z:8,dir:1},{x:8,y:2,z:9,dir:1},{x:8,y:2,z:10,dir:2},{x:8,y:2,z:11,dir:0},{x:8,y:2,z:12,dir:2},{x:8,y:3,z:4,dir:2},{x:8,y:3,z:5,dir:0},{x:8,y:3,z:6,dir:0},{x:8,y:3,z:7,dir:0},{x:8,y:3,z:8,dir:3},{x:8,y:3,z:9,dir:0},{x:9,y:1,z:0,dir:3},{x:9,y:1,z:1,dir:1},{x:9,y:1,z:2,dir:3},{x:9,y:1,z:3,dir:0},{x:9,y:1,z:4,dir:0},{x:9,y:1,z:8,dir:1},{x:9,y:1,z:11,dir:2},{x:9,y:1,z:12,dir:3},{x:9,y:2,z:2,dir:0},{x:9,y:2,z:3,dir:2},{x:9,y:2,z:4,dir:3},{x:9,y:2,z:5,dir:2},{x:9,y:2,z:6,dir:0},{x:9,y:2,z:7,dir:1},{x:9,y:2,z:8,dir:1},{x:9,y:2,z:9,dir:0},{x:9,y:2,z:10,dir:2},{x:9,y:2,z:11,dir:0},{x:9,y:2,z:12,dir:3},{x:9,y:3,z:5,dir:0},{x:9,y:3,z:6,dir:0},{x:9,y:3,z:7,dir:0},{x:9,y:3,z:8,dir:0},{x:10,y:1,z:2,dir:1},{x:10,y:1,z:3,dir:0},{x:10,y:1,z:4,dir:0},{x:10,y:1,z:8,dir:1},{x:10,y:1,z:9,dir:3},{x:10,y:1,z:10,dir:3},{x:10,y:1,z:11,dir:1},{x:10,y:1,z:12,dir:1},{x:10,y:1,z:13,dir:1},{x:10,y:1,z:14,dir:1},{x:10,y:1,z:15,dir:1},{x:10,y:2,z:2,dir:2},{x:10,y:2,z:4,dir:0},{x:10,y:2,z:5,dir:2},{x:10,y:2,z:6,dir:2},{x:10,y:2,z:7,dir:1},{x:10,y:2,z:8,dir:1},{x:10,y:2,z:9,dir:1},{x:10,y:2,z:10,dir:2},{x:10,y:2,z:11,dir:2},{x:10,y:2,z:12,dir:1},{x:10,y:2,z:13,dir:1},{x:10,y:2,z:14,dir:1},{x:10,y:3,z:4,dir:3},{x:10,y:3,z:5,dir:0},{x:10,y:3,z:6,dir:0},{x:10,y:3,z:7,dir:0},{x:10,y:3,z:8,dir:0},{x:10,y:3,z:9,dir:0},{x:10,y:4,z:7,dir:0},{x:10,y:4,z:8,dir:0},{x:10,y:4,z:9,dir:0},{x:11,y:1,z:3,dir:3},{x:11,y:1,z:4,dir:1},{x:11,y:1,z:5,dir:3},{x:11,y:1,z:8,dir:3},{x:11,y:1,z:9,dir:3},{x:11,y:1,z:10,dir:2},{x:11,y:1,z:11,dir:3},{x:11,y:1,z:12,dir:1},{x:11,y:2,z:4,dir:1},{x:11,y:2,z:5,dir:3},{x:11,y:2,z:9,dir:1},{x:11,y:2,z:10,dir:0},{x:11,y:2,z:11,dir:2},{x:11,y:2,z:12,dir:1},{x:11,y:3,z:4,dir:2},{x:11,y:3,z:5,dir:0},{x:11,y:3,z:6,dir:0},{x:11,y:3,z:9,dir:0},{x:12,y:1,z:3,dir:2},{x:12,y:1,z:4,dir:3},{x:12,y:1,z:5,dir:0},{x:12,y:1,z:7,dir:1},{x:12,y:2,z:4,dir:1},{x:12,y:2,z:5,dir:3},{x:12,y:2,z:6,dir:0},{x:12,y:2,z:7,dir:3},{x:12,y:2,z:9,dir:0},{x:12,y:2,z:10,dir:1},{x:12,y:2,z:11,dir:0},{x:12,y:2,z:12,dir:3},{x:12,y:3,z:4,dir:3},{x:12,y:3,z:5,dir:0},{x:12,y:3,z:6,dir:2},{x:12,y:3,z:7,dir:1},{x:12,y:3,z:8,dir:0},{x:12,y:3,z:9,dir:0},{x:13,y:1,z:3,dir:3},{x:13,y:1,z:4,dir:0},{x:13,y:1,z:12,dir:1},{x:13,y:2,z:4,dir:1},{x:13,y:2,z:5,dir:1},{x:13,y:2,z:6,dir:1},{x:13,y:2,z:7,dir:2},{x:13,y:2,z:9,dir:3},{x:13,y:2,z:10,dir:1},{x:13,y:2,z:11,dir:1},{x:13,y:2,z:12,dir:3},{x:13,y:3,z:4,dir:1},{x:13,y:3,z:5,dir:1},{x:13,y:3,z:6,dir:0},{x:13,y:3,z:7,dir:0},{x:13,y:3,z:8,dir:0},{x:13,y:3,z:9,dir:0},{x:13,y:4,z:4,dir:1},{x:14,y:1,z:3,dir:3},{x:14,y:1,z:4,dir:0},{x:14,y:1,z:12,dir:1},{x:14,y:2,z:4,dir:1},{x:14,y:2,z:5,dir:1},{x:14,y:2,z:6,dir:0},{x:14,y:2,z:7,dir:2},{x:14,y:2,z:8,dir:0},{x:14,y:2,z:9,dir:3},{x:14,y:2,z:10,dir:0},{x:14,y:2,z:11,dir:3},{x:15,y:1,z:3,dir:0},{x:15,y:1,z:4,dir:0},{x:15,y:1,z:5,dir:3},{x:15,y:1,z:6,dir:1},{x:15,y:1,z:7,dir:3},{x:15,y:1,z:8,dir:1},{x:15,y:1,z:9,dir:1},{x:15,y:1,z:12,dir:3},{x:15,y:2,z:4,dir:1},{x:15,y:2,z:5,dir:1},{x:15,y:2,z:6,dir:2},{x:15,y:2,z:7,dir:0},{x:15,y:2,z:8,dir:1},{x:15,y:2,z:9,dir:3},{x:15,y:2,z:10,dir:1},{x:15,y:2,z:11,dir:3},{x:15,y:2,z:12,dir:0},{x:15,y:3,z:9,dir:0},{x:15,y:3,z:10,dir:0},{x:16,y:1,z:3,dir:1},{x:16,y:1,z:4,dir:2},{x:16,y:1,z:5,dir:2},{x:16,y:1,z:6,dir:0},{x:16,y:1,z:7,dir:3},{x:16,y:1,z:9,dir:1},{x:16,y:1,z:12,dir:2},{x:16,y:2,z:9,dir:0},{x:16,y:2,z:10,dir:0},{x:16,y:2,z:11,dir:0},{x:16,y:2,z:12,dir:0},{x:16,y:3,z:9,dir:0},{x:16,y:3,z:10,dir:0},{x:17,y:1,z:7,dir:2},{x:17,y:1,z:12,dir:3},{x:17,y:2,z:10,dir:0},{x:17,y:2,z:11,dir:0},{x:17,y:2,z:12,dir:0},{x:18,y:1,z:7,dir:3},{x:18,y:1,z:12,dir:2},{x:18,y:2,z:10,dir:0},{x:18,y:2,z:11,dir:0},{x:18,y:2,z:12,dir:0},{x:19,y:1,z:7,dir:1},{x:19,y:1,z:12,dir:2},{x:19,y:2,z:10,dir:0},{x:19,y:2,z:11,dir:0},{x:19,y:2,z:12,dir:0},{x:20,y:1,z:2,dir:2},{x:20,y:1,z:3,dir:2},{x:20,y:1,z:6,dir:0},{x:20,y:1,z:7,dir:0},{x:20,y:1,z:10,dir:0},{x:20,y:1,z:11,dir:0},{x:20,y:1,z:12,dir:1},{x:20,y:2,z:6,dir:3},{x:20,y:2,z:7,dir:1},{x:20,y:2,z:8,dir:2},{x:20,y:2,z:9,dir:1},{x:20,y:2,z:10,dir:0},{x:20,y:2,z:11,dir:1},{x:20,y:2,z:12,dir:0},{x:21,y:1,z:2,dir:2},{x:21,y:1,z:3,dir:2},{x:21,y:2,z:6,dir:0},{x:21,y:2,z:7,dir:3},{x:21,y:2,z:8,dir:0},{x:21,y:2,z:9,dir:1},{x:21,y:2,z:10,dir:0},{x:21,y:2,z:11,dir:0},{x:21,y:2,z:12,dir:0},{x:22,y:1,z:2,dir:2},{x:22,y:1,z:3,dir:2},{x:22,y:1,z:10,dir:3},{x:22,y:1,z:11,dir:3},{x:22,y:1,z:12,dir:0},{x:22,y:2,z:6,dir:2},{x:22,y:2,z:7,dir:3},{x:22,y:2,z:11,dir:0},{x:22,y:2,z:12,dir:0},{x:23,y:1,z:6,dir:3},{x:23,y:1,z:7,dir:2},{x:23,y:1,z:9,dir:2},{x:23,y:1,z:10,dir:2},{x:23,y:1,z:11,dir:0},{x:23,y:1,z:12,dir:0},{x:23,y:2,z:6,dir:0},{x:23,y:2,z:7,dir:3},{x:23,y:2,z:8,dir:3},{x:23,y:2,z:9,dir:2},{x:23,y:2,z:10,dir:1},{x:23,y:2,z:11,dir:3},{x:23,y:2,z:12,dir:0},{x:24,y:1,z:10,dir:2},{x:24,y:1,z:11,dir:2},{x:24,y:1,z:12,dir:2},{x:24,y:2,z:10,dir:2},{x:24,y:2,z:11,dir:2},{x:24,y:2,z:12,dir:2}]},4:{0:[{x:5,y:3,z:3,dir:1},{x:6,y:1,z:14,dir:1},{x:6,y:2,z:12,dir:1},{x:7,y:4,z:9,dir:1},{x:9,y:1,z:15,dir:1},{x:10,y:2,z:15,dir:1},{x:10,y:4,z:6,dir:1},{x:11,y:1,z:15,dir:1},{x:12,y:4,z:4,dir:1},{x:13,y:4,z:5,dir:1},{x:15,y:3,z:4,dir:0},{x:15,y:3,z:8,dir:0},{x:16,y:1,z:14,dir:1},{x:17,y:3,z:10,dir:2},{x:18,y:1,z:13,dir:1},{x:20,y:1,z:14,dir:1},{x:20,y:2,z:2,dir:0},{x:20,y:2,z:3,dir:0},{x:21,y:3,z:8,dir:2},{x:21,y:3,z:9,dir:2},{x:21,y:3,z:10,dir:2},{x:23,y:3,z:8,dir:2},{x:23,y:3,z:9,dir:2},{x:23,y:3,z:10,dir:2}]},5:{0:[{x:1,y:1,z:1,dir:2},{x:2,y:1,z:11,dir:0},{x:2,y:1,z:13,dir:2},{x:3,y:1,z:11,dir:0},{x:3,y:1,z:13,dir:2},{x:4,y:1,z:5,dir:1},{x:5,y:1,z:1,dir:2},{x:5,y:2,z:5,dir:1},{x:7,y:3,z:6,dir:1},{x:9,y:3,z:4,dir:0},{x:9,y:3,z:9,dir:2},{x:10,y:2,z:3,dir:3},{x:11,y:1,z:2,dir:0},{x:11,y:1,z:7,dir:0},{x:12,y:1,z:8,dir:3},{x:14,y:1,z:13,dir:2},{x:14,y:2,z:12,dir:2},{x:17,y:1,z:5,dir:3},{x:18,y:1,z:8,dir:2},{x:22,y:1,z:9,dir:0},{x:22,y:2,z:10,dir:0}]},6:{0:[{x:11,y:2,z:8,dir:3},{x:11,y:3,z:8,dir:3},{x:11,y:4,z:8,dir:3},{x:23,y:1,z:2,dir:3}]}},width:25,height:5,depth:16,name:"",surfaceArea:429},{data:{1:{0:[{x:0,y:0,z:0,dir:3},{x:0,y:0,z:1,dir:1},{x:0,y:0,z:2,dir:1},{x:0,y:0,z:3,dir:3},{x:0,y:0,z:4,dir:0},{x:0,y:0,z:5,dir:1},{x:0,y:0,z:6,dir:0},{x:0,y:0,z:7,dir:0},{x:0,y:0,z:8,dir:0},{x:0,y:0,z:9,dir:1},{x:0,y:0,z:10,dir:1},{x:0,y:0,z:11,dir:1},{x:1,y:0,z:0,dir:2},{x:1,y:0,z:1,dir:3},{x:1,y:0,z:2,dir:1},{x:1,y:0,z:3,dir:0},{x:1,y:0,z:4,dir:1},{x:1,y:0,z:5,dir:2},{x:1,y:0,z:6,dir:1},{x:1,y:0,z:7,dir:3},{x:1,y:0,z:8,dir:1},{x:1,y:0,z:9,dir:2},{x:1,y:0,z:10,dir:2},{x:1,y:0,z:11,dir:0},{x:2,y:0,z:0,dir:0},{x:2,y:0,z:1,dir:3},{x:2,y:0,z:2,dir:0},{x:2,y:0,z:3,dir:2},{x:2,y:0,z:4,dir:0},{x:2,y:0,z:5,dir:0},{x:2,y:0,z:6,dir:2},{x:2,y:0,z:7,dir:3},{x:2,y:0,z:8,dir:1},{x:2,y:0,z:9,dir:0},{x:2,y:0,z:10,dir:1},{x:2,y:0,z:11,dir:1},{x:3,y:0,z:0,dir:2},{x:3,y:0,z:1,dir:1},{x:3,y:0,z:2,dir:1},{x:3,y:0,z:3,dir:3},{x:3,y:0,z:4,dir:3},{x:3,y:0,z:5,dir:2},{x:3,y:0,z:6,dir:0},{x:3,y:0,z:7,dir:2},{x:3,y:0,z:8,dir:0},{x:3,y:0,z:9,dir:3},{x:3,y:0,z:10,dir:2},{x:3,y:0,z:11,dir:3},{x:4,y:0,z:0,dir:0},{x:4,y:0,z:1,dir:3},{x:4,y:0,z:2,dir:1},{x:4,y:0,z:3,dir:3},{x:4,y:0,z:4,dir:1},{x:4,y:0,z:5,dir:3},{x:4,y:0,z:6,dir:0},{x:4,y:0,z:7,dir:2},{x:4,y:0,z:8,dir:0},{x:4,y:0,z:9,dir:1},{x:4,y:0,z:10,dir:0},{x:4,y:0,z:11,dir:1},{x:5,y:0,z:0,dir:0},{x:5,y:0,z:1,dir:0},{x:5,y:0,z:2,dir:3},{x:5,y:0,z:3,dir:3},{x:5,y:0,z:4,dir:0},{x:5,y:0,z:5,dir:1},{x:5,y:0,z:6,dir:3},{x:5,y:0,z:7,dir:3},{x:5,y:0,z:8,dir:0},{x:5,y:0,z:9,dir:1},{x:5,y:0,z:10,dir:0},{x:5,y:0,z:11,dir:1},{x:6,y:0,z:0,dir:1},{x:6,y:0,z:1,dir:3},{x:6,y:0,z:2,dir:3},{x:6,y:0,z:3,dir:2},{x:6,y:0,z:4,dir:0},{x:6,y:0,z:5,dir:3},{x:6,y:0,z:6,dir:0},{x:6,y:0,z:7,dir:2},{x:6,y:0,z:8,dir:2},{x:6,y:0,z:9,dir:3},{x:6,y:0,z:10,dir:2},{x:6,y:0,z:11,dir:3},{x:7,y:0,z:0,dir:1},{x:7,y:0,z:1,dir:2},{x:7,y:0,z:2,dir:3},{x:7,y:0,z:3,dir:0},{x:7,y:0,z:4,dir:3},{x:7,y:0,z:5,dir:3},{x:7,y:0,z:6,dir:1},{x:7,y:0,z:7,dir:3},{x:7,y:0,z:8,dir:2},{x:7,y:0,z:9,dir:3},{x:7,y:0,z:10,dir:0},{x:7,y:0,z:11,dir:1},{x:8,y:0,z:0,dir:3},{x:8,y:0,z:1,dir:0},{x:8,y:0,z:2,dir:1},{x:8,y:0,z:3,dir:2},{x:8,y:0,z:4,dir:3},{x:8,y:0,z:5,dir:1},{x:8,y:0,z:6,dir:3},{x:8,y:0,z:7,dir:1},{x:8,y:0,z:8,dir:2},{x:8,y:0,z:9,dir:2},{x:8,y:0,z:10,dir:2},{x:8,y:0,z:11,dir:1},{x:9,y:0,z:0,dir:2},{x:9,y:0,z:1,dir:3},{x:9,y:0,z:2,dir:1},{x:9,y:0,z:3,dir:0},{x:9,y:0,z:4,dir:0},{x:9,y:0,z:5,dir:2},{x:9,y:0,z:6,dir:2},{x:9,y:0,z:7,dir:1},{x:9,y:0,z:8,dir:0},{x:9,y:0,z:9,dir:1},{x:9,y:0,z:10,dir:0},{x:9,y:0,z:11,dir:2},{x:10,y:0,z:0,dir:0},{x:10,y:0,z:1,dir:3},{x:10,y:0,z:2,dir:0},{x:10,y:0,z:3,dir:0},{x:10,y:0,z:4,dir:0},{x:10,y:0,z:5,dir:2},{x:10,y:0,z:6,dir:2},{x:10,y:0,z:7,dir:3},{x:10,y:0,z:8,dir:3},{x:10,y:0,z:9,dir:0},{x:10,y:0,z:10,dir:0},{x:10,y:0,z:11,dir:3},{x:11,y:0,z:0,dir:0},{x:11,y:0,z:1,dir:2},{x:11,y:0,z:2,dir:2},{x:11,y:0,z:3,dir:0},{x:11,y:0,z:4,dir:1},{x:11,y:0,z:5,dir:3},{x:11,y:0,z:6,dir:1},{x:11,y:0,z:7,dir:2},{x:11,y:0,z:8,dir:2},{x:11,y:0,z:9,dir:1},{x:11,y:0,z:10,dir:2},{x:11,y:0,z:11,dir:3},{x:12,y:0,z:0,dir:1},{x:12,y:0,z:1,dir:3},{x:12,y:0,z:2,dir:1},{x:12,y:0,z:3,dir:0},{x:12,y:0,z:4,dir:3},{x:12,y:0,z:5,dir:0},{x:12,y:0,z:6,dir:3},{x:12,y:0,z:7,dir:3},{x:12,y:0,z:8,dir:3},{x:12,y:0,z:9,dir:3},{x:12,y:0,z:10,dir:1},{x:12,y:0,z:11,dir:0},{x:13,y:0,z:0,dir:2},{x:13,y:0,z:1,dir:0},{x:13,y:0,z:2,dir:3},{x:13,y:0,z:3,dir:2},{x:13,y:0,z:4,dir:3},{x:13,y:0,z:5,dir:0},{x:13,y:0,z:6,dir:1},{x:13,y:0,z:7,dir:2},{x:13,y:0,z:8,dir:2},{x:13,y:0,z:9,dir:0},{x:13,y:0,z:10,dir:2},{x:13,y:0,z:11,dir:1},{x:14,y:0,z:0,dir:0},{x:14,y:0,z:1,dir:3},{x:14,y:0,z:2,dir:1},{x:14,y:0,z:3,dir:1},{x:14,y:0,z:4,dir:1},{x:14,y:0,z:5,dir:0},{x:14,y:0,z:6,dir:2},{x:14,y:0,z:7,dir:1},{x:14,y:0,z:8,dir:1},{x:14,y:0,z:9,dir:3},{x:14,y:0,z:10,dir:1},{x:14,y:0,z:11,dir:0},{x:15,y:0,z:0,dir:0},{x:15,y:0,z:1,dir:1},{x:15,y:0,z:2,dir:3},{x:15,y:0,z:3,dir:3},{x:15,y:0,z:4,dir:0},{x:15,y:0,z:5,dir:1},{x:15,y:0,z:6,dir:2},{x:15,y:0,z:7,dir:0},{x:15,y:0,z:8,dir:2},{x:15,y:0,z:9,dir:3},{x:15,y:0,z:10,dir:1},{x:15,y:0,z:11,dir:0},{x:16,y:0,z:0,dir:2},{x:16,y:0,z:1,dir:3},{x:16,y:0,z:2,dir:2},{x:16,y:0,z:3,dir:3},{x:16,y:0,z:4,dir:1},{x:16,y:0,z:5,dir:0},{x:16,y:0,z:6,dir:2},{x:16,y:0,z:7,dir:3},{x:16,y:0,z:8,dir:0},{x:16,y:0,z:9,dir:2},{x:16,y:0,z:10,dir:2},{x:16,y:0,z:11,dir:0},{x:17,y:0,z:0,dir:3},{x:17,y:0,z:1,dir:3},{x:17,y:0,z:2,dir:2},{x:17,y:0,z:3,dir:0},{x:17,y:0,z:4,dir:1},{x:17,y:0,z:5,dir:0},{x:17,y:0,z:6,dir:2},{x:17,y:0,z:7,dir:0},{x:17,y:0,z:8,dir:2},{x:17,y:0,z:9,dir:3},{x:17,y:0,z:10,dir:2},{x:17,y:0,z:11,dir:3},{x:18,y:0,z:0,dir:1},{x:18,y:0,z:1,dir:2},{x:18,y:0,z:2,dir:1},{x:18,y:0,z:3,dir:0},{x:18,y:0,z:4,dir:0},{x:18,y:0,z:5,dir:0},{x:18,y:0,z:6,dir:0},{x:18,y:0,z:7,dir:3},{x:18,y:0,z:8,dir:3},{x:18,y:0,z:9,dir:1},{x:18,y:0,z:10,dir:0},{x:18,y:0,z:11,dir:3},{x:19,y:0,z:0,dir:2},{x:19,y:0,z:1,dir:0},{x:19,y:0,z:2,dir:2},{x:19,y:0,z:3,dir:3},{x:19,y:0,z:4,dir:2},{x:19,y:0,z:5,dir:2},{x:19,y:0,z:6,dir:3},{x:19,y:0,z:7,dir:3},{x:19,y:0,z:8,dir:1},{x:19,y:0,z:9,dir:3},{x:19,y:0,z:10,dir:1},{x:19,y:0,z:11,dir:3},{x:20,y:0,z:0,dir:1},{x:20,y:0,z:1,dir:2},{x:20,y:0,z:2,dir:3},{x:20,y:0,z:3,dir:2},{x:20,y:0,z:4,dir:2},{x:20,y:0,z:5,dir:2},{x:20,y:0,z:6,dir:1},{x:20,y:0,z:7,dir:0},{x:20,y:0,z:8,dir:2},{x:20,y:0,z:9,dir:2},{x:20,y:0,z:10,dir:2},{x:20,y:0,z:11,dir:1},{x:21,y:0,z:0,dir:0},{x:21,y:0,z:1,dir:1},{x:21,y:0,z:2,dir:1},{x:21,y:0,z:3,dir:1},{x:21,y:0,z:4,dir:3},{x:21,y:0,z:5,dir:2},{x:21,y:0,z:6,dir:1},{x:21,y:0,z:7,dir:0},{x:21,y:0,z:8,dir:3},{x:21,y:0,z:9,dir:2},{x:21,y:0,z:10,dir:1},{x:21,y:0,z:11,dir:1},{x:22,y:0,z:0,dir:3},{x:22,y:0,z:1,dir:0},{x:22,y:0,z:2,dir:2},{x:22,y:0,z:3,dir:1},{x:22,y:0,z:4,dir:2},{x:22,y:0,z:5,dir:0},{x:22,y:0,z:6,dir:2},{x:22,y:0,z:7,dir:2},{x:22,y:0,z:8,dir:0},{x:22,y:0,z:9,dir:2},{x:22,y:0,z:10,dir:3},{x:22,y:0,z:11,dir:0},{x:23,y:0,z:0,dir:1},{x:23,y:0,z:1,dir:3},{x:23,y:0,z:2,dir:2},{x:23,y:0,z:3,dir:3},{x:23,y:0,z:4,dir:3},{x:23,y:0,z:5,dir:3},{x:23,y:0,z:6,dir:2},{x:23,y:0,z:7,dir:0},{x:23,y:0,z:8,dir:1},{x:23,y:0,z:9,dir:0},{x:23,y:0,z:10,dir:1},{x:23,y:0,z:11,dir:2}]},2:{6:[{x:0,y:1,z:1,dir:1},{x:0,y:1,z:2,dir:0},{x:0,y:1,z:3,dir:2},{x:0,y:2,z:1,dir:2},{x:0,y:2,z:2,dir:1},{x:0,y:2,z:3,dir:1},{x:0,y:2,z:4,dir:2},{x:1,y:2,z:1,dir:0},{x:1,y:2,z:2,dir:3},{x:1,y:2,z:3,dir:0},{x:1,y:2,z:4,dir:2},{x:2,y:1,z:1,dir:0},{x:2,y:1,z:5,dir:2},{x:2,y:1,z:6,dir:0},{x:2,y:1,z:7,dir:1},{x:2,y:1,z:8,dir:0},{x:2,y:1,z:9,dir:0},{x:2,y:1,z:10,dir:2},{x:2,y:2,z:1,dir:0},{x:2,y:2,z:2,dir:0},{x:2,y:2,z:3,dir:3},{x:2,y:2,z:4,dir:0},{x:2,y:2,z:5,dir:2},{x:2,y:2,z:6,dir:3},{x:2,y:2,z:7,dir:3},{x:2,y:2,z:8,dir:3},{x:2,y:2,z:9,dir:0},{x:2,y:2,z:10,dir:1},{x:2,y:3,z:5,dir:0},{x:2,y:3,z:6,dir:3},{x:2,y:3,z:7,dir:0},{x:2,y:3,z:8,dir:3},{x:2,y:3,z:9,dir:1},{x:2,y:3,z:10,dir:1},{x:3,y:1,z:1,dir:1},{x:3,y:1,z:2,dir:0},{x:3,y:1,z:5,dir:1},{x:3,y:2,z:1,dir:2},{x:3,y:2,z:2,dir:0},{x:3,y:2,z:3,dir:2},{x:3,y:2,z:4,dir:2},{x:3,y:2,z:5,dir:1},{x:3,y:3,z:1,dir:0},{x:3,y:3,z:2,dir:0},{x:3,y:3,z:3,dir:3},{x:3,y:3,z:4,dir:3},{x:3,y:3,z:5,dir:1},{x:3,y:3,z:6,dir:2},{x:3,y:3,z:7,dir:1},{x:3,y:3,z:8,dir:3},{x:3,y:3,z:9,dir:2},{x:3,y:3,z:10,dir:0},{x:3,y:4,z:1,dir:1},{x:3,y:4,z:2,dir:2},{x:4,y:1,z:0,dir:3},{x:4,y:1,z:1,dir:0},{x:4,y:1,z:2,dir:1},{x:4,y:1,z:5,dir:2},{x:4,y:2,z:1,dir:3},{x:4,y:2,z:2,dir:1},{x:4,y:2,z:3,dir:3},{x:4,y:2,z:4,dir:1},{x:4,y:2,z:5,dir:2},{x:4,y:3,z:1,dir:2},{x:4,y:3,z:2,dir:0},{x:4,y:3,z:3,dir:0},{x:4,y:3,z:4,dir:3},{x:4,y:3,z:5,dir:0},{x:4,y:3,z:6,dir:1},{x:4,y:3,z:7,dir:0},{x:4,y:3,z:9,dir:1},{x:4,y:3,z:10,dir:2},{x:4,y:4,z:1,dir:2},{x:4,y:4,z:2,dir:1},{x:4,y:4,z:5,dir:1},{x:4,y:4,z:6,dir:2},{x:4,y:4,z:7,dir:0},{x:4,y:4,z:8,dir:3},{x:4,y:4,z:9,dir:2},{x:4,y:5,z:5,dir:0},{x:4,y:5,z:7,dir:1},{x:4,y:5,z:8,dir:2},{x:4,y:5,z:9,dir:1},{x:4,y:6,z:5,dir:3},{x:4,y:6,z:6,dir:3},{x:4,y:6,z:7,dir:1},{x:4,y:6,z:8,dir:1},{x:4,y:6,z:9,dir:2},{x:4,y:7,z:5,dir:1},{x:4,y:7,z:9,dir:1},{x:5,y:1,z:0,dir:0},{x:5,y:1,z:5,dir:1},{x:5,y:1,z:9,dir:3},{x:5,y:1,z:10,dir:1},{x:5,y:2,z:1,dir:3},{x:5,y:2,z:2,dir:0},{x:5,y:2,z:3,dir:2},{x:5,y:2,z:4,dir:2},{x:5,y:2,z:9,dir:1},{x:5,y:2,z:10,dir:1},{x:5,y:3,z:1,dir:0},{x:5,y:3,z:2,dir:2},{x:5,y:3,z:3,dir:1},{x:5,y:3,z:9,dir:3},{x:5,y:3,z:10,dir:2},{x:5,y:4,z:1,dir:0},{x:5,y:4,z:2,dir:2},{x:5,y:4,z:3,dir:0},{x:5,y:4,z:5,dir:3},{x:5,y:4,z:6,dir:1},{x:5,y:4,z:7,dir:0},{x:5,y:4,z:8,dir:3},{x:5,y:4,z:9,dir:2},{x:5,y:5,z:5,dir:2},{x:5,y:5,z:9,dir:1},{x:5,y:6,z:5,dir:3},{x:5,y:6,z:6,dir:1},{x:5,y:6,z:7,dir:3},{x:5,y:6,z:9,dir:2},{x:5,y:7,z:5,dir:0},{x:5,y:7,z:9,dir:1},{x:6,y:1,z:0,dir:3},{x:6,y:1,z:1,dir:2},{x:6,y:1,z:5,dir:2},{x:6,y:1,z:9,dir:1},{x:6,y:2,z:1,dir:1},{x:6,y:2,z:2,dir:2},{x:6,y:2,z:3,dir:3},{x:6,y:2,z:4,dir:0},{x:6,y:2,z:9,dir:3},{x:6,y:3,z:1,dir:0},{x:6,y:3,z:9,dir:3},{x:6,y:4,z:1,dir:0},{x:6,y:4,z:2,dir:0},{x:6,y:4,z:3,dir:2},{x:6,y:4,z:5,dir:3},{x:6,y:4,z:6,dir:0},{x:6,y:4,z:7,dir:2},{x:6,y:4,z:8,dir:2},{x:6,y:4,z:9,dir:2},{x:6,y:5,z:5,dir:1},{x:6,y:5,z:9,dir:2},{x:6,y:6,z:5,dir:1},{x:6,y:6,z:6,dir:1},{x:6,y:6,z:7,dir:2},{x:6,y:6,z:9,dir:2},{x:6,y:7,z:5,dir:2},{x:6,y:7,z:9,dir:2},{x:7,y:1,z:0,dir:1},{x:7,y:1,z:1,dir:2},{x:7,y:1,z:5,dir:1},{x:7,y:1,z:9,dir:3},{x:7,y:2,z:1,dir:1},{x:7,y:2,z:2,dir:2},{x:7,y:2,z:3,dir:0},{x:7,y:2,z:4,dir:2},{x:7,y:2,z:5,dir:3},{x:7,y:2,z:6,dir:0},{x:7,y:2,z:7,dir:3},{x:7,y:2,z:8,dir:2},{x:7,y:2,z:9,dir:1},{x:7,y:3,z:1,dir:1},{x:7,y:4,z:1,dir:0},{x:7,y:4,z:2,dir:3},{x:7,y:4,z:3,dir:2},{x:7,y:4,z:4,dir:1},{x:7,y:4,z:5,dir:0},{x:7,y:4,z:6,dir:1},{x:7,y:4,z:7,dir:1},{x:7,y:4,z:8,dir:1},{x:7,y:4,z:9,dir:3},{x:7,y:5,z:8,dir:2},{x:7,y:5,z:9,dir:1},{x:7,y:6,z:5,dir:2},{x:7,y:6,z:6,dir:0},{x:7,y:6,z:7,dir:2},{x:7,y:6,z:9,dir:2},{x:7,y:7,z:5,dir:3},{x:7,y:7,z:9,dir:3},{x:8,y:1,z:0,dir:3},{x:8,y:1,z:1,dir:2},{x:8,y:1,z:2,dir:1},{x:8,y:1,z:3,dir:1},{x:8,y:2,z:1,dir:2},{x:8,y:2,z:2,dir:1},{x:8,y:2,z:3,dir:3},{x:8,y:2,z:4,dir:1},{x:8,y:2,z:5,dir:1},{x:8,y:2,z:6,dir:2},{x:8,y:2,z:7,dir:0},{x:8,y:2,z:8,dir:2},{x:8,y:2,z:9,dir:1},{x:8,y:3,z:1,dir:1},{x:8,y:3,z:2,dir:0},{x:8,y:3,z:3,dir:3},{x:8,y:3,z:4,dir:0},{x:8,y:3,z:9,dir:3},{x:8,y:4,z:1,dir:2},{x:8,y:4,z:2,dir:0},{x:8,y:4,z:3,dir:0},{x:8,y:4,z:4,dir:1},{x:8,y:4,z:5,dir:2},{x:8,y:4,z:6,dir:3},{x:8,y:4,z:7,dir:0},{x:8,y:4,z:8,dir:0},{x:8,y:4,z:9,dir:1},{x:8,y:5,z:5,dir:3},{x:8,y:5,z:8,dir:0},{x:8,y:5,z:9,dir:3},{x:8,y:6,z:5,dir:2},{x:8,y:6,z:6,dir:3},{x:8,y:6,z:7,dir:1},{x:8,y:6,z:8,dir:0},{x:8,y:6,z:9,dir:0},{x:8,y:7,z:5,dir:2},{x:8,y:7,z:9,dir:3},{x:9,y:1,z:0,dir:2},{x:9,y:1,z:1,dir:2},{x:9,y:1,z:2,dir:1},{x:9,y:1,z:3,dir:0},{x:9,y:1,z:7,dir:3},{x:9,y:1,z:8,dir:3},{x:9,y:1,z:9,dir:3},{x:9,y:2,z:2,dir:3},{x:9,y:2,z:3,dir:3},{x:9,y:2,z:4,dir:2},{x:9,y:2,z:5,dir:2},{x:9,y:2,z:6,dir:0},{x:9,y:2,z:7,dir:3},{x:9,y:2,z:8,dir:1},{x:9,y:2,z:9,dir:2},{x:9,y:3,z:7,dir:1},{x:9,y:3,z:8,dir:1},{x:9,y:3,z:9,dir:3},{x:9,y:4,z:4,dir:3},{x:9,y:4,z:5,dir:1},{x:9,y:4,z:6,dir:2},{x:9,y:4,z:7,dir:0},{x:9,y:4,z:8,dir:2},{x:9,y:4,z:9,dir:2},{x:9,y:5,z:5,dir:1},{x:9,y:5,z:6,dir:3},{x:9,y:5,z:8,dir:2},{x:9,y:5,z:9,dir:1},{x:9,y:6,z:5,dir:0},{x:9,y:6,z:6,dir:1},{x:9,y:6,z:7,dir:0},{x:9,y:6,z:8,dir:0},{x:9,y:6,z:9,dir:1},{x:9,y:7,z:5,dir:0},{x:9,y:7,z:6,dir:3},{x:9,y:7,z:7,dir:1},{x:9,y:7,z:8,dir:2},{x:9,y:7,z:9,dir:3},{x:10,y:1,z:0,dir:0},{x:10,y:1,z:1,dir:2},{x:10,y:1,z:2,dir:0},{x:10,y:1,z:8,dir:1},{x:10,y:2,z:2,dir:0},{x:10,y:2,z:3,dir:0},{x:10,y:2,z:4,dir:2},{x:10,y:2,z:5,dir:1},{x:10,y:2,z:6,dir:0},{x:10,y:2,z:7,dir:1},{x:10,y:2,z:8,dir:1},{x:10,y:4,z:4,dir:1},{x:10,y:4,z:5,dir:2},{x:11,y:1,z:0,dir:3},{x:11,y:1,z:1,dir:3},{x:11,y:1,z:2,dir:3},{x:11,y:1,z:8,dir:0},{x:11,y:2,z:0,dir:3},{x:11,y:2,z:1,dir:0},{x:11,y:2,z:2,dir:1},{x:11,y:2,z:3,dir:1},{x:11,y:2,z:4,dir:2},{x:11,y:2,z:5,dir:0},{x:11,y:2,z:6,dir:2},{x:11,y:2,z:7,dir:2},{x:11,y:2,z:8,dir:2},{x:11,y:3,z:0,dir:3},{x:11,y:3,z:1,dir:1},{x:11,y:3,z:2,dir:1},{x:11,y:3,z:7,dir:1},{x:11,y:3,z:8,dir:3},{x:11,y:4,z:0,dir:1},{x:11,y:4,z:1,dir:3},{x:11,y:4,z:2,dir:1},{x:11,y:4,z:3,dir:0},{x:11,y:4,z:4,dir:3},{x:11,y:4,z:5,dir:3},{x:11,y:4,z:6,dir:1},{x:11,y:4,z:7,dir:3},{x:11,y:4,z:8,dir:1},{x:11,y:5,z:0,dir:3},{x:11,y:5,z:1,dir:0},{x:11,y:5,z:3,dir:3},{x:11,y:5,z:4,dir:3},{x:11,y:6,z:0,dir:1},{x:11,y:6,z:1,dir:2},{x:11,y:6,z:2,dir:3},{x:11,y:6,z:3,dir:2},{x:11,y:6,z:4,dir:0},{x:11,y:7,z:0,dir:0},{x:11,y:7,z:1,dir:3},{x:11,y:7,z:3,dir:3},{x:11,y:7,z:4,dir:3},{x:11,y:8,z:0,dir:3},{x:11,y:8,z:1,dir:2},{x:11,y:8,z:2,dir:3},{x:11,y:8,z:3,dir:1},{x:11,y:8,z:4,dir:0},{x:11,y:8,z:5,dir:3},{x:11,y:8,z:6,dir:2},{x:11,y:8,z:7,dir:1},{x:12,y:1,z:0,dir:3},{x:12,y:1,z:8,dir:3},{x:12,y:2,z:0,dir:1},{x:12,y:2,z:3,dir:1},{x:12,y:2,z:4,dir:1},{x:12,y:2,z:5,dir:0},{x:12,y:2,z:6,dir:2},{x:12,y:2,z:8,dir:1},{x:12,y:3,z:0,dir:2},{x:12,y:3,z:8,dir:3},{x:12,y:4,z:0,dir:1},{x:12,y:4,z:1,dir:0},{x:12,y:4,z:2,dir:1},{x:12,y:4,z:3,dir:2},{x:12,y:4,z:4,dir:0},{x:12,y:4,z:5,dir:3},{x:12,y:4,z:6,dir:0},{x:12,y:4,z:7,dir:2},{x:12,y:4,z:8,dir:2},{x:12,y:5,z:0,dir:2},{x:12,y:5,z:4,dir:3},{x:12,y:6,z:0,dir:2},{x:12,y:6,z:1,dir:0},{x:12,y:6,z:2,dir:0},{x:12,y:6,z:3,dir:1},{x:12,y:6,z:4,dir:2},{x:12,y:7,z:0,dir:2},{x:12,y:7,z:4,dir:2},{x:12,y:8,z:0,dir:0},{x:12,y:8,z:1,dir:0},{x:12,y:8,z:2,dir:3},{x:12,y:8,z:3,dir:0},{x:12,y:8,z:4,dir:1},{x:12,y:8,z:5,dir:0},{x:12,y:8,z:6,dir:3},{x:12,y:8,z:7,dir:1},{x:13,y:1,z:0,dir:3},{x:13,y:1,z:4,dir:1},{x:13,y:1,z:5,dir:3},{x:13,y:1,z:6,dir:1},{x:13,y:1,z:8,dir:2},{x:13,y:2,z:0,dir:1},{x:13,y:2,z:3,dir:3},{x:13,y:2,z:4,dir:3},{x:13,y:2,z:5,dir:2},{x:13,y:2,z:6,dir:2},{x:13,y:2,z:8,dir:2},{x:13,y:3,z:0,dir:1},{x:13,y:3,z:8,dir:1},{x:13,y:4,z:0,dir:2},{x:13,y:4,z:1,dir:3},{x:13,y:4,z:2,dir:1},{x:13,y:4,z:3,dir:0},{x:13,y:4,z:5,dir:3},{x:13,y:4,z:6,dir:1},{x:13,y:4,z:7,dir:0},{x:13,y:4,z:8,dir:1},{x:13,y:5,z:0,dir:3},{x:13,y:5,z:1,dir:1},{x:13,y:5,z:8,dir:2},{x:13,y:6,z:0,dir:2},{x:13,y:6,z:1,dir:1},{x:13,y:6,z:3,dir:3},{x:13,y:6,z:4,dir:3},{x:13,y:6,z:9,dir:3},{x:13,y:7,z:0,dir:1},{x:13,y:7,z:4,dir:2},{x:13,y:8,z:0,dir:1},{x:13,y:8,z:1,dir:0},{x:13,y:8,z:2,dir:2},{x:13,y:8,z:3,dir:1},{x:13,y:8,z:4,dir:1},{x:13,y:8,z:5,dir:2},{x:13,y:8,z:6,dir:1},{x:13,y:8,z:7,dir:0},{x:13,y:10,z:3,dir:1},{x:13,y:10,z:4,dir:2},{x:13,y:10,z:5,dir:0},{x:13,y:10,z:6,dir:1},{x:13,y:10,z:7,dir:0},{x:13,y:10,z:8,dir:1},{x:13,y:10,z:9,dir:3},{x:13,y:11,z:3,dir:1},{x:13,y:11,z:9,dir:1},{x:14,y:1,z:0,dir:3},{x:14,y:1,z:4,dir:1},{x:14,y:1,z:5,dir:3},{x:14,y:1,z:6,dir:3},{x:14,y:1,z:7,dir:2},{x:14,y:1,z:8,dir:0},{x:14,y:2,z:0,dir:3},{x:14,y:2,z:3,dir:1},{x:14,y:2,z:4,dir:0},{x:14,y:2,z:5,dir:3},{x:14,y:2,z:6,dir:3},{x:14,y:2,z:8,dir:1},{x:14,y:3,z:0,dir:0},{x:14,y:3,z:4,dir:2},{x:14,y:3,z:8,dir:2},{x:14,y:4,z:0,dir:2},{x:14,y:4,z:1,dir:1},{x:14,y:4,z:2,dir:0},{x:14,y:4,z:3,dir:2},{x:14,y:4,z:4,dir:1},{x:14,y:4,z:5,dir:0},{x:14,y:4,z:6,dir:3},{x:14,y:4,z:7,dir:2},{x:14,y:4,z:8,dir:3},{x:14,y:5,z:0,dir:2},{x:14,y:5,z:7,dir:3},{x:14,y:5,z:8,dir:2},{x:14,y:6,z:0,dir:1},{x:14,y:6,z:1,dir:2},{x:14,y:6,z:2,dir:0},{x:14,y:6,z:3,dir:1},{x:14,y:6,z:4,dir:3},{x:14,y:6,z:5,dir:2},{x:14,y:6,z:6,dir:3},{x:14,y:6,z:7,dir:3},{x:14,y:6,z:8,dir:0},{x:14,y:6,z:9,dir:2},{x:14,y:7,z:0,dir:1},{x:14,y:7,z:4,dir:3},{x:14,y:7,z:5,dir:0},{x:14,y:7,z:6,dir:3},{x:14,y:7,z:7,dir:3},{x:14,y:7,z:8,dir:0},{x:14,y:8,z:0,dir:0},{x:14,y:8,z:1,dir:2},{x:14,y:8,z:2,dir:0},{x:14,y:8,z:3,dir:0},{x:14,y:8,z:4,dir:3},{x:14,y:8,z:5,dir:0},{x:14,y:8,z:6,dir:0},{x:14,y:8,z:7,dir:0},{x:14,y:8,z:8,dir:1},{x:14,y:9,z:4,dir:0},{x:14,y:9,z:5,dir:1},{x:14,y:9,z:7,dir:3},{x:14,y:9,z:8,dir:3},{x:14,y:10,z:3,dir:1},{x:14,y:10,z:4,dir:0},{x:14,y:10,z:5,dir:3},{x:14,y:10,z:6,dir:2},{x:14,y:10,z:7,dir:0},{x:14,y:10,z:8,dir:2},{x:14,y:10,z:9,dir:2},{x:15,y:1,z:0,dir:0},{x:15,y:1,z:1,dir:0},{x:15,y:1,z:2,dir:2},{x:15,y:1,z:4,dir:2},{x:15,y:1,z:5,dir:0},{x:15,y:1,z:6,dir:1},{x:15,y:1,z:7,dir:0},{x:15,y:1,z:8,dir:0},{x:15,y:2,z:0,dir:3},{x:15,y:2,z:1,dir:2},{x:15,y:2,z:2,dir:1},{x:15,y:2,z:3,dir:3},{x:15,y:2,z:4,dir:2},{x:15,y:2,z:6,dir:3},{x:15,y:2,z:7,dir:0},{x:15,y:2,z:8,dir:2},{x:15,y:3,z:0,dir:1},{x:15,y:3,z:1,dir:1},{x:15,y:3,z:2,dir:2},{x:15,y:3,z:3,dir:3},{x:15,y:3,z:4,dir:1},{x:15,y:3,z:8,dir:3},{x:15,y:4,z:0,dir:1},{x:15,y:4,z:1,dir:1},{x:15,y:4,z:2,dir:2},{x:15,y:4,z:3,dir:3},{x:15,y:4,z:4,dir:3},{x:15,y:4,z:8,dir:0},{x:15,y:5,z:0,dir:3},{x:15,y:5,z:1,dir:0},{x:15,y:5,z:3,dir:0},{x:15,y:5,z:4,dir:1},{x:15,y:5,z:8,dir:1},{x:15,y:6,z:0,dir:1},{x:15,y:6,z:1,dir:0},{x:15,y:6,z:2,dir:3},{x:15,y:6,z:3,dir:3},{x:15,y:6,z:4,dir:3},{x:15,y:6,z:5,dir:3},{x:15,y:6,z:6,dir:2},{x:15,y:6,z:7,dir:2},{x:15,y:6,z:8,dir:2},{x:15,y:6,z:9,dir:1},{x:15,y:7,z:0,dir:3},{x:15,y:7,z:1,dir:2},{x:15,y:7,z:8,dir:1},{x:15,y:8,z:0,dir:2},{x:15,y:8,z:1,dir:2},{x:15,y:8,z:2,dir:3},{x:15,y:8,z:3,dir:0},{x:15,y:8,z:4,dir:2},{x:15,y:8,z:5,dir:0},{x:15,y:8,z:6,dir:3},{x:15,y:8,z:7,dir:0},{x:15,y:8,z:8,dir:2},{x:15,y:9,z:4,dir:0},{x:15,y:9,z:8,dir:1},{x:15,y:10,z:3,dir:0},{x:15,y:10,z:4,dir:0},{x:15,y:10,z:5,dir:3},{x:15,y:10,z:6,dir:2},{x:15,y:10,z:7,dir:1},{x:15,y:10,z:8,dir:2},{x:15,y:10,z:9,dir:1},{x:16,y:1,z:2,dir:2},{x:16,y:1,z:4,dir:1},{x:16,y:1,z:6,dir:2},{x:16,y:1,z:7,dir:0},{x:16,y:1,z:8,dir:1},{x:16,y:2,z:2,dir:0},{x:16,y:2,z:3,dir:0},{x:16,y:2,z:4,dir:2},{x:16,y:2,z:6,dir:1},{x:16,y:2,z:7,dir:2},{x:16,y:2,z:8,dir:3},{x:16,y:3,z:2,dir:3},{x:16,y:3,z:3,dir:1},{x:16,y:3,z:4,dir:3},{x:16,y:3,z:8,dir:2},{x:16,y:4,z:4,dir:0},{x:16,y:4,z:8,dir:2},{x:16,y:5,z:4,dir:2},{x:16,y:5,z:8,dir:0},{x:16,y:6,z:4,dir:2},{x:16,y:6,z:5,dir:0},{x:16,y:6,z:6,dir:1},{x:16,y:6,z:7,dir:0},{x:16,y:6,z:8,dir:0},{x:16,y:6,z:9,dir:0},{x:16,y:7,z:4,dir:3},{x:16,y:8,z:3,dir:3},{x:16,y:8,z:4,dir:2},{x:16,y:8,z:5,dir:0},{x:16,y:8,z:7,dir:0},{x:16,y:8,z:8,dir:2},{x:16,y:9,z:4,dir:0},{x:16,y:10,z:3,dir:2},{x:16,y:10,z:4,dir:2},{x:16,y:10,z:5,dir:2},{x:16,y:10,z:6,dir:0},{x:16,y:10,z:7,dir:2},{x:16,y:10,z:9,dir:1},{x:17,y:1,z:6,dir:0},{x:17,y:1,z:7,dir:2},{x:17,y:1,z:8,dir:1},{x:17,y:2,z:2,dir:0},{x:17,y:2,z:6,dir:0},{x:17,y:2,z:7,dir:0},{x:17,y:2,z:8,dir:0},{x:17,y:3,z:2,dir:0},{x:17,y:3,z:3,dir:2},{x:17,y:3,z:4,dir:3},{x:17,y:3,z:6,dir:0},{x:17,y:3,z:8,dir:2},{x:17,y:4,z:4,dir:1},{x:17,y:4,z:6,dir:0},{x:17,y:4,z:8,dir:1},{x:17,y:5,z:4,dir:1},{x:17,y:5,z:6,dir:0},{x:17,y:5,z:8,dir:3},{x:17,y:6,z:4,dir:2},{x:17,y:6,z:5,dir:2},{x:17,y:6,z:6,dir:2},{x:17,y:6,z:7,dir:2},{x:17,y:6,z:8,dir:2},{x:17,y:6,z:9,dir:1},{x:17,y:7,z:4,dir:1},{x:17,y:7,z:5,dir:2},{x:17,y:7,z:6,dir:0},{x:17,y:7,z:7,dir:1},{x:17,y:7,z:8,dir:3},{x:17,y:8,z:3,dir:1},{x:17,y:8,z:4,dir:1},{x:17,y:8,z:5,dir:3},{x:17,y:8,z:6,dir:1},{x:17,y:8,z:7,dir:2},{x:17,y:8,z:8,dir:3},{x:17,y:9,z:3,dir:1},{x:17,y:9,z:4,dir:0},{x:17,y:9,z:8,dir:1},{x:17,y:10,z:4,dir:0},{x:17,y:10,z:5,dir:3},{x:17,y:10,z:6,dir:2},{x:17,y:10,z:7,dir:1},{x:17,y:10,z:8,dir:1},{x:17,y:10,z:9,dir:2},{x:18,y:2,z:2,dir:1},{x:18,y:3,z:2,dir:1},{x:18,y:3,z:3,dir:3},{x:18,y:3,z:4,dir:3},{x:18,y:3,z:5,dir:3},{x:18,y:3,z:6,dir:2},{x:18,y:3,z:7,dir:1},{x:18,y:3,z:8,dir:0},{x:18,y:4,z:4,dir:3},{x:18,y:4,z:5,dir:1},{x:18,y:4,z:6,dir:2},{x:18,y:4,z:8,dir:3},{x:18,y:5,z:4,dir:0},{x:18,y:5,z:5,dir:1},{x:18,y:5,z:6,dir:1},{x:18,y:5,z:7,dir:2},{x:18,y:5,z:8,dir:0},{x:18,y:6,z:4,dir:2},{x:18,y:6,z:5,dir:3},{x:18,y:6,z:6,dir:2},{x:18,y:6,z:7,dir:0},{x:18,y:6,z:8,dir:0},{x:18,y:6,z:9,dir:3},{x:18,y:7,z:4,dir:3},{x:18,y:7,z:5,dir:0},{x:18,y:7,z:6,dir:2},{x:18,y:7,z:7,dir:3},{x:18,y:7,z:8,dir:1},{x:18,y:8,z:3,dir:1},{x:18,y:8,z:4,dir:2},{x:18,y:8,z:5,dir:0},{x:18,y:8,z:6,dir:3},{x:18,y:8,z:7,dir:2},{x:18,y:8,z:8,dir:0},{x:18,y:9,z:4,dir:2},{x:18,y:9,z:5,dir:0},{x:18,y:9,z:7,dir:2},{x:18,y:9,z:8,dir:1},{x:18,y:10,z:4,dir:0},{x:18,y:10,z:5,dir:0},{x:18,y:10,z:6,dir:0},{x:18,y:10,z:7,dir:3},{x:18,y:10,z:8,dir:0},{x:18,y:10,z:9,dir:3},{x:18,y:11,z:4,dir:1},{x:18,y:11,z:9,dir:3},{x:19,y:1,z:2,dir:0},{x:19,y:2,z:2,dir:1},{x:19,y:3,z:2,dir:1},{x:19,y:3,z:3,dir:1},{x:19,y:3,z:4,dir:0},{x:19,y:3,z:5,dir:2},{x:19,y:3,z:6,dir:3},{x:19,y:3,z:7,dir:0},{x:19,y:3,z:8,dir:2},{x:19,y:6,z:7,dir:3},{x:19,y:6,z:8,dir:2},{x:19,y:6,z:9,dir:1},{x:19,y:7,z:7,dir:1},{x:19,y:8,z:3,dir:1},{x:19,y:8,z:4,dir:0},{x:19,y:8,z:5,dir:0},{x:19,y:8,z:6,dir:1},{x:20,y:1,z:2,dir:1},{x:20,y:2,z:2,dir:1},{x:20,y:3,z:2,dir:2},{x:20,y:3,z:3,dir:0},{x:20,y:3,z:4,dir:1},{x:20,y:3,z:5,dir:0},{x:20,y:3,z:6,dir:3},{x:20,y:3,z:7,dir:3},{x:20,y:3,z:8,dir:2},{x:21,y:1,z:2,dir:0},{x:21,y:2,z:2,dir:2},{x:21,y:3,z:2,dir:1},{x:21,y:3,z:3,dir:3},{x:21,y:3,z:4,dir:3},{x:21,y:3,z:5,dir:3},{x:21,y:3,z:6,dir:0},{x:21,y:3,z:7,dir:2},{x:21,y:3,z:8,dir:1},{x:22,y:1,z:2,dir:2},{x:22,y:1,z:3,dir:2},{x:22,y:1,z:4,dir:2},{x:22,y:1,z:5,dir:0},{x:22,y:1,z:6,dir:3},{x:22,y:1,z:8,dir:3},{x:22,y:2,z:2,dir:1},{x:22,y:2,z:3,dir:2},{x:22,y:2,z:4,dir:0},{x:22,y:2,z:5,dir:3},{x:22,y:2,z:6,dir:1},{x:22,y:2,z:8,dir:0},{x:22,y:3,z:2,dir:0},{x:22,y:3,z:3,dir:0},{x:22,y:3,z:4,dir:2},{x:22,y:3,z:5,dir:2},{x:22,y:3,z:6,dir:1},{x:22,y:3,z:7,dir:2},{x:22,y:3,z:8,dir:3}]},4:{0:[{x:4,y:8,z:5,dir:1},{x:4,y:8,z:9,dir:0},{x:9,y:8,z:5,dir:2},{x:9,y:8,z:7,dir:3},{x:9,y:8,z:9,dir:2},{x:13,y:12,z:3,dir:3},{x:13,y:12,z:9,dir:0},{x:18,y:12,z:4,dir:3},{x:18,y:12,z:9,dir:2}]},5:{0:[{x:3,y:1,z:0,dir:1},{x:4,y:4,z:3,dir:2},{x:5,y:1,z:6,dir:2},{x:5,y:3,z:4,dir:3},{x:6,y:2,z:5,dir:1},{x:6,y:5,z:8,dir:1},{x:7,y:6,z:8,dir:1},{x:8,y:7,z:6,dir:2},{x:9,y:2,z:1,dir:0},{x:10,y:2,z:1,dir:0},{x:13,y:1,z:7,dir:1},{x:13,y:5,z:7,dir:0},{x:13,y:6,z:8,dir:0},{x:14,y:2,z:7,dir:1},{x:15,y:2,z:5,dir:3},{x:16,y:1,z:5,dir:3},{x:16,y:4,z:2,dir:3},{x:17,y:3,z:7,dir:1},{x:17,y:10,z:3,dir:3},{x:18,y:9,z:3,dir:3},{x:19,y:7,z:8,dir:2},{x:19,y:8,z:7,dir:2}]},6:{0:[{x:10,y:1,z:9,dir:2},{x:10,y:2,z:9,dir:2},{x:13,y:3,z:4,dir:1},{x:13,y:4,z:4,dir:1},{x:13,y:5,z:2,dir:2},{x:13,y:6,z:2,dir:2},{x:16,y:7,z:6,dir:1},{x:16,y:8,z:6,dir:1},{x:16,y:9,z:8,dir:1},{x:16,y:10,z:8,dir:1}]}},width:24,height:13,depth:12,name:"",surfaceArea:496}];MunitionsManager.prototype.update=function(e){for(var i=0;i<4;i++)this.bulletPool.forEachActive(function(i){i.update(.25*e),Object.keys(players).forEach(function(e){var t=players[e];if(t&&!t.isDead()&&t.id!=i.player.id&&Math.abs(i.x-t.x)<.3&&Math.abs(i.y-(t.y+.3))<.3&&Math.abs(i.z-t.z)<.3){var r=i.player;v1.x=i.dx,v1.y=i.dy,v1.z=i.dz,v2.x=t.x-i.x,v2.y=t.y+.32-i.y,v2.z=t.z-i.z;var n=BABYLON.Vector3.Cross(v1,v2);hitPlayer(t,r,i.damage/(1+20*n.length()),v1.x,v1.z),i.remove()}})});this.grenadePool.forEachActive(function(i){i.update(e)})},MunitionsManager.prototype.fireBullet=function(e,i,t,r,n,a){this.bulletPool.retrieve().fire(e,i,t,r,n,a)},MunitionsManager.prototype.throwGrenade=function(e,i,t){this.grenadePool.retrieve().throw(e,i,t)};var CONTROL={up:1,down:2,left:4,right:8},classes=[{name:"Soldier",weapon:Eggk47},{name:"Scrambler",weapon:DozenGauge},{name:"Free Ranger",weapon:CSG1}];Player.prototype.update=function(e){var i=0,t=0,r=0;if(this.controlKeys&CONTROL.left&&(i-=Math.cos(this.moveYaw),r+=Math.sin(this.moveYaw)),this.controlKeys&CONTROL.right&&(i+=Math.cos(this.moveYaw),r-=Math.sin(this.moveYaw)),this.controlKeys&CONTROL.up&&(this.climbing?t+=1:(i+=Math.sin(this.moveYaw),r+=Math.cos(this.moveYaw))),this.controlKeys&CONTROL.down&&(this.climbing?t-=1:(i-=Math.sin(this.moveYaw),r-=Math.cos(this.moveYaw))),this.climbing){o=this.dy;this.dy+=.014*t*e;y=.5*(this.dy+o)*e;this.y+=y,this.dy*=Math.pow(.5,e),this.getOccupiedCell().cat!=MAP.ladder&&(this.y=Math.round(this.y),this.climbing=!1),this.collidesWithMap()&&y>0&&this.y%1>.3&&(this.y-=y,this.dy*=Math.pow(.5,e))}else{var n=new BABYLON.Vector3(i,t,r).normalize(),a=this.dx,o=this.dy,d=this.dz;this.dx+=.007*n.x*e,this.dz+=.007*n.z*e,this.dy-=.003*e;var s=.5*(this.dx+a)*e,y=.5*(this.dy+o)*e,l=.5*(this.dz+d)*e;if(this.x+=s,this.collidesWithMap()){x=this.y;this.y+=Math.abs(s),this.collidesWithMap()&&(this.x-=s,this.dx*=Math.pow(.5,e),this.y=x),this.lookForLadder()}if(this.z+=l,this.collidesWithMap()){var x=this.y;this.y+=Math.abs(l),this.collidesWithMap()&&(this.z-=l,this.dz*=Math.pow(.5,e),this.y=x),this.lookForLadder()}this.y+=y,this.collidesWithMap()?(y<0&&(this.jumping=!1),this.y-=y,this.dy*=Math.pow(.5,e)):0==this.jumping&&(this.jumping=!0)}var z=Math.length3(this.dx,this.dy,this.dz);this.actor&&this.id==meId&&(z*=.75),this.climbing&&(z*=3),this.bobble=(this.bobble+7*z)%Math.PI2,this.shotSpread+=Math.floor(150*z),this.shotSpread*=this.weapon.accuracySettleFactor,this.dx*=Math.pow(.8,e),this.dz*=Math.pow(.8,e),this.weapon&&this.weapon.update(e),this.hp>0&&(this.hp=Math.min(100,this.hp+.05*e)),!this.actor&&this.stowWeaponCountdown>0&&(this.stowWeaponCountdown-=e,this.stowWeaponCountdown<=0&&(this.stowWeaponCountdown=0,this.equipWeapon(this.equipWeaponIdx))),!this.actor||this.isDead()||this.actor.bodyMesh.isEnabled()||this.actor.respawn(this.x,this.y,this.z),this.actor||this.grenadeCountdown>0&&(this.grenadeCountdown-=e,this.grenadeCountdown<=0&&(this.grenadeThrown||(this.throwGrenade(),this.grenadeCountdown=30,this.grenadeThrown=!0)))},Player.prototype.doAI=function(){Math.random()<.001||playerTotal>botGoal&&Math.random(),Math.random()<.01&&(this.viewYaw=6.282*Math.random()-3.141)},Player.prototype.jump=function(){var e=!this.jumping|this.climbing;e||(this.y-=.2,this.collidesWithMap()&&(e=!0),this.y+=.2),e&&(this.climbing?(this.dy=.03,this.climbing=!1):this.dy=.06,this.jumping=!0)},Player.prototype.equipWeapon=function(e){if(this.weaponIdx=e,this.weapon=this.weapons[e],this.weapons[e].equip(),this.actor)this.id==meId&&updateAmmoUi();else{var i=new Comm.output(3);i.packInt8(Comm.equipWeapon),i.packInt8(this.id),i.packInt8(this.equipWeaponIdx),sendToAll(i.buffer)}},Player.prototype.stowWeapon=function(e){if(this.equipWeaponIdx=e,this.weapon.stow())if(this.actor)(i=new Comm.output(2)).packInt8(Comm.stowWeapon),i.packInt8(e),ws.send(i.buffer);else{var i=new Comm.output(2);i.packInt8(Comm.stowWeapon),i.packInt8(this.id),sendToOthers(i.buffer,this.id)}},Player.prototype.addRotationShotSpread=function(e,i){this.shotSpread+=Math.sqrt(Math.pow(60*e,2)+Math.pow(60*i,2))},Player.prototype.collectItem=function(e){switch(e){case ItemManager.AMMO:return!!this.weapon.collectAmmo()&&(this.actor&&(Sounds.ammo.play(),updateAmmoUi()),!0);case ItemManager.GRENADE:return this.grenadeCount<this.grenadeCapacity&&(this.grenadeCount++,this.actor&&(Sounds.ammo.play(),updateAmmoUi()),!0)}},Player.prototype.isAtReady=function(){return this.weapon.isAtReady()&&this.grenadeCountdown<=0&&!this.isDead()},Player.prototype.queueShot=function(){if(this.hp>0&&this.weapon)return this.weapon.queueShot()},Player.prototype.queueGrenade=function(e){this.isAtReady()&&(this.grenadeThrown=!1,this.grenadeCountdown=30,this.grenadeThrowPower=Math.clamp(e,0,1))},Player.prototype.throwGrenade=function(){if(this.grenadeCount>0)if(this.actor){if(this.grenadeCountdown>0){var e=new Comm.output(7);e.packInt8(Comm.throwGrenade),e.packRad(this.pitch),e.packRadU(this.viewYaw),e.packFloat(Math.clamp(grenadeThrowPower,0,1)),ws.send(e.buffer),grenadeThrowPower=-1e3}}else{this.grenadeCount--;var i=BABYLON.Matrix.RotationYawPitchRoll(this.viewYaw,this.pitch,0),t=BABYLON.Matrix.Translation(0,.1,1).multiply(i).getTranslation(),r=BABYLON.Matrix.Translation(.1,-.05,.2),n=(r=(r=r.multiply(i)).add(BABYLON.Matrix.Translation(this.x,this.y+.3,this.z))).getTranslation(),a=.1*this.grenadeThrowPower+.1;t.x*=a,t.y*=a,t.z*=a,(e=new Comm.output(14)).packInt8(Comm.throwGrenade),e.packInt8(this.id),e.packFloat(n.x),e.packFloat(n.y),e.packFloat(n.z),e.packFloat(t.x),e.packFloat(t.y),e.packFloat(t.z),sendToAll(e.buffer),munitionsManager.throwGrenade(this,n,t)}},Player.prototype.die=function(){this.hp=0,this.killStreak=0,this.controlKeys=0,this.shotSpread=0,this.jumping=!1,this.grenadeCountdown=0,this.actor?this.actor.die():this.resetWeaponState()},Player.prototype.respawn=function(e,i,t){this.x=e,this.y=i,this.z=t,this.hp=100,this.actor&&(this.actor.mesh.position.x=e,this.actor.mesh.position.y=i,this.actor.mesh.position.z=t,this.actor.respawn(),this.weapon.equip(),this.resetWeaponState(),this.id==meId&&updateAmmoUi())},Player.prototype.resetWeaponState=function(){this.stowWeaponCountdown=0;for(var e=0;e<this.weapons.length;e++)this.weapons[e]&&(this.weapons[e].ammo.rounds=this.weapons[e].ammo.capacity,this.weapons[e].ammo.store=this.weapons[e].ammo.storeMax,this.weapons[e].reloadCountdown=0,this.weapons[e].rofCountdown=0,this.weapons[e].shotsQueued=0,this.weapons[e].triggerPulled=!1,this.weapons[e].equipCountdown=0);this.grenadeCount=Math.max(this.grenadeCount,1)},Player.prototype.isDead=function(){return this.hp<=0},Player.prototype.lookForLadder=function(){if(this.controlKeys&CONTROL.up){var e=this.getOccupiedCell();if(e.cat==MAP.ladder){var i=this.x%1,t=this.z%1;if(Math.abs(Math.radDifference(Math.cardToRad(e.dir),this.moveYaw))<Math.PI90/3)switch(e.dir){case 0:i>.3&&i<.7&&t>.5&&(this.z=Math.floor(this.z)+.74,this.climbing=!0);break;case 1:t>.3&&t<.7&&i>.5&&(this.x=Math.floor(this.x)+.74,this.climbing=!0);break;case 2:i>.3&&i<.7&&t<.5&&(this.z=Math.floor(this.z)+.26,this.climbing=!0);break;case 3:t>.3&&t<.7&&i<.5&&(this.x=Math.floor(this.x)+.26,this.climbing=!0)}}}},Player.prototype.getOccupiedCell=function(){if(this.x<0||this.y<0||this.z<0||this.x>=map.width||this.y>=map.height||this.z>map.depth)return{};var e=Math.floor(this.x),i=Math.floor(this.y),t=Math.floor(this.z);return map.data[e][i][t]},Player.prototype.collidesWithMap=function(){var e=this.x-.5,i=this.y,t=this.z-.5;if(i>map.height)return!1;if(i<0)return!0;if(e<-.25||t<-.25||e>map.width-.75||t>map.depth-.75)return!0;for(var r,n,a,o,d,s,y,l,x,z=.25;z<=.75;z+=.25)for(var h=0;h<=.6;h+=.3)for(var c=.25;c<=.75;c+=.25)if(r=e+z,n=i+h,a=t+c,o=Math.floor(r),d=Math.floor(n),s=Math.floor(a),o>=0&&d>=0&&s>=0&&o<map.width&&d<map.height&&s<map.depth){var u=map.data[o][d][s];if(u.cat==MAP.ground||u.cat==MAP.block)return u;if(u.cat==MAP.ramp)switch(y=r%1,l=n%1,x=a%1,u.dir){case 0:if(l<x)return u;break;case 2:if(l<1-x)return u;break;case 1:if(l<y)return u;break;case 3:if(l<1-y)return u}else if(u.cat==MAP.halfBlock){if(y=r%1,l=n%1,x=a%1,y<.7&&y>.3&&x<.7&&x>.3&&l<.5)return u}else if(u.cat==MAP.column){if(y=r%1-.5,x=a%1-.5,y*y+x*x<.04)return u}else if(u.cat==MAP.tank){if(y=r%1-.5,l=n%1-.5,x=a%1-.5,l<.2)return u;if(0==u.dir||2==u.dir){if(y*y+l*l<.25)return u}else if(x*x+l*l<.25)return u}else if(u.cat==MAP.lowWall&&(y=r%1,l=n%1,x=a%1,l<.25))switch(u.dir){case 0:if(x>.75)return u;break;case 1:if(y>.75)return u;break;case 2:if(x<.25)return u;break;case 3:if(y<.25)return u}}return!1},Pool.prototype.expand=function(e){for(var i=0;i<e;i++){var t=this.constructorFn();t.id=i+this.size,t.active=!1,this.objects.push(t)}this.size+=e},Pool.prototype.retrieve=function(e){if(void 0!=e){for(;e>=this.size;)this.expand(this.originalSize);return this.numActive++,this.objects[e].active=!0,this.objects[e]}var i=this.idx;do{i=(i+1)%this.size;var t=this.objects[i];if(!t.active)return this.idx=i,this.numActive++,t.active=!0,t}while(i!=this.idx);return this.expand(this.originalSize),log.out("Expanding pool for: "+this.objects[0].constructor.name+" to: "+this.size),this.retrieve()},Pool.prototype.recycle=function(e){e.active=!1,this.numActive--},Pool.prototype.forEachActive=function(e){for(var i=0;i<this.size;i++){var t=this.objects[i];!0===t.active&&e(t,i)}};